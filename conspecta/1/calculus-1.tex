\documentclass[a4paper]{report}

\usepackage{../mathstemplate}

\date{Пока только I семестр, осень 2022 г.}
\title{Матанализ. Неофициальный конспект}
\author{Лектор: Сергей Витальевич Кисляков\\ Конспектировал Леонид Данилевич}

\begin{document}
    \maketitle
    \tableofcontents
    \newpage
    \setcounter{lection}{0}
    \newlection{2 сентября 2022 г.}

    \section*{Хорошие книги}

    \begin{enumerate}
        \item Курс московского университета, Зорич.
        Математический анализ, 2 тома.
        \item Учебное пособие СПбГУ на первые 2 семестра.
        О.\ Л.\ Виноградов
        \item Г.\ М.\ Фихтенгольц.
        Основы матанализа или что-то такое.
        Несколько устарело, много примеров.
        \item В.\ П.\ Хавин. \mono{contains}(<<основы>>)
        \item Основы математического анализа, У.\ Рудин.
        Короткая и плотная (информация за первые 2 семестра)
% \item 
    \end{enumerate}


    \chapter{Введение в теорию множеств}


    \emph{Принадлежность} $x \in X$, \emph{объединение} $X \cup Y$, \emph{пересечение} $X \cap Y$, \emph{разность} $X \bs Y$, \emph{задание свойством} $X \bs Y = \{ x \in X | x \notin Y \}$, \emph{дополнение} (до унивёрсума) (пример: дополнение до множества целых чисел $\Z$) $A\inv = \Z \bs A$, $A\inv\inv = A$.


    \section{Некоторые формулы}

    \subsection{Формулы де Моргана}
    $(A\cup B)\inv = A\inv \cap B\inv$, $(A\cap B)\inv = A\inv \cup B\inv$

    \prove{\(x \in (A \cup B)\inv \iff  x \notin A \cup B \iff  x \notin A \land x \notin B \iff  x \in A\inv \land x \in B\inv \iff  x \in A\inv \cap B\inv.\)
    }

    Доказательство второй формулы де Моргана получается аналогично, или же из первой, заменой $A$ на $A\inv$ и $B$ на $B\inv$, и применением $A\inv\inv = A$.

    \subsection{Связь пересечения и объединения} $(A \cup B) \cap C = (A \cap C) \cup (B \cap C)$ и двойственная ей $(A \cap B) \cup C = (A \cup C) \cap (B \cup C)$.


    \section{Примеры множеств}

    Множество всех целых чисел $\Z$, его подмножества $\Z^+ = \{ n \in \Z | n \ge 0 \} = \N_0$ всех неотрицательных целых чисел и $\N = \{ n \in \Z | n > 0 \}$ всех натуральных чисел.

    Множество рациональных чисел $\Q$.

    Множество вещественных чисел $\R$.

    \subsection{Отрезки}

    Пускай $a, b \in \R$. \definition[Отрезки]{\down
    \bullets{
        \item $[a; b] \bydef \{x \in R | a \le x \le b\}$ --- отрезок (сегмент);
        \item $(a; b) \bydef \{x \in R | a < x < b\}$ --- интервал;
        \item $[a; b) \bydef \{x \in R | a \le x < b\}$ --- полуинтервал;
        \item $(a; b] \bydef \{x \in R | a < x \le b\}$ --- ещё полуинтервал.
    }}
    На лекциях будут использоваться термин интервал для всех четырёх типов отрезков.
    Иногда будут накладываться дополнительные требования $a \le b$.
    Вообще говоря, все отрезки определены при $a > b$ и совпадают с пустым множеством $\o$.


    \section{Отображения}
    Понятие \emph{отображения} $f : X \map Y$ не имеет чёткого определения и, насколько я понял, задаётся околоаксиоматически.

    Пусть даны множества $X, Y$ и некое правило, по которому каждому элементу множества $X$ сопоставляется однозначно определённый элемент $Y$.
    Для таких элементов $x \in X, y \in Y$ пишут $y = f(x)$.

    $X$ является областью определения отображения $f$, а $Y$ --- множество значений $f$.
    Необязательно каждый элемент $Y$ является значением $f$ в некой точке.
    Отображение характеризуется двумя данными множествами и <<правилом>>.

    Например,
    \begin{gather*}
        f : \R \map \R, f(x) = 2x + 1\\
        g : \R \map \R, g(x) = x^2\\
    \end{gather*}

    \subsection{Образ множества}

    Примечание: Знак $\subset$ ниже используется в качестве $\subseteq$.

    Пускай $F : X \map Y$ --- отображение.
    Для $A \subset X$ образ множества $A$ при отображении $F$: $F(A) \bydef \{y \in Y | y = F(x), x \in A \}$.
    Очевидно, $F(A) \subset Y$.

    Например, для выше определённого $f : \R \map \R, x \mapsto 2x + 1$ образом $[0; 1]$ является $f([0; 1]) = [1; 3]$.

    \subsection{Виды отображений}

    Пусть $f(X) = Y$; тогда говорят, что $f$ --- отображение $X$ на $Y$ (\emph{сюръекция}).
    А именно, для $f : X \map Y$ --- сюръекция $\iff f(X) = Y$.

    \definition[Инъекция или взаимно-однозначное отображение]{$f$ является инъекцией, если для $\forall x_1 \ne x_2: f(x_1) \ne f(x_2)$.}

    \definition[Обратное отображение]{Для инъективного отображения $f: X \map Y$ это $f^{-1} : f(X) \map X$. $f^{-1}(y)$ определяется как тот единственный элемент $x \in X$, для которого $f(x) = y$.} Для определённого выше $f$: $f^{-1}(y) = \frac{y-1}{2}$.

    Для $g$ и прочих неинъективных отображений обратного отображения не существует, чтобы его создать, надо сузить область определения.
    Так, для $g' : \R^{+} \map \R$, для всех $x \in \R^+$ равного $g$ ($g' : \R \map \R, x \mapsto x^2$) обратное отображение уже существует, это функция извлечения арифметического квадратного корня.

    \definition[Сужение]{Для $f : X \map Y$ \emph{сужение} $f$ на $X_1 \subset X$ --- отображение $f_1$  из $X_1$ в $Y$, действующее по тому же правилу, что и $f$. Обозначают $f_1 = f\Big|_{X_1}$}

    \definition[Биекция]{Одновременно инъекция и сюръекция.}

    \subsection{Прообраз}

    Пускай дано отображение $f : X \map Y$; $B \subset Y$. \definition[Прообраз $B$ при отображении $f$]{$f^{-1}(B) \bydef \{x \in X | f(x) \in B \}$.} \note{$f^{-1}(x)$ для одного элемента множества $x \in X$ может быть не определено, если $f$ не является инъекцией.}

    Пример: $g^{-1}([-2; -1]) = \varnothing$; $g^{-1}([1; 4]) = [-2; -1] \cup [1; 2]$.

    \subsection{Функции}

    \definition[Функция]{Отображение из $X \subset \R$ в $Y \subset \R$.

    Позже надмножества $X$ и $Y$ будут расширены))}

    Примеры:
    \bullets{
        \item Линейная функция $f(x) = ax + b$.
        \item Многочлен $h(x) = a_n x^n + a_{n-1}x^{n-1}+\dots +a_0,~ a_i \in \R,~ \forall i = 0, 1, \dots, n$.
        \item $\phi(x) = \dfrac{1}{x}, X = \R \bs \{0\}; Y = \R$.
        \item Показательная функция, логарифмическая, тригонометрические.
        \item Рациональная функция $\psi(x) = \dfrac{p(x)}{q(x)}$.
        \item Показательная функция.
        \item Знак числа $s(x) =\all{1,& x > 0\\0,& x = 0\\ -1,& x < 0}$
        \item Функция Дирихле $D : \R \map \R$: $D(x) = \all{0,& x \in \I \\ 1,& x \in \Q}$ ($\I = \R \bs \Q$)
        \item Функция Римана~(\ref{Riemann_function_def})
    }
    \newlection{5 сентября 2022 г.}


    \section{Упорядоченные пары}

    Два элемента любой природы;\ указано, кто первый, а кто --- второй.
    Обозначается $(a, b)$, где $a$ --- первый элемент, а $b$ --- второй элемент.
    Позволена пара двух равных элементов $a = b$.

    \subsection{Декартово произведение}
    Пусть $X, Y$ --- 2 множества.

    \definition[Декартово произведение]{$X \times Y\bydef \{ (x, y) | x \in X \land y \in Y\}$. Например, $\R \times \R$ --- евклидова плоскость.}

    Позволив себе некую неформальность, можно сказать, что $(X \times Y) \times Z$ --- множество упорядоченных троек, трёхмерное евклидово пространство.

    Обозначим $\R^n = \prod\limits_{i = 1}^n\R = \{(x_1, \dots, x_n) | x_i \in \R\}$


    \section{Прочие определения}

    \definition[Равномощность (реже эквивалентность)]{Два множества $X, Y$ равномощны, если $\exists$ биекция $f : X \map Y$.}

    \definition[Конечное множество]{ Множество $A$ называется \textit{конечным}, если оно равномощно некоему множеству $\{1, 2, \dots, n\}$ для некоего $n \in \N$. В противном случае $A$ называется \textit{бесконечным}.} Например, $\N$ бесконечно.

    \theorem[Кантор]{$\N$ не равномощно $\R$.}
    \ok
    $f : X \map Y$ --- произвольное отображение.
    Обозначим $f(x)$ --- тот элемент из $Y$, который ставится в соответствие $x \in X$.

    \textit{Семейство} --- другой способ записи отображения.
    Пишут $\{f_x\}_{x \in X}$ и подразумевают $f_x = f(x)$.
    \ok
    \definition[Последовательность]{Отображение $a : \N \map Y$ для произвольного множества $Y$.}
    Запись последовательности в виде семейства: $\{a_n\}_{n \in \N}$. $a_n \in Y$.

    \definition[Конечная последовательность]{Отображение $a : \{1, 2, \dots, n\} \map Y$ для произвольного множества $Y$ и некоего $n \in \N$.} Запись конечной последовательности в виде семейства: $\{a_i\}_{i = 1}^n = \{a_i\}_{1 \le i \le n}$. $a_n \in Y$. \note{Конечная последовательность не является последовательностью.}

    \ok
    Пусть $\{A_{\gamma}\}_{\gamma \in \text{Г}}$ -- семейство множеств.
    Тогда объединение и пересечение соответственно:
    \begin{gather*}
        \bigcup_{\gamma \in \text{Г}}A_{\gamma} = \{ x | \exists y \in \text{Г} : x \in A_{y}\}\\
        \bigcap_{\gamma \in \text{Г}}A_{\gamma} = \{ x | \forall y \in \text{Г} : x \in A_{y}\}\\
    \end{gather*}

    \ok

    $f : X \map Y$. $\textit{Г}_{f} \bydef \{(x, y) \in X \times Y | y = f(x) \} = \{(x, f(x)\}_{x \in X}$

    Пусть $X, Y$ --- множества, $B \subset X \times Y$.

    $B$ --- график некоего отображения из $X$ в $Y$ $\iff$ $\forall x \in X : \exists! y \in Y : (x, y) \in B$.
    \provehere{Очевидно.}


    \chapter{Вещественные числа}

    Множество вещественных чисел $\R$.


    \section{Аксиомы вещественных чисел}
    \begin{enumerate}
        \item Сложение: $+ : \R \times \R \map \R$, результат называется суммой и обозначается $a + b$ для $(a, b) \in \R \times \R$.

        Свойства сложения:
        \begin{itemize}
            \item Коммутативность $x + y = y + x$
            \item Ассоциативность $x + (y + z) = (x + y) + z$
            \item Нулевой элемент: $\exists! ~ 0 \in \R : \forall x \in \R: x + 0 = x$.

            \textit{Замечание}: единственность нуля выводима: в самом деле, пусть $0, 0'$ --- нули.
            \item Тогда по определению нуля $0 + 0' = 0 = 0'$.
            \item Противоположный элемент: $\forall x \in \R: \exists! y \in \R : x + y = 0$. $y$ обозначают $-x$.

            \textit{Замечание}: Единственность противоположного элемента тоже выводима: в самом деле, пусть $x + y = 0 \land x + y' = 0$.
            Тогда $y = y + (x + y') = (y + x) + y' = y'$.
        \end{itemize}
        \item Умножение: $\cdot: \R \times \R \map \R$, результат называется произведением и обозначается $ a \cdot b = ab$ для $(a, b) \in \R \times \R$.
        Свойства умножения:
        \begin{itemize}
            \item Коммутативность $x \cdot y = y \cdot x$
            \item Ассоциативность $x \cdot (y \cdot z) = (x \cdot y) \cdot z$
            \item Элемент единица: $\exists! ~ 1 \in \R : \forall x \in \R: x \cdot 1 = x$.

            \textit{Замечание}: единственность единицы выводима абсолютно аналогично единственности нуля.
            \item Обратный элемент: $\forall x \ne 0 \in \R: \exists! y \in \R : x \cdot y = 1$. $y$ обозначают $x^{-1}$ или $\frac{1}{x}$.

            \textit{Замечание}: Единственность обратного элемента тоже выводима абсолютно аналогично.
            \item Дистрибутивность умножения относительно сложения: $x \cdot (y + z) = x \cdot y + x \cdot z$.

            \textit{Следствие}: $0 \cdot x = 0$.
            В самом деле, $0 = 0 + 0$ и отсюда $0 \cdot x = 0 \cdot x + 0 \cdot x$, а добавив противоположное к $0\cdot x$ получим $0\cdot x = 0$

            \textit{Следствие}: $-x = (-1) \cdot x$.
            В самом деле, $1 + (-1) = 0 \then 1 \cdot x + (-1) \cdot x = 0 \cdot x$, откуда всё видно.
            \item $0 \ne 1$.
        \end{itemize}
        \item Порядок.\ Отношение <<\text{<}>> между вещественными числами.
        Формально, для множества $X$ отношение между его элементами --- это подмножество $L \subset X \times X$ и $x < y \iff (x, y) \in L$.
        \begin{itemize}
            \item Асимметричность $\forall x : !(x < x)$.
            \item $\forall x, y \in \R: x = y \lor x < y \lor y < x$.
            \item Транзитивность для трёх попарно различных $x, y, z \in \R$: $x < y \land y < z \then x < z$.
            \item $x < y \land a \in \R \then x + a < y + a$.
            \item $x < y \land a > 0 \then ax < ay$.

            \textit{Замечание}: Пусть $x < y \land a < 0$.
            Тогда $a + (-a) < -a \then -a > 0$. $(-a)x < (-a)y \then 0 < -ay + ax \then ay < ax$.

            \textit{Замечание}: Пусть $x < y \land a < b$.
            Тогда $x + a < y + a$, но из $a < b \then y + a < y + b$, откуда по транзитивности $x + a < y + b$.
        \end{itemize}
    \end{enumerate}
    Факт: Пусть $x \in \R \land \forall t > 0 : x \le t$.
    Тогда $x = 0 \lor x < 0$.
    \provehere{
        От противного. Пусть $x > 0$. Тогда $\exists t = \frac{1}{2}x > 0 \then \frac{1}{2}x + \frac{1}{2}x > \frac{1}{2}x \then x > \frac{1}{2}x$. Противоречие.
    }

    \newlection{9 сентября 2022 г.}


    \section{Неравенства}
    $a, b \in \R; a < b$.
    Тогда ещё пишут так: $b > a$.

    Ещё $a \le b \iff a < b \lor a = b; \quad a \ge b \iff a > b \lor a = b$.
    \fact{ $a \le b \land b \le a \iff a = b$.\begin{proof}
                                                  От противного.
    \end{proof}}

    \subsection{Модуль числа}
    $x \in \R \map |x| \bydef \switch{x, & x>0\\-x, & x<0\\0, & x=0}$.

    \subsubsection{Свойства модуля}
    \begin{gather*}
        -|x| \le x \le |x|\\
        a > 0 \land -a \le x \le a \then |x| \le a\\
    \end{gather*}
    \begin{proof}
        $ \left. \begin{aligned}
                     -|x| \le x \le|x|\\ -|y|\le y \le|y|
        \end{aligned}\right\}\then |x| - |y| \le x + y \le |x| + |y|$.
    \end{proof}
    \[\text{Неравенство треугольника для суммы: }|x + y| \le |x| + |y| \text{ или для разности: } |x| - |y| \le |x - y|.\]
    \begin{proof}
        $|x| = |x - y + y| \le |x - y| + |y| \then |x| - |y| \le |x - y|$
    \end{proof}
    Заметим, что из этого факта следует $|y| - |x| \le |x - y| \then \left||y| - |x|\right| \le |x - y|$.

    \subsection{Ещё о подмножествах прямой}
    Длина любого из отрезков $[a, b], (a, b), [a, b), (a, b]$ при условии $a \le b$ равна $b - a$.

    \subsubsection{Лучи}\down
    $a \in \R$ создаёт следующие лучи: \bullets{\item$[a; +\infty) \bydef \{x \in \R | x \ge a\}$;\item $(a; +\infty) \bydef \{x \in \R | x > a\}$;\item $(-\infty; a) \bydef  \{x \in \R | x \le a\}$; \item $(-\infty; a] \bydef  \{x \in \R | x < a\}$.} $a$ называется началом луча.

    \definition[Ограниченность] {Для подмножества прямой $E \subset \R: E$ ограничено сверху (снизу), если $\exists a \in \R: \forall x \in E: x \le a (x \ge a)$. Любое такое число $a$ для множества $E$ называется верхней (нижней) границей.
    }


    \section{Ещё три аксиомы вещественных чисел}
    \textit{Ниже приведены аксиомы, отличающие $\R$ от произвольного упорядоченного поля.}

    \subsection{Аксиома Архимеда}
    Множество $\N$ натуральных чисел не ограничено сверху.
    \corollary {
        $\forall x \in \R: \exists n \in N : x \le n$.
        \begin{proof}
            От противного.
        \end{proof}
    }
    \corollary{Пусть $x \in \R : \forall n \in \N : x \le \dfrac{1}{n}$. Тогда $x \le 0$.
    \provehere{От противного.}}

    \subsection{Аксиома индукции}
    Для $\varnothing \ne E \subset \N: ~\exists $  наименьший элемент $n:~\forall m \in E: m \ge n$.
    \note{Пусть $E \subset \Z$.
    Если $E$ --- ограничено снизу, то в $E$ есть наименьший элемент.
    \provehere{
        Пусть $a$ --- нижняя граница.
        Тогда $\exists k \in \N : k > -a$.
        Несложно видеть, что $-k$ --- тоже нижняя граница множества $E$.
        Тогда $\{k + n | n \in E\} \subset \N$, дальше понятно.
    }}

    \note{Пусть $I = \langle a; b\rangle$, где каждая граница может быть как включена, так и нет. $b > a$. $s \in \R_+$.
    Тогда $\exists r \in \Q : rs \in I$.
    Заметим, что для $s = 1$ это равносильно тому, что в любом невырожденном отрезке есть рациональное число.
        \begin{proof}
            $d \coloneqq b - a$ --- длина отрезка.
            Найдём $q \in \N: \dfrac{s}{q} < \dfrac{d}{2}$.
            Оно есть из аксиомы Архимеда.
            Назовём $E \coloneqq \defset{ m \in \Z }{ m\dfrac{s}{q}\ge b}$.
            Так как $m \ge \dfrac{bq}{s}$, то в $E$ есть наименьший элемент $m_0$.
            Рассмотрим тогда $(m_0 - 1)\dfrac{s}{q}$ Тогда с одной стороны $(m_0 - 1)\dfrac{s}{q} < b$, а с другой --- $(m_0 - 1)\dfrac{s}{q} \ge b - \dfrac{s}{q} > b - \dfrac{d}{2} > a$.
        \end{proof}
    }

    \note{Отсюда любое утверждение можно доказать по индукции, по следующей схеме:

    Пусть $S_1, S_2, \dots$ --- утверждения.
    Предположим, что
    \numbers{
        \item $S_1$ истинно
        \item Для $n > 1: ~S_n$ следует из $S_{n-1}$.
    } Тогда все утверждения верны.
    \provehere{
        От противного.\ Пусть $W = \{n \in \N|\neg S_n\}$.
        Если $W \ne \varnothing$, то в $W$ есть наименьший элемент, для которого можно показать, что это не так.
        Противоречие.
    }}

    \fact[Неравенство Бернулли]{$\forall a \ge -1, n \in \N:~(1+a)^n\ge 1 + an$
        \begin{proof}
            По индукции.
            А именно, $S_n \coloneqq (1 + a)^n \ge (1 + an)$.
            Проверим, что $S_1$ верно.
            В самом деле, $S_1 = (1 + a)^1 \ge (1 + a \cdot 1)$.
            Это верно.
            Дальше, проверим переход $S_n \then S_{n+1}$ для $n \ge 1.~(1 + a)^n \ge (1 + an) \then (1 + an) \cdot (1 + a) = 1 + a(n + 1) + a^2 n \ge 1 + a(n + 1)$.
        \end{proof}
        \corollary{Для данного $a > 0$ множество $\{(1 + a)^n|n\in\N\}$ не ограничено. }
    }

    \subsection{Аксиома Кантора-Дедекинда}
    \definition[Щель]{Два множества $\varnothing \ne A, B \subset \R$ образуют щель, если $\forall x \in A, y \in B: x \le y$.\fact{Любое число из одного множества --- граница другого множества.}}
    Говорят, что щель содержит число $x$, если $\forall a \in A, b \in B: a \le x \le b$.\newline\textbf{Формулировка аксиомы:} Любая щель содержит по крайней мере одно вещественное число.

    \note{$\Q$ --- множество рациональных чисел; $\Q = \defset{\dfrac{m}{n}}{m \in \Z, n \in \N}$. Несложно видеть, что лишь последняя аксиома позволяет различить $\Q$ и $\R$.}

    \fact{$\nexists r \in \Q : r^2 = 2$
        \begin{proof}
            Предположим, что есть.
            НУО $r > 0$, так как для $r = 0$ утверждение неверно, а из $r^2 = 2 \then (-r)^2 = 2$.
            Тогда $r \in \Q : \exists p, q \in \Z : \frac{p}{q} = r \land (p; q) = 1$.
            Круглыми скобками обозначен наибольший общий делитель двух данных чисел.
            Тогда $\frac{p^2}{q^2} = 2 \then p^2 = 2q^2$.
            Справа чётное число, откуда $p$ чётно, но тогда обе части уравнения делятся на $4$ и $q$ чётно.
            Значит, наибольший общий делитель $p$ и $q$ делится на $2$ и не равен $1$.
            Противоречие.
        \end{proof}}
    \newlection{12 сентября 2022 г.}
    \theorem{$\exists! r \in \R_{>0} : r^2 = 2$}
    \begin{proof}
        Воспользуемся аксиомой Кантора-Дедекинда.

        Пусть $A \coloneqq \{x\in \R | x > 0 \land x^2 < 2\};\quad B \coloneqq \{x \in \R | x > 0 \land x^2 > 2\}$.
        Они образуют щель, так как $\forall x \in A, y \in B : x \le y$.
        От противного: пусть $\exists x \in A, y \in B : x > y$.
        Но так как $x, y > 0$, то неравенство можно возвести в квадрат и получить противоречие --- из транзитивности с $2: x^2 < y^2$.
        \note{
            Возведение в квадрат возможно из транзитивности: $x < y \then \switch{\cdot x&x^2 < xy\\ \cdot y &xy < y^2}$
        }
        Рассмотрим вещественное число $c \in \R$, лежащее в этой щели.
        \indentlemma{
            В множестве $A$ нет наибольшего числа, в множестве $B$ --- нет наименьшего.
        }{\bullets{
            \item Пусть $y \in B$.
            Докажем, что $\exists \eps \in (0; 1) : y - \eps \in B$.
            Надо выбрать $\eps$ так, чтобы $(y - \eps)^2 > 2\iff y^2 - 2y\eps + \eps^2 > 2$.
            Тогда подойдёт любое $\eps < \min\left(\dfrac{y^2-2}{2y}, 1\right)$.
            \item Пусть $x \in A$. Найдём $\eps \in (0; 1) : (x + \eps)^2 < 2 \iff x^2 + 2x\eps +\eps^2 < 2$.
            Но --- чудесное дело --- $\eps^2 < \eps$. Тогда подойдут все $\eps < \min\left(\dfrac{2 - x^2}{2x + 1}, 1\right)$.
            Возьмём любой такой.
        }
        }

        Отлично, а почему $c^2 = 2$?
        От противного.
        Тогда $c^2 < 2 \lor c^2 > 2$.
        Тогда --- из $c > 0$ --- $c \in A \lor c \in B$.
        Но заметим, что в любом случае оно не окажется наибольшим (наименьшим) элементом --- потому что таких нет.
        Значит, $c$ не лежит в щели.
        Противоречие.
        Отсюда $c^2 = 2$.

        Теперь докажем, что положительное число, при возведении в квадрат дающее $2$ единственно.
        От противного: пусть $c_1, c_2 > 0 : \begin{cases}
                                                 c_1^2 = 2 \\ c_2^2=2
        \end{cases}\then(c_1-c_2)(c_1+c_2) = 0 \then c_1 = c_2$.
    \end{proof}
    Обозначим данное число $\sqrt{2}$
    \corollary{На любом невырожденном отрезке $\langle a; b\rangle$ есть иррациональное число. Для этого рассмотрим рациональное кратное $\sqrt{2}$, попадающее в этот отрезок --- применение леммы с предыдущей лекции.}


    \chapter{Грани, замкнутость, предельные точки, пределы}
    Пускай $\varnothing \ne A \in \R$ --- ограниченное сверху множество.
    По определению $\exists x \in \R : \forall a \in A : a \le x$.
    Пусть $B$ --- множество всех верхних границ для $A$.
    \theorem{В множестве $B$ существует наименьший элемент.
    \prove{
        \note{Несложно убедиться, что для пустого множества это неправда, а для $A = (0; 1)$ или же $A = [0; 1]$ это верно.}

        Заметим, что $(A; B)$ --- щель по определению.
        Тогда $\exists c \in \R$, лежащее в этой щели.

        $\forall a \in A, x \in B : a \le c \le x$.
        Из левого знака $c$ --- верхняя граница для $A$, т.\ е.\ $c \in B$.
        Из правого знака $c$ --- наименьший элемент в $B$.
    }\fact{Теорема эквивалентна аксиоме Кантора-Дедекинда, и можно постулировать любую из них.}}
    \definition[(Точная) верхняя) грань]{Это число $c$ называется (точной) верхней гранью множества $A$, иначе говоря супремум (supremum). $c = \sup A$.}

    Аналогичная теорема верна для непустого множества $A$, ограниченного снизу.
    Здесь точная нижняя грань называется инфимум (infimum). $c = \inf A$.

    \theorem[Об описании граней]{
        Пускай $A \subset R$ --- множество, ограниченное сверху (внизу).
        Следующие условия эквивалентны:
        \numbers{
            \item $c$ --- супремум (инфимум) множества $A$.
            \item $c$ --- верхняя (нижняя) граница для $A$ и $\forall \eps > 0: \exists y \in A: c - \eps < y$ ($y < c + \eps$).
        }
        \provebullets{\item $(1) \then (2)$

            Так как $c$ --- наименьший (наибольший) элемент множества границ, то $c - \frac{\eps}{2}$ или $(c + \frac{\eps}{2})$ уже не является границей. Значит, есть элемент из $A$, больший $c - \eps$ (меньший $c + \eps$).

            \item $(2) \then (1)$

            Пусть $c$ удовлетворяет условию $(2)$. Докажем, что $c$ --- наименьшая (наибольшая) верхняя граница. Если не так, то есть число меньше (больше) $c$, всё ещё являющееся верхней (нижней) границей. Тогда получаем противоречие с $(2)$.
        }
    }

    \subsection{Небольшая серия определений и теорем из топологии}

    \definition[Окрестность]{Пусть $x \in \R$. Окрестностью точки $x$ называется любой интервал вида $(x - \eps; x + \eps)$ для $\eps > 0$. Для данного $\eps$ окрестность называется <<$\eps$-окрестность>>. Число $x$ называется центром окрестности, и $\eps$ --- радиусом.
    Обозначают $U_{\eps}(x) = V_{\eps}(x)$. }
    \definition[Проколотая окрестность]{Окрестность за вычетом точки $x$. Обозначается $\overset{o}{U}_{\eps}(x) = \overset{o}{V}_{\eps}(x)$. $\overset{o}{U}_\eps(x) = (x - \eps; x) \cup (x; x + \eps)$.}
    \definition[Предельная точка]{Точка $x$ называется предельной точкой для $A \subset \R$, если $\forall~ \overset{o}{U}_{\eps}(x) : \overset{o}{U}_{\eps}(x) \cap A \ne \varnothing$. Предельные точки множества $A$ обозначаются $A'$.
    \fact{Предельными точками $(0; 1)$ являются все точки отрезка $[0; 1]$. Ровно такие же предельные точки есть у множества $(0; 1) \cup \{2\}$. Здесь $2$ --- изолированная точка.}}
    \definition[Изолированные точки]{ Точка $x$ называется изолированной для $A$, если $x \in A$ и $x$ не является предельной точкой множества $A$.}
    \newlection{16 сентября 2022 г.}
    \proposal{Пусть $A \subset \R, A$ --- ограничено сверху (внизу). Пусть $\sup A \notin A$ ($\inf A \notin A$). Тогда $\sup A$ ($\inf A$) --- предельная точка множества $A$.}
    \begin{proof}
        [Доказательство для $\sup A$]
        Пусть $x = \sup A; x \notin A$.
        Рассмотрим любую $\overset{o}{U}_\eps(x)$.
        По теореме об описании супремума $\exists y \in A: y > x - \eps$.
        Так как $x \notin A$, то $y \ne x$.
        Тогда по определению $x$ --- предельная точка $A$.
    \end{proof}
    \definition[Замкнутое множество]{Множество, содержащее все свои предельные точки.}
    Примеры:
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        Замкнутые множества & $\{ x \}$ & $[a; b]$ & $\{0\} \cup \defset{\dfrac{1}{n}}{n \in \N}$ & $\varnothing$ \\
        \hline
        Не замкнутые множества: & $[a; b)$ & $(a; b)$ & $\defset{\dfrac{1}{n}}{n \in \N}$ \\
        \cline{1-4}
    \end{tabular}
    \theorem[О связности отрезка]{\label{segment_connectivity}
    Пусть $a < b$, тогда отрезок $[a; b]$ нельзя представить в виде объединения двух непустых непересекающихся замкнутых множеств

    \provehere{
        От противного: пусть $E_1, E_2 \in [a; b], E_1 \cap E_2 \ne \varnothing, E_1 \cup E_2 = [a; b]$. $\exist E \in \{E_1, E_2\} : \sup E \ne b$.
        \indentlemma{
            Замкнутое (непустое) множество содержит свои грани, каждую --- если она есть.
        }{
            Пусть $x = \sup C$. Если $x \notin C$, то $x$ --- предельная точка $C$, откуда из замкнутости всё же $x \in C$.
        }
        В самом деле, если у обоих $\sup E = b$, то $E_1 \cap E_2 \ne \varnothing$.
        Без потери общности $b \in E_1 \quad \then \quad \sup E_1 =b; \sup E_2 < b$.
        Тогда $(\sup E_2; b] \in E_1$, откуда $\sup E_2 \in E_1' = E_1$, противоречие.
    }
    }
    \theorem[Об описании чисел в щели]{Пусть $(A; B)$ --- щель. Тогда множество чисел, лежащих в щели --- $[\sup A; \inf B]$.}
    \provehere{
        Так как $A, B \ne \varnothing$, то $\exists~ \sup A, \exists~ \inf B$.

        \bullets{\item[$\then$.] Рассмотрим $z$ в щели. Тогда $z$ --- верхняя граница $A$ и нижняя граница $B$, откуда $z \ge \sup A; z \le \inf B$.

        \item[$\when$.] Если $z \in [\sup A; \inf B]$, то $z \ge \sup A$ и $z$ --- верхняя граница $A$. Аналогично $z$ --- нижняя граница $B$, откуда $z$ лежит в щели.\qedhere
        }
    }
    \definition[Узкая щель]{Щель, в которой лежит ровно одно число. Щель $(A; B)$ --- узкая $\iff$ $\sup A = \inf B$.}
    \proposal{Пусть $(A; B)$ --- щель. Следующие условия эквивалентны:

    \numbers{
        \item Щель $(A; B)$ -- узкая.
        \item $\forall \eps > 0 : \exists x \in A, y \in B: y - x < \eps$
    }}
    \begin{proof}
        $(2) \then (1)$.
        От противного: $\exist x, y \in (A; B): x < y$.
        Тогда $x$ --- верхняя граница $A$, $y$ --- нижняя граница $B$, и для $\eps = y - x$ получаем противоречие.

        $(1) \then (2)$: Из $(1)$: $\sup A = \inf B = p$.
        Так как супремум и инфимум --- точные грани, то $\forall \eps > 0: A \cap \left[p - \frac\eps3; p\right] \ne \varnothing \land B \cap \left[p; p + \frac\eps3\right] \ne \o$ (если не так, то существует более точная грань).
    \end{proof}

    \theorem[Теорема о вложенных отрезках]{Рассмотрим последовательность непустых отрезков $\{[a_n; b_n]\}_{n \in \N}$. Говорят, что это последовательность вложенных отрезков, если $[a_{n+1}; b_{n+1}] \subset [a_n; b_n]$.

    Такая последовательность имеет непустое пересечение $\left(\underset{i \in \N}{\bigcap} [a_i; b_i]\right) \ne \o$;

        $\exist x: \forall i \in \N: x \in [a_i; b_i]$.

        Это пересечение состоит из одной точки $\iff$ среди этих отрезков встречаются отрезки со сколь угодно малой длиной. }
    \begin{proof}
        Благодаря вложенности, $a_n \le a_{n+1} \land b_n \ge b_{n+1}$.
        Благодаря транзитивности $\forall n \le m \in \N: a_n \le a_m \land b_n \ge b_m$.

        Покажем, что $\forall n, m \in \N: a_n < b_m$.
        Для $n \le m: a_n \le a_m \le b_m$.
        Для $n > m: a_n \le b_n \le b_m$.
        Отсюда $\left(\{a_n\}_{n\in\N}, \{b_n\}_{n \in \N}\right)$ --- щель.
        Тогда число в данной щели $z: \forall i \in \N: a_i \le z \le b_i$.

        Про единственность пересечения: пересечение $\left(\underset{i \in \N}{\bigcap}[a_i; b_i]\right)$ одноточечно $\iff$ щель $(A; B)$  --- узкая.

        Пусть щель узкая, докажем, что есть сколь угодно маленький отрезок: $\forall \eps > 0: \exist x \in A,  y \in B: y - x < \eps$.
        Пусть $x = a_i, y =b_j$ для неких $i, j \in \N$.
        Тогда для $n = \max(i, j): |b_n - a_n| < \eps$.
    \end{proof}
    \fact{Теорема эквивалентна аксиоме Кантора-Дедекинда}
    \newlection{17 сентября 2022 г.}
    \theorem[О компактности (первая форма)]{\label{segment_compactivity_1} Вторая форма приведена здесь:~\ref{segment_compactivity_2}.

    Всякое непустое ограниченное бесконечное множество $A \subset \R$ имеет предельную точку.
    \begin{proof}
        Раз $A$ ограничено, то $\exists a_0, b_0 \in \R : a_0 < b_0 \land A \subset [a_0; b_0]$.

        Обозначим $c_i = \frac{a_i + b_i}{2}$.
        На $i$-м шаге рассмотрим два отрезка $[a_i; c_i]$ и $[c_i; b_i]$ и выберем среди них тот, который при пересечении с множеством $A$ остаётся бесконечным множеством.
        Формульно, $[a_{i+1}, b_{i+1}] = \switch{[a_i, c_i],&|A \cap [a_i; c_i]| = \infty\\ [c_i, b_i], & \text{otherwise${}^*$}}$

        * --- от противного легко получить, что здесь $\left|[c_i; b_i] \cap A\right| = \infty$, так как $|[a_i; b_i] \cap A| = \infty$.

        Так как $b_{i+1} - a_{i + 1} = \frac{b_i - a_i}{2}$, то из индукции $b_i - a_i = (b_0 - a_0) \cdot 2^{-i}$.
        Например, из неравенства Бернулли и аксиомы Архимеда, эта последовательность длин содержит сколь угодно малые числа.

        Таким образом, в данной последовательности отрезков каждый следующий вложен в предыдущий, и применима теорема о вложенных отрезках. $\exists! P \in \left(\underset{i \in \N_0}{\bigcap}[a_i; b_i]\right)$.

        \fact{$P$ является искомой предельной точкой.}
        Для доказательства достаточно убедиться, что $\forall \eps > 0 : A \cap \overset{o}{V}_{\eps}(P) \ne \o$.
        И в самом деле, найдём $n \in \N: ~b_n - a_n < \eps$.
        По построению отрезков $|[a_n; b_n] \cap A| = \infty$.
        Так как $[a_n; b_n] \cap \neighborhood{P} = [a_n; b_n] \bs \{P\}$, то $|\neighborhood{P}\cap A| = \infty$, откуда непусто.
    \end{proof}
    }
    \definition[Замыкание множества $A$]{Обозначается $\overline{A}$, или $\cl A$, или $\clos A$. $\clos A \bydef A \cup A'$ --- объединение множества и его предельных точек.}
    \proposal{$\clos A$ --- замкнутое множество, то есть $(\clos A)' \subset \clos A$.}
    \begin{proof}
        Пусть $X \in (\clos A)'$.

        Покажем, что $X \in \clos A$.
        Для этого убедимся, что $\forall \eps > 0 : \neighborhood{X} \cap A \ne \o$, то есть $X \in A'$.

        Поскольку $X \in (\clos A)'$, то $\exist Y \in \clos A \cap \neighborhood{X}$.
        \numbers{
            \item Если $Y \in A$, то $Y$ содержится в искомом пересечении $\neighborhood{X} \cap A$
            \item Иначе $Y \in A'$. Заметим, что $|XY| < \eps$. Тогда по определению $\exist Z \in \neighborhood[{\eps - |XY|}]{Y} \cap A$. В таком случае $Z$ лежит в искомом пересечении.}
    \end{proof}

    \subsection{Десятичная запись вещественного числа}
    Рассмотрим $x \in \R_{\ge 0}$.
    Для такого $\exist! n \in \N_0:~n \le x < n + 1$. $n = [x]$.
    Назовём десятичной записью неотрицательного числа $x$ конкатенацию десятичной записи целого числа $\lfloor x \rfloor$, запятой, и некоего остатка, идентичного для всех чисел, эквивалентных отношением $\simeq: x \simeq y \iff (x - y) \in \Z$.
    Для отрицательных чисел $x$ запись является записью $-x$ с минусом в начале.

    Рассмотрим десятичную запись чисел $x \in [0; 1)$.
    Разобьём отрезок на 10 подотрезков $I_i = \left[\frac{i}{10}; \frac{i+1}{10}\right), ~ i \in \{0, \dots, 9\}$.
    Это разбиение, поэтому $\exist ! j_1 \in [0; 10) \cap \N_0 : ~ x \in I_{j_1}$.
    Допишем $j_1$ в конец числа.
    Разобьём аналогично полуинтервал $I_{j_1}$ на $10$ равных частей $\left[\frac{j_1}{10} + \frac{i}{10^2}; \frac{j_1}{10} + \frac{i + 1}{10^2}\right), ~ i \in \{ 0, \dots, 9\}$.

    \fact{Десятичная запись числа однозначно определяет число.}
    \begin{proof}
        От противного.
        Пусть запись $x$ и $y$ совпадают.
        Но заметим, что на $k$-м шагу длина рассматриваемых интервалов $\dfrac{1}{10^k}$, поэтому рано или поздно встретится интервал длиной меньше $|y - x|$, и они попадут в разные интервалы.
        Тогда на первой такой позиции, что $x$ и $y$ попадут в разные интервалы, цифры не совпадут.
    \end{proof}
    \fact{Десятичная запись, оканчивающаяся на бесконечную последовательность $9$, не соответствует ни одному числу.}
    \question{Являются ли десятичной записью все остальные подходящие по формату строки?}

    Рассмотрим вложенную последовательность полуинтервалов $[a_i; b_i)$, каждый из которых содержит данное число. $b_i - a_i = \frac{1}{10^i}$.
    Заметим, что для доказательства, что ответ на проблему утвердительный, необходимо и достаточно доказать, что пересечение $\left(\underset{i \in \N}{\bigcap}[a_i; b_i)\right) \ne \o$.

    \fact{Пусть задана последовательность вложенных полуинтервалов $[l_i, r_i) \ne \o$. Среди них есть сколь угодно малые. Пересечение этих полуинтервалов пусто $\iff \exist n \in \N: \forall i > n: r_i = r_n$.}
    \begin{proof}
        Пусть $\{X\} = \left(\underset{i \in \N}{\bigcap}[l_i; r_i]\right)$ --- по теореме о вложенных отрезках это множество действительно состоит из одной точки.
        Тогда $\forall i \in \N : X \in [l_i; r_i]$.

        Что означает, что $X \notin \left(\bigcap\limits_{i \in \N}[l_i; r_i)\right)$? Это означает, что $\exist k \in \N: X \notin [l_k; r_k)$.
        Но это эквивалентно тому, что $X \notin [l_j, r_j)~ \forall j \ge k$.
        Однако $X \in [l_j; r_j] ~\forall j \ge k$.
        Отсюда $X = r_j~\forall j \ge k$.
    \end{proof}
    \newlection{24 сентября 2022 г.}


    \section{Пределы}
    Функция: $f : A \map \R: ~ A \subset \R$.
    На доске во время лекций были приведены графики функций ниже.
    \numbers{
        \item $f(x) = \switch{1,&x \ne 0\\0,& x = 0}$.
        \definition[Характеристическая функция $B \subset \R$]{$\chi_B(x) = \switch{1, &x \in B \\ 0, &x \notin B }$.}
        \item $f(x) = \chi_{[0; 1)}$.
        \item $f(x) = x$.
        \item Функция Дирихле $D = \chi_\Q$.
        \item $f(x) = \chi_{\{0\} \cup [1; 2]}$.
        \item $f(x) = \switch{\sin\left(\frac{1}{x}\right),&x \ne 0\\ 10, &x = 0}$.
    }
    Поведение функции вблизи в точке $0$ --- нас интересуют проколотые окрестности точки $0$.
    Поведение функций $1$ и $2$ вблизи нуля разное --- слева от нуля в любой окрестности $f_1(x) = 1$, но $f_2(x) = 0$.

    Поведение функций $1, 3, 5$ вблизи нуля схожи --- в проколотой окрестности нуля они близки к какому-то одному значению.

    Функции $2, 4, 6$ в этом отношении плохие.
    \numbers{
        \item[7.] Рассмотрим $f(x) = \chi_{(0; 1)}$, определённую на $A = (0; +\infty)$. Поведение функции в точке $0$ тоже является хорошим --- для маленькой окрестности нуля там, где она задана, там она равна $1$.
        \item[8.] $f(x) = x; \quad \dom_f = A = \defset{\frac{1}{n}}{n \in \N}$. Опять похожая на первую, хорошая, функция.
    }
    \emph{Хорошая функция --- есть предел.}

    \subsection{Определение предела}
    Предел последовательности --- предел функции, определённой на натуральных числах.

    Пусть дана функция, определённая на множестве $A \subset \R$.
    О пределе в точке $x_0$ можно говорить, только если $x_0 \in A'$ --- предельная точка $A$. $x_0$ может не лежать в $A$.
    Формально, $A = \N$ не содержит предельных точек.
    Однако нам будет удобно считать бесконечность предельной точкой $\N$.
    \definition[Окрестность точки $+\infty$]{Любой луч вида $(a; +\infty) = \{x \in \R|x > a\}$.}
    \definition[Окрестность точки $-\infty$]{Любой луч вида $(-\infty; a) = \{x \in \R|x < a\}$.}
    Эти же окрестности будем считать проколотыми, так как они не содержат саму бесконечность.

    Говорят, что $+\infty$ есть предельная точка $A$, если в любой (проколотой) окрестности точки $+\infty$ есть точки множества $A$.
    Это определение показывает схожесть конечных и бесконечных предельных точек.
    Говоря же более простым языком --- $A$ не ограничено сверху.
    В частности $+\infty $ --- предельная точка $\N$.

    \definition[Конечный предел]{Число $c \in \R$ называется пределом функции $f : A \map \R$ в точке $x_0$, если
        $\forall ~U({c}): \exists \neighborhood{x_0} : \quad f\left(\neighborhood{x_0} \cap A\right) \subset U(c)$.
    }

    \subsection{Примеры}
    Так, предел функции $f(x) = |x|$ в нуле равен нулю, так как для окрестности $U(c)$ можно взять окрестность $\neighborhood[]{0}$ такого же радиуса.

    По тем же самым причинам предел функции $f(x) = \switch{-(x - 1),&x \ge 1\\ 0,&x < 1}$ в $x_0 = 1$ тоже $0$ --- опять подойдёт окрестность такого же радиуса.

    \fact{Функция Дирихле $D = \chi_\Q$ не имеет предела ни в одной точке. $\dom_D = \R$.}
    \provehere{
        Предельными точками $\R$ являются $\R \cup \{+\infty; -\infty\}$.

        От противного: пусть $c \in \R$: предел функции $D$ в некой точке $x_0$. Но рассмотрим тогда окрестность $U(c) = \left(c - \frac{1}{10}; c + \frac{1}{10}\right)$. По определению предела $\exists \neighborhood[]{x_0} : ~ D(\neighborhood[]{x_0}) \subset U$. Но $D(\neighborhood[]{x_0})$ одновременно содержит и $0$ и $1$, а $U$ имеет диаметр всего $\frac{1}{5}$. Значит, предела нет.
    }

    $f(n) = \dfrac{(-1)^n}{n}$ для $n \in \N$.
    Предельной точкой $\N$ является только $+\infty$.
    В ней предел равен $0$. \provehere[Вот, почему:]{Рассмотрим некую окрестность нуля $U_\eps(0) = (-\eps; +\eps)$. Надо найти $a \in \R: ~ {\forall n > a}:$\\${f(n) \in U}$, то есть $|f(n)| < \eps$. Получается, необходимо $\frac{1}{n} < \eps$, или же $n > \frac{1}{\eps}$. Окрестность нашлась, предел существует и равен $0$.}

    $f(n) = (-1)^n$ для $n \in \N$.
    Предела на бесконечности нет, показывается от противного аналогично функции Дирихле.

    \definition[Функция Римана]{\label{Riemann_function_def}
    Пусть $r \in \Q$. Тогда $\exists! ~q \in \N, p \in \Z: r = \frac{p}{q}$ и дробь несократима. Тогда функция Римана $r(x) = \switch{0,&x \in (\R \bs \Q) = \I\\ \frac{1}{q},&x\in\Q}$.}
    \fact{В любой конечной точке предел функции Римана равен $0$.\provehere{
        Очевидно, что никакого предела, кроме $0$ не бывает, так как сужение функции Римана на $\I$ имеет предел $0$ в любой точке. Проверим, что $0$ --- предел в $x_0 \in \R$. Рассмотрим $U(0) = (-\eps; +\eps)$.
        Найдём для каждой такой подходящую окрестность точки $x_0$, найти $\neighborhood[\delta]{x_0}: ~ r(\neighborhood[\delta]{x_0}) \in U$. Если $t \in \neighborhood[\delta]{x_0} \land t \in \I$, то $r(t) \in U$.

        Таким образом, нас интересуют точки $t \in \Q$. Заметим, что любые два числа со знаменателем $q$ отстоят друг от друга по крайней мере на $\frac{1}{q}$. Но выберем тогда $\delta$ настолько маленькой, чтобы все числа со знаменателем $q > \frac{10}{\eps}$ не попадали в $\neighborhood[\delta]{x_0}$.

        Почему так можно сделать? Если $x_0$ --- рациональное число с маленьким знаменателем $q \le \frac{10}{\eps}$, то выберем окрестность, чтобы не захватить других чисел такого вида. Иначе в окрестность может попасть число с маленьким знаменателем, но мы уменьшим окрестность, чтобы данное число было не ближе, чем на границе окрестности.

        Так можно сделать всегда, так как в окрестности фиксированного радиуса есть конечное количество чисел со знаменателем $q \le \frac{10}{\eps}$, можно найти ближайшие к $x_0$.
    }}

    \subsection{Свойства}
    \theorem[Единственность предела]{
        Если предел функции $f: A \map \R~(A\subset \R)$ в точке $x_0 \in \left(\R \cup \{\pm\infty\}\right)$ --- предельной точке $A$ --- существует, то он единственный. Не может быть двух разных.
        \provehere{
            Предположим противное: $c_1 \ne c_2$ --- пределы для $f$ в точке $x_0$.
            Тогда $\exists U_1(c_1), U_2(c_2) : U_1(c_1) \cap U_2(c_2) = \o$ --- непересекающиеся окрестности точек $c_1$ и $c_2$ соответственно. Такие можно найти, взяв их радиусом $0 < \eps < \frac{|c_1 - c_2|}{2}$.
            Из определения предела: $\exists \neighborhood[1]{x_0} : f(\neighborhood[1]{x_0}) \subset U_1$. Кроме того, $\exists \neighborhood[2]{x_0} : f\left(\neighborhood[2]{x_0}\right) \subset U_2$.
            Но тогда внутри $\neighborhood[1 \cap 2]{x_0} \coloneqq \neighborhood[1]{x_0} \cap \neighborhood[2]{x_0}$ --- одной из этих двух окрестностей --- функция $f$ не может существовать: $f\left(\neighborhood[1 \cap 2]{x_0}\cap A\right) \subset \left(U_1 \cap U_2\right) = \o$. Но $x_0$ --- предельная точка, откуда пересечение $\neighborhood[1 \cap 2]{x_0}\cap A$ непусто, противоречие.
        }}

    \subsection{Обозначения предела}
    Предел функции $f$ в точке $x_0$ обозначается $\lim_{x_0}f = c$, или $\lim\limits_{x \map x_0}f(x) = c$, или $f(x) \underset{x \map x_0}{\map} c$.
    Запись $\lim_{x_0}f = c$ значит, что предел у $f$ в точке $x_0$ существует и равен $c$.
    \newlection{26 сентября 2022 г.}
    \note{$A \subset \R; x_0 \in A', f : A \map \R, \forall x \in A: f(x) = c$. Тогда $\lim_{x_0}f = c$ --- предел существует и равен $c$.\provehere{
        Рассмотрим $U(c)$. Для произвольной $\neighborhood[]{x_0}: f\left(\neighborhood[]{x_0} \cap A\right) \subset U$ --- верно, так как $f(A) = \{c\}$.
    }}

    \note{$A \subset \R; x_0 \in A', f : A \map \R, \forall x \in A: f(x) = x$. Тогда $\lim_{x_0}f = x_0$ для произвольной конечной точки $x_0$.\provehere{
        Рассмотрим $U_{\eps}(x_0)$. Для $\neighborhood{x_0}$ такого же радиуса, что и $U_{\eps}(x_0)$:\\ $f\left(\neighborhood{x_0} \cap A\right) \subset U_{\eps}(x_0)$ --- верно, так как $f = \id$.
    }}

    \subsection{Предел в терминах неравенств}
    Пусть $x \in \R$.
    Любая её окрестность имеет вид $(x - \eps; x + \eps)$. \newline $y \in U_\eps(x_0) \iff |y - x| < \eps$.

    Пусть $\alpha \in \R$.
    Проколотая окрестность $\neighborhood[\delta]{\alpha}$ имеет вид $(\alpha - \delta; \alpha + \delta) \bs \{\alpha\}$. \newline $y \in \neighborhood{\alpha} \iff y \ne \alpha \land |y - \alpha| < \delta$.

    $\lim_{x_0}f = c \iff \forall U(c) : \exists \neighborhood{x_0}: f\left(\neighborhood{x_0} \cap A\right) \subset U$.

    $\begin{aligned}
         x_0 \in \R: \lim_{x_0}f = c \iff \forall \eps > 0:~ &\exists \delta > 0 : &((x \in A \land |x - x_0| < \delta \land x \ne x_0) \then & |f(x) - c| < \eps).\\
         x_0 = +\infty: \lim_{+\infty}f = c \iff \forall \eps > 0:~ &\exists a : &((x \in A \land x > a)\then &|f(x) - c| < \eps).\\
         x_0 = -\infty: \lim_{+\infty}f = c \iff \forall \eps > 0:~ &\exists a :& ((x \in A \land x < a)\then &|f(x) - c| < \eps).
    \end{aligned}$

    Пусть $P$ --- свойство функции;\ пусть $f: A \map \R$ --- функция: пусть $x_0 \in A'$.

    Говорят, что функция $f$ обладает свойством $P$ вблизи точки $x_0$, если $\exists \neighborhood{x_0} : f\Big|_{\neighborhood{x_0}\cap A}$ --- сужение $f$ на $\neighborhood{x_0}\cap A$ --- обладает свойством $P$.

    \ok

    \theorem{Пусть $f, g : A \map \R$. $x_0 \in A'$. Если $\lim_{x_0}f = c$ и $\lim_{x_0}g = d$, при чём $c < d$, то $f(x) < g(x)$ вблизи $x_0$.\provehere{Рассмотрим $\eps < \frac{d - c}{2}$. Для такого $\eps$ существуют окрестности $\neighborhood{x_0}$ и $\neighbourhood{x_0}$ такие, что функции $f$ и $g$ в этих окрестностях принимают значения, близкие к $c$ и $d$ соответственно. Тогда $\forall x \in \left(\neighborhood{x_0} \cap \neighbourhood{x_0} \cap A\right)$ неравенство верно. }}

    \note{Отсюда ещё раз следует единственность предела: если $\lim_{x_0} f = c$ и $\lim_{x_0} f = d$, $c < d$, то в некой окрестности $x_0$: $f(x) < f(x)$.}

    \theorem[Предельный переход в неравенствах]{$u, v : A \map \R, ~x_0 \in A', u(x) \le v(x)$ вблизи $x_0$. Если $\lim_{x_0} u = \alpha$ и $\lim_{x_0} v = \beta$, то $\alpha \le \beta$.\provehere{От противного.}}\note{Если в окрестности $x_0$: $u(x) < v(x)$, то это не значит, что $\lim_{x_0} u < \lim_{x_0} v$ даже в случае существования этих пределов. Так, можно взять вблизи $x_0 = 0$ функции $u(x) = 0$ и $v(x) = x$, определённые на $(0; +\infty)$.}

    \theorem[Теорема о двух полицейских]{$A \subset \R, x_0 \in A'; ~ f, g, h: A \map \R$. Предположим, что $f(x) \le g(x) \le h(x)$ вблизи $x_0$. Также положим, что $\lim_{x_0} f = c = \lim_{x_0} h$. Тогда $\lim_{x_0} g = c$
        \prove{
            Рассмотрим $\neighborhood[1]{x_0}$ такую, что на ней выполняется неравенство.

            $\forall U(c) : \exists \neighborhood[2]{x_0}$ такая, что $f\left(\neighbourhood[2]{x_0}\right) \subset U(c)$ и $g\left(\neighborhood[2]{x_0}\right) \subset  U(c)$.

            Тогда $\forall U(c) : \neighborhood[3]{x_0} = \neighborhood[1]{x_0} \cap \neighborhood[2]{x_0}$ такова, что $f\left(\neighborhood[3]{x_0}\right) \subset U(c)$ и по определению $\lim_{x_0} f = c$.
        }}
    \ok
    \note{$\lim\limits_{x\map x_0}f(x) = c \iff \lim\limits_{x\map x_0}(f(x) - c) = 0 \iff \lim\limits_{x\map x_0}|f(x) - c| = 0$\prove{
        Если расписать по определению любое из трёх выражений, то получим одно и то же:
        \[\forall \eps > 0: \exists \neighborhood{x_0} : \forall x \in \left(\neighborhood{x_0} \cap A\right) \then |f(x) - c| < \eps\]
    }}
    \note{Функция имеет (конечный (другие пока не определяли)) предел вблизи $x_0$, значит, она ограничена вблизи $x_0$.}
    \indent{
        \definition[Ограниченная функция]{Функция $h: B \map \R$ ограничена (снизу, сверху, без уточнений), если $h(B)$ ограничено (снизу, сверху, без уточнений).\\
            $h$ ограничена сверху: $\exists M : \forall x \in B: h(x) \le M$\\
            $h$ ограничена снизу: $\exists M : \forall x \in B: h(x) \ge M$\\
            $h$ ограничена: $(\exists M, N : \forall x \in B:h \le h(x) \le N) \iff (\exists K : \forall x \in B : |h(x) - K|\le K)$
        }}\prove{
        Пусть $\lim_{x_0} f = c$. Рассмотрим любую окрестность точки $c$, например, радиусом $1: U_1(c)$. Для такой окрестности $c$ существует окрестность $\neighborhood{x_0}$ такая, что $f\left(\neighborhood{x_0}\cap \dom f\right) \subset U_1(c)$. Значит, $f$ ограничена на $\neighborhood{x_0}$.
    }

    \subsection{Арифметические действия с пределами}
    \theorem[Предел суммы]{$f, g: A \map \R, x_0 \in A' \then \lim_{x_0}(f + g) = \lim_{x_0}f + \lim_{x_0}g$. Если правая часть существует, то существует и левая, причём выполняется равенство.

        $(f + g)(x) \bydef f(x) + g(x)$\prove{Пусть $\lim_{x_0}f = a, \lim_{x_0}g = b$.

            $\exists \neighborhood{x_0} : \forall x \in \neighborhood{x_0} \cap A : |f(x) - a| < \frac\eps2 \land |g(x) - b| < \frac\eps2$.

            Тогда $|f(x) + g(x) - (a + b)| \le |f(x) - a| + |g(x) - b| < \eps$.
        }}

    \theorem[Предел произведения числа и функции]{$\alpha \in \R; f: A \map \R, x_0 \in A' \then \lim_{x_0}(\alpha f) = \alpha\lim_{x_0}f$. Если правая часть существует, то существует и левая, причём выполняется равенство.

        $(\alpha f)(x) \bydef (\alpha \cdot f(x))$
        \prove{
            \numbers{
                \item[$\alpha = 0$] --- ясно.
                \item[$\alpha \ne 0$] --- применим определение предела для $f$ с радиусом $\dfrac{\eps}{|\alpha|}$:

                $\exists \neighborhood{x_0} : \forall x \in \neighborhood{x_0} \cap A: |f(x) - c| < \dfrac{\eps}{|\alpha|}$. Тогда для такой же окрестности $|(\alpha f)(x) - \alpha c| < \eps$
            }
        }}

    \newlection{30 сентября 2022 г.}

    $A \subset \R; x_0 \in A'; f : A \map \R$.
    Для $B \subset A$ определено сужение $f\Big|_B$.

    \theorem[Предел сужения]{Если $x_0 \in B'$ и $\exists \lim_{x_0}f$, то $\lim_{x_0}\left(f\Big|_B\right) = \lim_{x_0}f$.}

    Так, для $f : [0; 1] \cup [2; 3] \map \R; \quad x \mapsto \all{x,&x \in [0; 1]\\3,&x \in [2;3]}$, в $x_0$ существует предел в $x_0 = 1$: $\lim_1 f = 1$.
    Он сохраняется при сужении на $[0; 1)$, но не при сужении на $[2; 3]$ --- в таком случае $1$ перестаёт быть предельной точкой.

    \note{При сужении может появиться предел, если его раньше не было. Так, для $f = \chi_{[0; 1]}: \nexists \lim_1 f$, но $\exists \lim_1 f\Big|_{[0; 1]} = 1$. }
    \provehere{Пусть $c = \lim_{x_0}f$. Тогда $\forall U(c): \exists \neighborhood{x_0}: \forall x \in \neighborhood{x_0} \cap A: f(x) \in U(c)$. Тогда для сужения это тоже верно.}

    \theorem[Частичное обращение]{Если $f: A \map \R$, где $B$ имеет вид $A \cap W$ для некой окрестности $W = \neighborhood{x_0}$, и $\exists \lim_{x_0}f\Big|_B$, то $\exists \lim_{x_0}f$. Можно даже сказать точнее: $\lim_{x_0}f = \lim_{x_0}f\Big|_B$.}
    \provehere{
        Запишем условие существования предела для сужения: \[\forall U(c) : \exists \neighborhood{x_0}: ~f\left(\neighborhood{x_0}\cap B\right) = f\left(\neighborhood{x_0} \cap A \cap W\right) \subset U(c)\] Отсюда $f\left(\left(\neighborhood{x_0} \cap W\right) \cap A\right) \subset U(c)$, а $\neighborhood{x_0} \cap W$ --- некая окрестность $x_0$.
    }

    \theorem{Пусть $f, g: A \map \R$, $x_0 \in A'$. Если $\lim_{x_0}f = 0$ и $g$ ограничена вблизи $x_0$, то $\lim_{x_0}(f\cdot g) = 0$. \provehere{
        Можно считать, что $g$ определена только на той окрестности, на которой она ограничена. Тогда $\exists M \in \R : |g(x)| \le M$. Отсюда $0 \le |(f\cdot g)(x)| \le M|f(x)|$. По теореме о двух блюстителях закона $(f \cdot g)$ стремится к $0$ вблизи $x_0$.
    }}

    \theorem[Предел произведения]{$f, g: A \map \R; x_0 \in A'$. Тогда $\lim_{x_0}(f\cdot g) = \lim_{x_0}f \cdot \lim_{x_0}g$. Как и прежде, запись читается так: если существует правая часть, то левая тоже существует и равна ей.\provehere{
        Положим $a = \lim_{x_0}f; b = \lim_{x_0}g$.
        Утверждение теоремы эквивалентно следующему: $\lim_{x_0}|fg - ab| = 0$. Но заметим, что \[f(x)g(x) - ab = (\underbrace{f(x) - a}_{\underset{x \map x_0}{\Map} 0})\underbrace{g(x)}_{\text{ограничена}} + \underbrace{a}_{\text{константа}}(\underbrace{g(x) -b}_{\underset{x\map x_0}{\Map} 0})\] Несложно видеть, что данная сумма стремится к нулю, так как в каждой паре один из множителей ограничен, а другой --- стремится к нулю.
    }}
    В отличие от предела произведения, предел частного может не существовать, равно если частное ограничено $(\frac{|x|}{x})$ или неограничено $(\frac{1}{x})$
    \theorem[Предел частного]{$f, g : A \map \R, x_0 \in A'$. Если $\exists \lim_{x_0}g : \lim_{x_0}g \ne 0$, то формула $h(x) = \frac{f(x)}{g(x)}$ задаёт функцию, определённую вблизи $x_0$ и \[\left(\lim_{x_0}h = \lim_{x_0}\left(\dfrac{f}{g}\right)\right) = \dfrac{\lim_{x_0}f}{\lim_{x_0}g}\]
        Здесь левая часть существует, если существует правая, то есть пределы $\lim_{x_0}f, \lim_{x_0}g$ существуют, и $\lim_{x_0}g \ne 0$. В случае выполнения всех условий левая часть равна правой.}

    \prove{
        Положим $a = \lim_{x_0}f; b = \lim_{x_0}g$.
        \indentlemma{
            Функция $g$ отделена от нуля вблизи $x_0$, то есть $\exists \neighborhood{x_0} :$\\$\forall x \in \neighborhood{x_0} \cap A: \|g(x)\|  \ge \frac{|b|}{2}$.
        }{
            Для $\eps = \frac{|b|}{10}: \exists \neighborhood{x_0} : \forall x \in \neighborhood{x_0}\cap A: |g(x) - b| < \eps$. Тогда для $\forall x \in \neighborhood{x_0}\cap A: |g(x)| \ge \|b\| - \frac{|b|}{10} \ge \frac{|b|}{2}$.
        }

        Докажем, что $\frac{f(x)}{g(x)} - \frac{a}b$ стремится к нулю: \(\dfrac{f(x)}{g(x)} - \dfrac{a}{b} = \dfrac{bf(x) - ag(x)}{b\cdot g(x)} = (\underbrace{bf(x) - ag(x)}_{\underset{x\map x_0}{\Map}ba - ab = 0}) \cdot \underbrace{\dfrac{1}{b\cdot g(x)}}_{\text{ограничена, }|\dots|\le \frac{2}{|b|^2}}\)
    }
    \singlepage{
        Так, рассмотрим $f \equiv c \then \lim_{x_0}f = c$ и $g(x) = x \then \lim_{x_0}g = x_0$.

        \corollary{Пусть $P$ --- многочлен: $P(x) = a_n x^n + \dots + a_1 x + a_0$. Тогда $\forall x_0 \in \R: \lim_{x_0}P = P(x_0)$.}
        \corollary{Пусть $Q$ --- другой многочлен; введём рациональную функцию $U(x) = \frac{P(x)}{Q(x)}$, заданную на множестве $\defset{x \in \R}{Q(x) \ne 0}$. Тогда для $x_0 \in \dom U: \left(\lim_{x_0}U = \lim\limits_{x \map x_0}\frac{P(x)}{Q(x)}\right)= \left(U(x_0) = \dfrac{P(x_0)}{Q(x_0)}\right)$.}
    }
    \definition[Непрерывная функция]{\label{first_continuous_function_deftinition}
    Пусть $f: A \map \R$. Для $x \in A \cap A'$ говорят, что $f$ непрерывна в точке $x_0$, если $\exists \lim_{x_0}f$ и $\lim_{x_0}f = f(x_0)$.
    }

    Видим, что многочлен непрерывен везде на $\R$, а рациональная функция --- везде на своей области определения.
    \ok
    Рассмотрим $h : \N \map \R$.
    Пусть $q \in \R$.
    Определим $h(n) = h_n = q + q + \dots + q^n$.

    Что можно сказать о существовании предела $\lim\limits_{n \map +\infty}h_n$?

    Заметим, что $(1 + \dots + q^n)(1 - q) = 1 - q^{n + 1}$.
    \numbers{
        \item Для $q = 1: h_n = n + 1$ --- функция не ограничена ни в какой окрестности $+\infty$, значит, предела нет.

        Иначе $q \ne 1: h_n = \dfrac{1 - q^n}{1 - q}$.
        \item $q = -1$ и $h_n = \all{1,& 2|n\\0,&2\!\!\not|n}$. Значения чередуются, предела нет.
        \item $|q| > 1$. Предела нет, $\left|h_n\right| \ge \left|\dfrac{1}{1 - q}\right|\cdot \left(|q|^{n} - 1\right)$ неограничена $\left(h_n= \dfrac{1 - q^n}{1 - q}\text{ по-прежнему}\right)$.

        \item $|q| < 1$ и $\lim_{+\infty}h = \lim\limits_{n\map+\infty}\dfrac{1 - q^n}{1 - q} = \dfrac{1}{1 - q}$. В самом деле, $q^n \underset{n \map \infty}{\Map} 0$, что можно получить, например, применяя неравенство Бернулли для $\dfrac{1}{|q|}$.
    }
    \newlection{3 октября 2022 г. }

    \subsection{Теорема Вейерштрасса об ограниченной возрастающей функции}
    \definition[Возрастающая функция $f: B \map \R$]{$\forall x_1, x_2 \in B: x_1 \le x_2 \then f(x_1) \le f(x_2)$.
    Говорят о \textit{строгом возрастании}, если $\forall x_1, x_2 \in B: x_1 < x_2 \then f(x_1) < f(x_2)$.

    Аналогично для (строгого) убывания.}
    Пусть $A \subset \R$.
    \numbers{
        \item $A$ ограничено сверху и $(x_0 = \sup A) \notin A$. Тогда $x_0 \in A'$.
        \item $A$ не ограничено сверху, $x_0 = +\infty$.
    }
    \theorem[Вейерштрасс]{
        Пусть $f : A \map \R$, возрастает, ограничена сверху. Тогда $\exists \lim_{x_0}f$.
        \prove{
            $C \coloneqq f(A)$. $f$ ограничена $\then \exists c = \sup C$. Докажем, что $c = \lim_{x_0}f$.

            Рассмотрим $\forall \eps > 0$. По теореме об описании супремума $\exists d \in C : d > c - \eps; ~\exists y \in A : f(y) = d  > c - \eps$. Тогда для окрестности $\neighborhood[\delta]{x_0} = \defset{u \in A}{y < u < x_0}: \forall u \in \neighborhood[\delta]{x_0} : d = f(y) \le f(u) \le c$. Таким образом, при $\forall \eps > 0: \exists \neighborhood[\delta]{x_0} : c - \eps \le f(u) \le c$ и $c$ --- предел по определению.
        }}
    \theorem[Дополнение предыдущей]{
        Пусть $A \subset \R$; предельная (необязательно конечная) точка $x_0 \in A'$, причём $A \subset (x_0; +\infty)$. Тогда
        \singlepage{
            \bullets{
                \item Если $f$ ограничена снизу и возрастает, то $\exists \lim_{x_0}f = \inf\limits_{x \in A}f(x)$
                \item Если $f$ ограничена сверху и убывает, то $\exists \lim_{x_0}f = \sup\limits_{x \in A}f(x)$
            }
        }
    }
    Для $x_0$, определённого выше, и монотонной ограниченной функции: \note{$\lim_{x_0}f = \all{\sup f(A), &\text{$f$ возрастает}\\ \inf f(A), &\text{$f$ убывает}}$.}
    Для $a > 0$ и $0 < b < 1: f(n) = a + ab + \dots + ab^n \underset{n \map +\infty}{\Map}\frac{a}{1 - b}$.
    Так как $f$ возрастает, то число $\frac{a}{1 - b}$ --- не только $\lim_{+\infty}f$, но и $\sup f: \forall n \in \N: f(n) \le \frac{a}{1 - b}$.
    \ok
    Рассмотрим $g(n) = \left(\sum\limits_{i = 0}^n\frac{1}{i!}\right) = \frac{1}{0!} + \frac{1}{1!} + \dots + \frac{1}{n!}$, где $n! = \left(\all{1,&n = 0\\(n - 1)! \cdot n, &n > 0}\right) = \left(\prod\limits_{i = 1}^{n}i\right) = 1 \cdot 2 \cdot \ldots \cdot  n$.
    \fact{
        $\exists \lim_{+\infty}g(n)$. $e \bydef \lim_{+\infty}g(n)$.
        \prove{
            Достаточно проверить, что $g(\N)$ ограничено сверху.

            Заметим, что $g(n) = 1 + \frac{1}{2!} + \frac{1}{3!}\left(1 + \frac{1}{4} + \frac{1}{4 \cdot 5} + \dots + \frac{1}{4 \cdot 5 \cdot\ldots\cdot n}\right)$ для $n \ge 3$. Отсюда \[g(n) \le 1 + \frac{1}{2!} + \frac{1}{3!}\left(1 + \frac{1}{4} + \frac{1}{4^2} + \dots\right) \le 1 + \frac{1}{2!} + \frac{1}{3!}\left(\dfrac{1}{1 - \frac{1}{4}}\right) = 2\frac{1}{2} + \frac{1}{6}\cdot\frac{4}{3} = 2\frac{13}{18}\]

            Отсюда ($g$ возрастает) видно, что $\lim_{+\infty}g(n)$ существует, и $\lim_{+\infty}g(n) < 3$.
            Несложно вычислить первые несколько десятичных знаков числа $e = 2,71828\dots$.
        }
    }
    \theorem{Число $e$ иррационально
    \prove{
        Пусть $e = \frac{p}{q}$ для некоторых $p, q \in \N$.
        Оценками на $e$ получаем, что $q \ge 2$.
        Рассмотрим число
        \[q!e = q!\left(1 + \dots + \frac{1}{q!}\right) + \lim\limits_{n \map \infty}\left(\frac{1}{q + 1}+\frac{1}{(q + 1)(q + 2)}+\dots + \frac{1}{(q + 1)(q + 2)\cdot \ldots \cdot n}\right)\]
        Однако $\left(\frac{1}{q + 1}+\frac{1}{(q + 1)(q + 2)}+\dots + \frac{1}{(q + 1)(q + 2)\proddots n}\right) \le \left(\frac{1}{q+1} + \dots + \frac{1}{(q+1)^{n-q}}\right) < \left(\frac{1}{3} +\frac{1}{3^2}+\dots\right) \le \frac{1}{2}$, откуда $q!e$ никак не может быть целым.
        Противоречие.
    }
    }

    \subsection{Гармонические ряды}
    Пусть $a > 0$.
    Когда $h(n) = 1 + \frac{1}{2^a} + \dots + \frac{1}{n^a}$ ограничена сверху?
    При каких $a: \exists \lim_{+\infty}h$?

    \note{Понятие степени $n^a$ будет определено позже, предполагается, что все с ним знакомы.}
    \theorem{
        Пусть $b_1 \ge b_2 \ge \cdots$ --- убывающая последовательность неотрицательных чисел.
        Следующие условия эквивалентны:
        \numbers{
            \item $\sum\limits_{j = 1}^{n} b_j$ ограничена сверху.
            \item $\sum\limits_{k = 1}^{n}2^k b_{2^k}$ ограничена сверху.
        }
    }
    \provebullets{
        \item[$(1) \then (2)$.] Рассмотрим $\forall n \in \N$. $\exists!~ l\in \N : 2^l \le n < 2^{l+1}$.
        \[\sum\limits_{j = 1}^n b_j \le b_1 + (b_2 + b_3) + (b_4 + \dots + b_7) + \dots + \left(b_{2^l} + \dots + b_{2^{l+1} - 1}\right)\le b_1 + \sum\limits_{k = 1}^{l}2^k b_{2^k}\]
        \item[$(2) \then (1)$.] Рассмотрим $\forall l \in \N$.
        \[\sum\limits_{k = 1}^l 2^k b_{2^k} = 2\left(b_2 + (b_4 + b_4) + \dots + (\underbrace{b_{2^l} + \dots + b_{2^l}}_{2^{l-1}})\right)\le 2\Big(b_1 + (b_2 + b_3) + \cdots\Big) \le 2\sum\limits_{j = 1}^{2^l}b_j\]

        Из этих двух неравенств несложно видеть, что неограниченность одной последовательности непременно влечёт неограниченность другой.
    }
    \corollary{Пусть $b_j = \frac{1}{j^a}$. Тогда $2^j b_{2^j} = 2^j\dfrac{1}{2^{ja}} = \left(2^{1 - a}\right)^j$.
    Но сумма $\sum\limits_{j = 1}^n\left(2^{1 - a}\right)^j$ ограничена если и только если $2^{1 - a} < 1$. Частный случай равенства единице: $a = 1:~1 + \frac{1}{2} + \cdots + \frac{1}{n}$ не ограничена.}

    \corollary{Для $a = 2: \exists \lim\limits_{n \map \infty}\left(1 + \frac{1}{2^2} + \dots + \frac{1}{n^2}\right)$.

    Эйлер показал, что $\lim\limits_{n \map \infty}\left(1 + \frac{1}{2^2} + \dots + \frac{1}{n^2}\right) = \frac{\pi^2}{6}$.
    }
    \corollary{$\exists \lim\limits_{n \map +\infty}\sum\limits_{k=1}^n\dfrac{1}{k(\log k)^\alpha} \iff \exists \lim\limits_{n \map \infty} \sum\limits_{j = 1}^{n}2^j\dfrac{1}{2^j(\log 2^j)^\alpha} = \lim\limits_{n \map \infty} \sum\limits_{j = 1}^n\dfrac{1}{j^\alpha} \iff \alpha > 1$}
    \newlection{7 октября 2022 г.}

    \subsection{Предел последовательности}
    Последовательность $\{a_n\}_{n \in \N}$ или $\{a(n)\}_{n \in \N}$. $\exists! x_0 \in \N' = \{+\infty\}$.

    Определение: $c = \lim\limits_{n \map +\infty}a_n \iff \forall \eps > 0: \exists N: \forall n \in \N: (n > N\then |a_n - c| <\eps)$.
    Очевидно, что можно считать, что $N \in \N$.
    \theorem{Последовательность $a_n$ сходится к $c$ $\iff$ $\forall \eps > 0 : \bigdefset{n \in \N}{|a_n - c| > \eps}$ конечно.\provetwhen{Если последовательность сходится, то обратное неравенство выполняется начиная с некоторого места, тогда $|a_n - c| > \eps$ может выполняться только в некоторых точках до данного места; этих точек конечное количество.}{Если $\bigdefset{n \in \N}{|a_n - c| > \frac\eps2}$ конечно, то в нём существует максимальный элемент $N$. Тогда $\forall n > N : |a_n - c| \le \frac\eps2 < \eps$.}}
    \definition[Перестановка множества $\N$]{Биекция $\phi : \N \map \N$.}
    \definition[Перестановка последовательности $\{a_n\}_{n \in \N}$]{ Любая последовательность вида $\{a_{\phi(n)}\}_{n \in \N}$, где $\phi$ --- перестановка $\N$.}
    \corollary{Если последовательность $a_n \underset{n \map +\infty}{\Map} c$, то любая перестановка $a_{\phi(n)} \underset{n \map +\infty}{\Map} c$. Верно и обратное --- если какая-то перестановка имеет предел, то такой же имеет и исходная последовательность (рассмотреть обратную перестановку).}
    \definition[Подпоследовательность $\{a_n\}_{n \in \N}$]{Любая последовательность вида $a_{k_n}$, где последовательность натуральных чисел $\{k_n\}_{n \in \N}$ возрастает: $k_1 < k_2 < \cdots$.}
    \theorem{Если последовательность $\{a_n\}_{n \in \N}$ сходится к $c$, то любая подпоследовательность $\{a_{k_n}\}_{n \in \N}$ тоже сходится к $c$.\provehere{Верно по теореме о сужении функций.}}
    \theorem[О компактности (вторая форма)]{\label{segment_compactivity_2}
    Первая форма приведена здесь:~\ref{segment_compactivity_1}.

    Любая ограниченная последовательность имеет сходящуюся подпоследовательность.}
    \provehere{
        Рассмотрим $E = \defset{a_n}{n\in\N}$.
        \bullets{
            \item $E$ конечно.

            Утверждается, что существует подпоследовательность $\{a_{b_n}\}$, у которой все значения одинаковы: $a_{b_n} = a_{b_m}$. Ну, в самом деле: от противного, если каждое значение из $E$ последовательность принимает конечное количество раз, то её прообраз оказывается конечным.
            \item $E$ бесконечно.

            Согласно первой форме теоремы о компактности $\exists c \in \R$, являющаяся предельной для $E: \forall \eps > 0 : \exists x \in E : 0 < |x - c| < \eps$.

            Найдём последовательность $k_n$ так, чтобы $\{a_{k_n}\}$ сходилась к $c$ по индукции. А именно, найдём такую последовательность индексов $\{k_n\}_{n \in \N}$, чтобы выполнялось $|a_{k_n} - c| < \frac{1}{n}$. По определению предельной точки в любой окрестности $c$ есть точка. Тогда возьмём такую окрестность, чтобы её радиус был меньше $\frac{1}{n}$, да ещё и все ранее выбранные точки не попадали в неё. Так можно будет выбрать точку $a_{k_n}$ для любого $n$.

            После данного действа у нас есть $\{a_{k_n}\}$, которая сходится к $c$ ($k_n$ --- какая-то последовательность индексов). Заметим, что та перестановка, в которой $\{k_n\}$ возрастает, тогда тоже сходится к $c$, но она уже является подпоследовательностью $\{a_n\}$. \qedhere
        }}
    \theorem{Сходящаяся последовательность $\{a_n\}_{n \in \N}$ ограничена}
    \provehere{
        По теореме для функций, имеющих предел, $\exists \V{+\infty}$ такая, что $a\left(\V{+\infty}\right)$ ограничена. В нашем случае $\V{+\infty} = (N; +\infty)$ для некоего $n \in \N$. Но множество $\{a_1, \dots, a_N\}$ конечно, поэтому тоже ограничено.
    }
    \theorem[Предельные точки в терминах последовательностей]{$A \subset \R; x_0 \in \R$.
    Следующие условия эквивалентны: \[\left(x_0 \in A'\right) \iff \left(\exists \{x_n\}_{n \in \N} \subset \left(A\bs\{x_0\}\right): x_n \underset{n \map +\infty}{\Map} x_0\right)\]
    }
    \provetwhen{
        $\forall n : \exists x_n \in \V[\frac{1}{n}]{x_0} \iff \exists x_n : |x_n - x_0| < \frac{1}{n}$. Тогда по теореме о двух полицейских $x_n \underset{n \map +\infty}{\Map} x_0$.
    }{Рассмотрим окрестность $\V{x_0}$. Тогда $\exists N : \forall n > N : x_n \in \V{x_0}$.
    }
    \proposal{$A \subset \R$; $x_0 \in \left(\overline{A} \bydef A \cup A'\right) \iff \exists \{x_n\} \subset A : x_n \underset{n \map +\infty}\Map x_0$.}\provetwhen{
        Если $x_0 \in \overline{A}$, то либо $x_0 \in A$ --- тогда рассмотрим последовательность $\N \map \{x_0\}$, либо $x_0 \in A'$ --- тогда см. предыдущую теорему.
    }{
        Рассмотрим данную последовательность. Если её предел $x_0 = x_n$ для некоего $n$, то $x_0 \in A$. Иначе $\forall n \in \N : x_0 \ne x_n$, тогда $x_0 \in A'$.
    }
    \proposal[Бесконечная предельная точка $(x_0 = \pm \infty)$]{$+\infty~(-\infty)$ --- предельная точка для $A \iff \forall n \in \N : \exists x_n \in A : x_n > n~(x_n < -n)$.}
    \theorem[Предел функции в терминах последовательностей]{
        $f : A \map \R, x_0 \in A'$ и $x_0 \in \R$.
        Следующие условия эквивалентны:
        \[\left(\exists \lim_{x_0}f = c\right) \iff \left(\forall \{x_n\}_{n \in \N} \subset A \bs \{x_0\} : (x_n \underset{n \map +\infty}{\Map} x_0 \then \lim\limits_{n \map +\infty}f(x_n) = c)\right)\]
        \provetwhen{
            Дано: $\forall \eps > 0 : \exists \delta > 0 : \forall x \in A: (0 < |x - x_0| < \delta \then |f(x) - c| < \eps)$.
            Пусть $\{x_n\} \subset A \bs \{x_0\}; x_n \underset{n \map +\infty}{\Map} x_0$. Тогда $\exists N: \forall n > N : |x_n - x_0| < \delta \then |f(x_n) - c| < \eps$.
        }{Дано: $\forall \{x_n\} : (x_n \underset{n \map +\infty}{\Map} x_0 \then \forall \eps>0: \exists N : (n > N \then |f(x_n)  - c| < \eps))$.

        \newlection{10 октября 2022 г.}
        Пойдём от противного: пусть $c$ не есть предел функции $f$ в точке $x_0$. То есть \[\exists \eps > 0: \forall \delta > 0: \exists x \in \left(\V[\delta]{x_0} \cap A\right): |f(x) - c| \ge \eps\]
            Зафиксируем $\eps > 0$; возьмём последовательность $\delta_n = \frac{1}{n}$.
            Тогда \[\forall \delta_n : \exists x_n \in A : 0 < |x - x_0| < \delta_n \land |f(x_n) - c| \ge \eps\]Противоречие, мы построили последовательность.
        }
    }
    \ok

    \definition[Колебание функции на множестве]{
        Рассмотрим $g: B \map \R$, где $B \subset \R$. Для $b \subset B$, такой что $g$ ограничена на $b$, колебания $\osc_b g \bydef \sup\defset{|f(x) - f(y)|}{x, y \in b}$.

        Определение корректно, так как из ограниченности функции $\exists M \in \R : \forall x \in b : |f(x)| < M$, откуда $\defset{|f(x) - f(y)|}{x, y \in b}$ ограничено сверху числом $2M$, а значит, имеет супремум.
    }

    \lemma{
        \begin{gather*}
            \osc_b g = \sup\defset{g(x) - g(y)}{x, y \in b} = \sup_{x \in b}g(x) - \inf_{x \in b}g(x)
        \end{gather*}
        \provebullets[Доказательство леммы]{
            \item $X = \defset{|g(x) - g(y)|}{x, y \in b}$; $Y = \defset{g(x) - g(y)}{x, y \in b}$.
            Тогда понятно, что ${X = \defset{y}{y \in Y} \cup \defset{-y}{y \in Y}}$, откуда $\sup X = \sup Y$.
            \indent{Для произвольного ограниченного значением $M$ отображения ${f : V \times W \map \R}$ верно следующее:
                \[\text{Пусть }X \coloneqq \sup_{(v, w) \in V \times W}f(v,w).\text{ Выполняется }X = \sup_{v\in V}\sup_{w\in W}f(v, w)\]
                В самом деле, с одной стороны $\forall (v, w) \in \left(V \times W\right): X \ge f(v, w) \then X \ge \sup\limits_{w\in W}f(v,w) \then X \ge \sup\limits_{v\in V}\sup\limits_{w\in W}f(v,w)$.

                С другой стороны, $\forall \rho > 0 : \exists (v, w) \in \left(V \times W\right) : f(v, w) > X - \rho$.
                Тогда $\sup\limits_{v \in V}\sup\limits_{w \in W}f(v, w) \ge X - \rho$.

                Из этих двух неравенств получаем равенство.
            }
            \item $\sup\limits_{x, y \in b}(g(x) - g(y)) = \sup\limits_{x \in b}\sup\limits_{y \in b}(g(x) - g(y)) = \sup\limits_{x \in b}g(x) + \sup\limits_{y \in b}(-g(y)) = \sup\limits_{x \in b}g(x) - \inf\limits_{y \in b}g(y)$

            Здесь пользовались тем, что $\sup\limits_{x \in X}(f(x) + c) = (\sup\limits_{x \in X}f(x)) + c$ и $\sup\limits_{x \in X}f(x) = -\inf\limits_{x \in X}(-f(x))$.
        }
    }
    \theorem[Критерий Коши существования предела]{
        Для $f : A \map \R$ и произвольной $x_0 \in A'$:
        \numbers{
            \item $f$ имеет предел в $x_0$.
            \item $\forall \eps > 0: \exists \V{x_0}: \forall x, y \in \V{x_0} : |f(x) - f(y)| < \eps$.
        }
        \provetwhen{$\forall \eps > 0: \exists \V{x_0} : \forall z \in \V{x_0} : |f(z) - c| < \frac\eps2$
            Но тогда $\forall x, y \in \V{x_0} : |f(x) - c| < \frac\eps2 \land |f(y) - c| < \frac\eps2$, откуда $|f(x) - f(y)| \le |f(x) - c| + |f(y) - c| < \frac\eps2 + \frac\eps2 = \eps$.
        }{

            Дано: $\forall \eps > 0: \exists \V{x_0} : \osc_{\left(\V{x_0}\cap A\right)}f \le \eps$.
            Функция $f$ ограничена вблизи $x_0$: применим условие для $\eps = 1$, найдём $\V{x_0}: \forall x, y \in \left(\V{x_0} \cap A\right): |f(x) - f(y)| < 1$. Тогда для фиксированного $y \in \left(\V{x_0} \cap A\right): \forall x \in \left(\V{x_0} \cap A\right): |f(x) - f(y)| < 1 \iff f(x) \in [f(y) - 1; f(y) + 1]$. Тогда рассмотрим сужение $f$ на окрестность, в которой она ограничена и докажем существование предела у сужения.

            Рассмотрим $v$ --- совокупность всех окрестностей точки $x_0$. Пусть $\V{x_0} \in v$. Обозначим \[l\left(\V{x_0}\right) = \inf\limits_{x\in \left(\V{x_0}\cap A\right)}f(x); \qquad h\left(\V{x_0}\right) = \sup\limits_{x\in \left(\V{x_0}\cap A\right)}f(x)\]

            Пусть $\U{x_0} \subset \V{x_0}, \U{x_0}, \V{x_0} \in v$. Тогда верно следующее:
            \[l\left(\V{x_0}\right) \le l\left(\U{x_0}\right) \le h\left(\U{x_0}\right) \le h\left(\V{x_0}\right)\]

            Введём $L = \defset{l\left(\overset{o}{w}\right)}{\overset{o}{w} \in v}$ и $H = \defset{h\left(\overset{o}{w}\right)}{\overset{o}{w} \in v}$. Эти два множества образуют щель. Более того, щель --- узкая, так как $\forall \eps > 0: \exists \V{x_0} : \sup\limits_{x \in A \cap \V{x_0}}f(x) - \inf\limits_{y \in A \cap \V{x_0}}f(y) \le \eps$. Значит, $\exists! c \in (L; H)$.

            Докажем, что $c = \lim_{x_0}f$. Рассмотрим произвольный $\eps > 0$, найдём $\V{x_0}$ так, чтобы $h\left(\V{x_0}\right) - l\left(\V{x_0}\right) < \eps$. Но так как $\forall x \in \V{x_0}: c, f(x) \in \left[l\left(\V{x_0}\right), h\left(\V{x_0}\right)\right]$, то получили, что $|f(x) - c| < \eps$
        }
    }
    \fact{Теорема эквивалентна аксиоме Кантора-Дедекинда}


    \section{Ряды}
    Рассмотрим последовательность $\{a_n\}_{n\in\N} \subset \R$.
    Обозначим ряд символом $\sum\limits_{n = 1}^{+\infty}a_n$.

    \definition[Частичная сумма]{$S_n \bydef a_1 + \dots + a_n = \sum\limits_{i = 1}^n a_i$.}
    \definition[Сходящийся ряд]{Ряд, последовательность частичных сумм которого сходится. Иначе ряд расходится.

    У сходящегося ряда $S = \lim_n S_n$ называется суммой ряда. }

    \subsection{Примеры}
    \bullets{
        \item Геометрическая прогрессия $\sum\limits_{n = 0}^{+\infty}q^n$. При $|q| < 1$ сходится к $\frac{1}{1 - q}$; при $|q| \ge 1$ расходится.
        \item Гармонические ряды $\sum\limits_{n = 1}^{+\infty}\frac{1}{n^a}$. Сходится $\iff a > 1$.
        \item $e = \sum\limits_{n = 0}^{+\infty}\frac{1}{n!}$ --- сходится к числу $e$.
    }
    Пусть $\{a_n\}_{n\in\N}$ --- последовательность.
    Введём последовательность $d_n = \all{a_n,&n =1\\a_n - a_{n-1},&n>1}$.
    Рассмотрим ряд $\sum\limits_{k = 1}^{+\infty}d_k$.
    Несложно видеть, что его частичные суммы совпадают с последовательностью $\{a_k\}$.
    В частности, ряд $\sum\limits_{k = 1}^{+\infty}d_k$ сходится $\iff$ последовательность $a_n$ имеет предел, причём если это верно, то $\sum\limits_{k = 1}^{+\infty}d_k = \lim_{+\infty}a_n$.
    \newlection{14 октября 2022 г.}

    \subsection{Критерий Коши для рядов}
    Рассмотрим ряд $\sum\limits_{m=1}^\infty a_m$.
    Его сходимость равносильна сходимости последовательности частичных сумм $\{s_k\}$.
    Применяя критерий Коши, получаем: \[\forall \eps > 0: \exists N : \forall k, n > N: |s_k - s_n| < \eps\]
    Считая $n > k$, получаем $\forall \eps > 0: \exists N: \forall k > n > N: |a_{n+1} + \dots + a_k| < \eps$.
    \corollary{Если ряд $\sum\limits_{m = 1}^\infty a_m$ сходится, то $a_m \underset{m \to \infty}{\Map} 0$.
    \provehere{Рассмотреть $k = n + 1$ выше.
    Другой способ --- написать $a_m = s_m - s_{m-1}$, но при стремлении $m$ к бесконечности $s_{m} - s_{m-1} \underset{m \to \infty}\Map s - s = 0$, где $s$ --- предел последовательности частичных сумм.}}
    \note{Ряд $\sum\limits_{n=1}^\infty \frac{1}{n}$ расходится, хотя и выполняется условие $\frac{1}{n} \underset{n\to\infty}{\Map} 0$.}
    \theorem[О сравнении рядов]{Если ряды $\sum\limits_{n=1}^\infty a_n$ и $\sum\limits_{n=1}^\infty b_n$ таковы, что $|a_n| \le b_n$, то из сходимости $b_n$ следует сходимость $a_n$.\provehere{
        Запишем критерий Коши для ряда $b$: ${\forall \eps > 0: \exists N: \forall k > n > N: b_{n+1}+\dots+b_k < \eps}$. Но тогда $|a_{n+1} + \dots + a_k| \le |a_{n+1}| + \dots + |a_k| \le b_{n+1}+\dots+b_k < \eps$ и ряд $a_n$ сходится по критерию Коши.}}
    \ok
    Как известно, $e \bydef \sum\limits_{n=0}^\infty \frac{1}{n!}$.
    Рассмотрим ряд $\sum\limits_{n=1}^\infty \frac{d_n}{n!}$ для ограниченной последовательности $\{d_n\} \subset \R$.
    Пусть последовательность ограничена числом $M$.
    Тогда $\left|\frac{d_n}{n!}\right|\le M\cdot\frac{1}{n!}$, и по теореме о сравнении рядов ряд $\sum\limits_{n=1}^\infty\frac{d_n}{n!}$ сходится.
    \definition[Абсолютная сходимость]{Ряд $\sum\limits_{n=1}^\infty a_n$ сходится абсолютно, если ряд $\sum\limits_{n=1}^\infty|a_n|$ сходится.}
    \note{По теореме о сравнении рядов, из абсолютной сходимости следует сходимость. \provehere{Рассмотреть $b_n = |a_n|$ в теореме о сходимости.}}
    \note{Обратное в общем случае неверно: так, ряд $\sum\limits_{n=1}^\infty\frac{(-1)^n}{n}$ сходится, но не абсолютно.}

    Чтобы проверить это утверждение, применим преобразование Абеля.

    \subsection{Преобразование Абеля}
    Рассмотрим ряд $\sum\limits_{n = 1}^\infty \beta_i a_i$, где $a_i \ge a_{i + 1} \ge 0$.
    Обозначим $\sigma_n \coloneqq \sum\limits_{i = 1}^n\beta_i$.
    Тогда если $\{\sigma_i\}$ ограничена, то ряд сходится.
    \prove{
        $ \beta_1 a_1 + \beta_2 a_2 + \beta_3 a_3 + \dots + \beta_n a_n = \sigma_1 a_1 + (\sigma_2-\sigma_1)a_2 + (\sigma_3-\sigma_2)a_3 + \dots + (\sigma_n-\sigma_{n-1})a_n$.

        Перегруппируем слагаемые, чтобы за скобками стояли не $a_i$, а $\sigma_i$:

        $\sigma_1(a_1 - a_2) + \sigma_2(a_2 - a_3) + \dots + \sigma_n a_n$.

        Применив ограниченность последовательности $\{\sigma_i\}$, получим $|\sigma_j(a_j-a_{j+1})|\le |\sigma_j|(a_j-a_{j+1})\le M(a_j-a_{j+1})$. Но тогда по теореме о сравнении ряд сходится, так как сходится ряд \[t_k = \sum\limits_{j=1}^\infty M(a_j-a_{j+1})\] В самом деле, $M(a_1 - a_2) + M(a_2 - a_3) + \dots + M(a_n - a_{n+1}) = M(a_1 - a_n)$, то есть сумма ряда не больше $Ma_1$.
        \note{Здесь у меня небольшой обман, надо ещё сказать, что $\sigma_n a_n \underset{n \to \infty}\Map 0$ или (что то же самое, так как $\{\sigma_i\}$ ограничена) $a_n \underset{n \to \infty}\Map 0$. Иначе остаётся слагаемое $\sigma_n a_n$, вносящее существенный вклад.\qedhere}
    }
    \ok
    Применив преобразование Абеля к ряду $\sum\limits_{n=1}^\infty \frac{(-1)^n}{n}$ для $\beta_i = (-1)^n$ и $a_n = \frac{1}{n}$ действительно получим его сходимость.
    То, что он не сходится абсолютно, следует из того, что ряд $\sum\limits_{n=1}^\infty \frac{1}{n}$ расходится.
    \note{Через преобразование Абеля можно доказать сходимость ряда $\sum\limits_{n=1}^\infty \frac{\sin(nt)}n$.}
    \note{Рассмотрим ряд $\sum\limits_{n = 1}^\infty a_n$; пусть $a_n \ge 0$. Ряд сходится $\iff$ частичные суммы ограничены сверху.\provehere{Частичные суммы нестрого возрастают и ограничены.}
    В связи с этим, если для $a_n \ge 0$ ряд $\sum\limits_{n = 0}^\infty$ сходится, то часто записывают $\sum\limits_{n = 0}^\infty a_n < \infty$.}


    \section{Верхние и нижние пределы}
    Рассмотрим функцию $f: A \map \R$, $x_0 \in A'$.

    Считаем, что функция $f$ ограничена (достаточно считать вблизи $x_0$, после чего сузить область определения).
    Рассмотрим некую окрестность $\U{x_0}$.
    Пусть $U = {\U{x_0}} \cap A$.
    Тогда $\osc_U f = \sup\limits_{x \in U}f(x) - \inf\limits_{y \in U}f(y)$.
    Обозначим $h\left(\U{x_0}\right) = \sup\limits_{x \in U}f(x); l\left(\U{x_0}\right) = \inf\limits_{x \in U}f(x)$.
    Кроме того, $v$ --- множество окрестностей точки $x_0$.

    Тогда множества $L = \defset{l\left(\overset{o}{w}\right)}{\overset{o}{\omega} \in v}$ и $H = \defset{h\left(\overset{o}{w}\right)}{\overset{o}{\omega} \in v}$ образуют щель, причём числа в этой щели --- отрезок $\left[\sup L; \inf H\right]$.
    \definition[Верхний предел]{Число $\inf H$ называется верхним пределом функции $f$ в точке $x_0$. Обозначают $\varlimsup\limits_{x \map x_0}f(x)$ или $\limsup\limits_{x \map x_0}f(x)$.}
    \definition[Нижний предел]{Число $\sup L$ называется нижним пределом функции $f$ в точке $x_0$. Обозначают $\varliminf\limits_{x \to x_0}f(x)$ или $\liminf\limits_{x \map x_0}f(x)$.}

    \subsection{Свойства}
    \numbers{
        \item $\varlimsup\limits_{x \to x_0}f(x) = -\varliminf\limits_{x \to x_0}(-f(x))$.
        \item \up \theorem[Об описании верхнего предела]{Следующие условия эквивалентны:
        \bullets{
            \item[a)] $d = \varlimsup\limits_{x \to x_0}f(x)$
            \item[b)] $\all{\forall \eps > 0: \exists \U[\delta]{x_0}: \forall x \in \U[\delta]{x_0} \cap A: f(x) < d + \eps\\
            \forall \eps > 0, \forall \,\U[\delta]{x_0} : \exists \, x \in \U[\delta]{x_0}\cap A : f(x) > d - \eps}$
        }
        \provetwhen{
            $d = \inf\limits_{\U{x_0}\in v}h\left(\U{x_0}\right)$.
            Тогда по свойству инфимума $\forall \eps > 0: \exists \V[\delta]{x_0}: h\left(\V[\delta]{x_0}\right) < d + \eps$, то есть $\sup\limits_{x \in \V[\delta]{x_0} \cap A}h(x)< d + \eps$, откуда следует первое условие в конъюнкции.

            А ещё $\forall \eps > 0, \forall \V[\delta]{x_0}: d \le h\left(\V[\delta]{x_0}\right) = \sup\limits_{x \in \V[\delta]{x_0} \cap A}f(x) \then \exists y \in \V[\delta]{x_0} : f(y) > h\left(\V[\delta]{x_0}\right) - \eps \ge d - \eps$.
        }{
            Лекция здесь внезапно кончилась.
            \newlection{17 октября 2022 г.}
            Рассмотрим произвольный $\eps > 0$. Согласно первому условию из (b), для него есть окрестность $\U[\delta]{x_0}: \forall x \in \U[\delta]{x_0} : f(x) \le d + \eps$, то есть $h\left(\U[\delta]{x_0}\right) \le d + \eps$. Но тогда $\varlimsup_{x_0}f = \inf\limits_{\overset{o}{w}}h\left(\overset{o}{w}\right) \le d + \eps ~\then~ \varlimsup_{x_0} \le d$.

            Рассмотрим произвольный $\eps > 0$. Согласно второму условию из (b), для любой его окрестности $\V[\delta]{x_0}: \exists x \in \V[\delta]{x_0}: f(x) > d - \eps$, то есть $h\left(\V[\delta]{x_0}\right) \ge d - \eps$. Но тогда $\varlimsup_{x_0}f = \inf\limits_{\overset{o}{w}}h\left(\overset{o}{w}\right) \ge d - \eps$, откуда $\varlimsup_{x_0}f \ge d$.
        }}
        \item Аналогичная теорема верна для нижнего предела:
        \theorem[Об описании нижнего предела]{Следующие условия эквивалентны:
        \bullets{
            \item[a)] $d = \varliminf\limits_{x \to x_0}f(x)$
            \item[b)] $\all{\forall \eps > 0: \exists \U[\delta]{x_0}: \forall x \in \U[\delta]{x_0} \cap A: f(x) > d - \eps\\
            \forall \eps > 0, \forall \,\U[\delta]{x_0} : \exists \, x \in \U[\delta]{x_0}\cap A : f(x) < d + \eps}$
        }}
        \provehere{Домножить $f$ на $-1$ и применить $\varlimsup\limits_{x\to x_0}f(x) = -\varliminf\limits_{x \to x_0}(-f)(x)$.}
        Здесь интересно рассмотреть в качестве примеров функции $\sin\left(\frac{1}{x}\right)$ или даже $\sin\left(\frac{1}{x}\right) + x$ вблизи нуля.
        \item \up \theorem{
            Пусть $f: A \map \R$; $x_0 \in A'$. Тогда следующие условия эквивалентны:
            \numbers{
                \item $\exists \lim_{x_0}f = d$.
                \item $\varlimsup\limits_{x \map x_0}f(x) = \varliminf\limits_{x \map x_0}f(x) = d$.
            }}\provetwhen{
            $\forall \eps > 0: \exists \U[\delta]{x_0}: \forall x \in \U[\delta]{x_0} \cap A: f(x) \in (c - \eps; c + \eps)$.

            Тогда $h\left(\U[\delta]{x_0}\right) \le d + \eps$ и $l\left(\U[\delta]{x_0}\right) \ge d - \eps$, а навесив супремумы и инфимумы: $\varlimsup\limits_{x \to x_0}f(x) = \inf\limits_{\overset{o}{w}}h\left(\overset{o}{w}\right) \le d + \eps$ и $\varliminf\limits_{x \to x_0}f(x) = \sup\limits_{\overset{o}{w}}h\left(\overset{o}{w}\right) \ge d - \eps$. Так как $\varlimsup\limits_{x \to x_0}f(x) \ge \varliminf\limits_{x \to x_0}f(x)$, то они оба равны $d$.
        }{
            По теореме об описании верхнего предела $\forall \eps > 0: \exists \U[\delta_1]{x_0}: \forall x \in A \cap \U[\delta_1]{x_0}: f(x) < d + \eps$. С другой стороны, по теореме об описании нижнего предела $\forall \eps > 0: \exists \V[\delta_2]{x_0}: \forall x \in A \cap \V[\delta_2]{x_0}: f(x) > d - \eps$. Но тогда $\forall \eps > 0: \exists \V[\min(\delta_1, \delta_2)]{x_0} : \forall x \in \V[\min(\delta_1, \delta_2)]{x_0}: f(x) \in (d - \eps; d + \eps)$.
        }
        \item $\varlimsup\limits_{x \to x_0}(af)(x) = \all{a \cdot \varlimsup\limits_{x \to x_0}f(x),& a > 0\\0,&a = 0\\a \cdot \varliminf\limits_{x \to x_0}f(x),&a < 0}$.

        Так, для верхнего предела $\varlimsup\limits_{x \to x_0}(af)(x) = \inf\limits_{\overset{o}{w}}\sup\limits_{x \in \overset{o}{w} \cap A}(af)(x) = \inf\limits_{\overset{o}{w}}a\sup\limits_{x \in \overset{o}{w} \cap A}f(x) = a\inf\limits_{\overset{o}{w}}\sup\limits_{x \in \overset{o}{w} \cap A}f(x)$.
        \item \up \theorem{Пусть $f, g: A \map \R$ --- две ограниченные функции на $A \subset \R$, $x_0 \in A'$.
        Тогда \[\varlimsup\limits_{x \to x_0}(f(x) + g(x)) \le \varlimsup\limits_{x \to x_0}f(x) +  \varlimsup\limits_{x \to x_0}g(x)\]
            \provehere{
                Обозначим $F = \varlimsup\limits_{x \to x_0}f(x)$ и $G = \varlimsup\limits_{x \to x_0}g(x)$.

                Для $\forall \eps > 0: \exists \U[\delta]{x_0}$ --- минимальная из подходящих для $f$ и $g$ окрестностей: $\forall x \in \U[\delta]{x_0} : f(x) < F + \eps \land g(x) < G + \eps$.
                Тогда $\forall x \in \U[\delta]{x_0}: f(x) + g(x) < F + G + 2\eps$, то есть $h\left(\U[\delta]{x_0}\right) = \sup\limits_{x \in \U[\delta]{x_0} \cap A}(f(x) + g(x)) \le F + G + 2\eps$, откуда $\varlimsup\limits_{x \to x_0}(f + g)(x) = \inf\limits_{\w}\sup\left(\w\right) \le F + G + 2\eps$.
            }}
        В теореме не наблюдается равенства, так как, например, для $f(x) = \sin\left(\frac1x\right)$ и для $g(x) = \sin\left(-\frac1x\right)$ их сумма имеет верхний предел вовсе не 2.
        \item Вариант для нижних пределов: \[\varliminf\limits_{x \to x_0}(f(x) + g(x)) \ge \varliminf\limits_{x \to x_0}f(x) +  \varliminf\limits_{x \to x_0}g(x)\]
        \item \up \corollary{Если $\exists \lim_{x_0}g$, то $\varlimsup\limits_{x \to x_0}(f + g)(x) = \varlimsup\limits_{x \to x_0}f(x) + \lim_{x_0}g$.\provehere{
            С одной стороны $\varlimsup\limits_{x \to x_0}(f + g)(x) \le \varlimsup\limits_{x \to x_0}f(x) + \lim_{x_0}g$, но с другой стороны $\varlimsup\limits_{x \to x_0}f(x) = \varlimsup\limits_{x \to x_0}(f+g-g)(x) \le \varlimsup\limits_{x \to x_0}(f+g)(x)-\lim_{x_0}g$}}
        \item Формулы для верхних и нижних пределов.
        \bullets{
            \item[I.] $x_0 \in A' \cap \R$.

            $\forall \eps > 0: \exists \U[\delta]{x_0} = (x_0 - \delta; x_0 + \delta) \bs \{x_0\}$ введём обозначения
            \singlepage{
                \[h'(\delta) = h\left(\U[\delta]{x_0}\right)=  \sup\defset{f(x)}{0 < |x - x_0| < \delta \land x \in A}\]
                \[l'(\delta) = l\left(\U[\delta]{x_0}\right)=  \inf\defset{f(x)}{0 < |x - x_0| < \delta \land x \in A}\]
            }

            Тогда на $l', h' : \R^+ \map \R$ можно посмотреть, как на функции. Заметим, что $h'(\delta)$ нестрого возрастает, а $l'(\delta)$ нестрого убывает --- просто потому что для $\delta_1 < \delta_2$ множества вложены $\defset{f(x)}{0 < |x - x_0| < \delta_1 \land x \in A} \subset \defset{f(x)}{0 < |x - x_0| < \delta_2 \land x \in A}$.

            Но тогда \[\varlimsup\limits_{x \to x_0}f(x) = \inf\limits_{\delta > 0}h'(\delta) = \lim\limits_{\delta \to 0}h'(\delta)\]\[\varliminf\limits_{x \to x_0}f(x) = \sup\limits_{\delta > 0}l'(\delta) = \lim\limits_{\delta \to 0}l'(\delta)\]

            \item[II.] $x_0 \in A' \cap \{\pm\infty\}$. Рассмотрим для определённости $x_0 = +\infty$. Окрестности такой точки --- лучи $(M; +\infty)$.
            \[h'(M) = \sup\defset{f(x)}{x > M, x \in A}\]
            \[l'(M) = \inf\defset{f(x)}{x > M, x \in A}\]
            Аналогично (I) $h', l' : \R \map \R$ --- функции, причём $h'$ убывает, а $l'$ возрастает.
            В таком случае \[\varlimsup\limits_{x \to +\infty}f(x) = \inf_M h'(M) = \lim\limits_{h \to +\infty}{h'(M)}\] \[\varliminf\limits_{x \to +\infty}f(x) = \sup_M l'(M) = \lim\limits_{M \to +\infty}{l'(M)}\]
            \note{Ввиду монотонности $l'$ и $h'$ можно считать, что $M \in B$, где $B \subset \R$ и $B$ --- не ограничено.}
        }
        В частности, для последовательности: пусть $\{x_n\}_{n \in \N}$ --- ограниченная последовательность. Тогда \[\varlimsup\limits_{n \to +\infty}x_n = \lim\limits_{i \to +\infty}\sup\limits_{j > i}x_j = \inf_{i \in \N}\sup\limits_{j > i}x_j\]
        \[\varliminf\limits_{n \to +\infty}x_n = \lim\limits_{i \to +\infty}\inf\limits_{j > i}x_j = \sup\limits_{i \in \N}\inf\limits_{j > i}x_j\]
    }

    \newlection{21 октября 2022 г.}


    \section{Бесконечные пределы}
    Пусть $f: A \map \R, A \subseteq \R, x_0 \in A'$.
    \definition[Предел $+\infty$]{
        $f$ имеет предел $+\infty$  в точке $x_0$, если
        \[\forall \U{+\infty} : \exists \V{x_0} : \forall x \in \V{x_0} : f(x) \in \U{+\infty}]\]
    }

    Так, для $f : (0; +\infty); \quad f : x \mapsto \frac{1}{x} : \quad \lim\limits_{x \to 0}f(x) = +\infty$.

    Аналогично определён предел $-\infty$.

    Тогда для $f: (-\infty; 0); \quad f : x \mapsto \frac{1}{x} : \quad \lim\limits_{x \to x_0}f(x) = -\infty$.

    \definition[Стремление к $\infty$]{
        $f$ стремится к бесконечности в точке $x_0$, если $|f(x)| \underset{x \to x_0}\Map +\infty$.
    }
    Так, $\frac{1}{x}$ стремится к $\infty$ в нуле, или $\{(-1)^n n\}_{n \in \N}$ стремится к бесконечности при $n \to +\infty$.

    \proposal{\down
    \bullets{
        \item Если $f$ стремится к бесконечности, то $\lim_{x_0}\frac{1}{f} = 0$.
        \item Если $g(x) \underset{x \to x_0}\Map 0$ и $g(x) \ne 0$ вблизи 0, то $\frac{1}{g}$ стремится к бесконечности вблизи точки $x_0$.
    }
    \provebullets{
        \item Надо доказать импликацию
        \begin{gather*}
            \left(\forall M : \exists \U{x_0} :\forall x \in \left(\U{x_0} \cap A\right) |f(x)| > M\right) \then
            \left(\forall \eps > 0 : \exists \V{x_0} : \forall x \in \left(\V{x_0} \cap A\right) : \left|\dfrac{1}{f(x)}\right| < \eps\right)
        \end{gather*}
        Подойдёт для $\eps: M = \frac{1}{\eps}$ и точно такая же окрестность.
        \item Здесь, наоборот, подойдёт $\eps = \frac{1}{M}$ и точно такая же окрестность.
    }
    }


    \section{Пределы справа и слева}
    $f : A \map \R, A \subseteq \R, x_0 \in \left(A' \cap \R\right)$.

    Предположим, что $x_0$ --- по-прежнему предельная точка для $A \cap (x_0; +\infty)$.
    Так, для $A = (0; 1) \cup \{2\}$ это предположение верно для $x_0 \in [0; 1)$ и неверно для $x_0 \in [1; +\infty)$.

    \definition[Предел справа]{
        Если $\exists \lim_{x_0} f \Big|_A \cap (x_0; +\infty) = c$, то $c$ называется пределом функции $f$ в точке $x_0$ справа.

        Обозначают $\lim_{x_0+}f$ или $\lim\limits_{x \to x_0+0}f(x)$.
    }
    Предположим, что $x$ --- по-прежнему предельная точка для $A \cap (-\infty; x_0)$.

    \definition[Предел слева]{
        Если $\exists \lim_{x_0} f \Big|_A \cap (-\infty; x_0) = c$, то $c$ называется пределом функции $f$ в точке $x_0$ слева.

        Обозначают $\lim_{x_0-}f$ или $\lim\limits_{x \to x_0-0}f(x)$.
    }

    Пример: функция $f(x) = \all{3,&x < 1 \\ 0,&x = 1\\ x,&x > 1}$ имеет пределы: $\lim_{1-}f = 3; \quad \lim_{1+}f = 1$.

    $h(x) = \all{\sin\left(\frac{1}{x}\right),&x > 0 \\ 0,& x < 0}: \quad \nexists \lim_{0+}h; \quad  \lim_{0-}h = 0$.

    \precaution{ Не путать левые и правые пределы с верхними и нижними. }

    \theorem{
        Пусть $x_0$ --- предельная точка и для $A \cap (x_0; +\infty)$, и для $A \cap (-\infty; x_0)$.
        Следующие условия эквиваленты:
        \numbers{
            \item $f$ имеет предел в точке $x_0$.
            \item $f$ имеет предел и слева, и справа, и они равны.
        }
        \provetwhen{
            Предел есть как у $f$, так и у её сужений на $A \cap (x_0; +\infty)$ и на $A \cap (-\infty; x_0)$.
        }{
            Запишем условия существований обоих пределов, выберем минимальную из двух окрестностей.
        }
    }


    \section{Классификация разрывов}
    Пусть $x_0 \in A$, $x_0$ --- предельная точка для $A$.
    Пусть функция не является непрерывной (\ref{first_continuous_function_deftinition}), то есть предела нет, либо он существует, но не равен $f(x_0)$, то говорят, что $f$ имеет (претерпевает) разрыв в $x_0$.
    \bullets{
        \item Разрыв первого рода: устранимый разрыв: $\exist \lim_{x_0}f \ne f(x_0)$.
        \item Разрыв первого рода: скачок $\exists \lim_{x_0+}f; \exists\lim_{x_0-}f; \quad \lim_{x_0+}f \ne\lim_{x_0-}f$.
        \item Разрыв второго рода --- всё остальное.
    }


    \section{Непрерывные функции на замкнутых конечных множествах}
    $f: A \map \R$, $x_0 \in A$.

    Определим непрерывные функции немного по-другому:
    \definition[$f$ непрерывна в $x_0$]{
        $\forall U(f(x_0)) : \exists V(x_0) : f\left(V(x_0) \cap A\right) \subset U(f(x_0))$.
    }
    Это определение утверждает, что в изолированной точке $x_0 \in A$ функция также непрерывна.

    В предельной же точке $x_0 \in A'$ непрерывная функция, согласно определению, имеет предел, равный $f(x_0)$.

    \definition[Функция $f$ непрерывна на множестве $A$]{
        Функция $f$ непрерывна на всех точках множества $A$.
    }
    \fact{
        Для $f, g$ --- непрерывных функций в точке $x_0$, то для $\alpha, \beta \in \R$ в точке $x_0$ непрерывны также их линейные комбинации $\alpha f + \beta g$ и произведение $fg$.

        Если $g(x_0) \ne 0$, то $\frac{1}{g}$ тоже непрерывна в $x_0$.
        \provehere{
            Если $x_0$ --- изолированная точка, то утверждение тривиально.

            Иначе $x_0 \in A'$ и утверждение следует из соответствующих теорем о пределах.
        }
    }
    Непрерывность в точке $x_0$  в терминах неравенств:
    \[\forall \eps > 0: \exists \delta > 0 : \forall x \in A: \left(|x - x_0| < \delta \then \left|f(x) - f(x_0)\right| < \eps\right) \]

    \theorem[Непрерывность на языке последовательностей]{
        Функция $f$ непрерывна в $x_0 \in A$ $\iff$ для всякой последовательности $\{y_n\}_{n \in \N} \subset A$, стремящейся к $x_0$: $f(y_n) \underset{n \to +\infty}\Map f(x_0)$.
        \provetwhen{
            \begin{gather*}
                \forall \eps > 0 : \exists \delta > 0 : \forall x \in A: \left(|x - x_0| < \delta \then |f(x) - f(x_0)| < \eps\right)
                \forall \delta > 0 : \exists N : \left(n > N \then |y_n - x_0| < \delta\right)
            \end{gather*}
            Скрестив эти два условия, получаем $\forall \eps > 0 : \exists N : \forall n > N: |f(y_n) - f(x_0)| < \eps$.
        }{
            От противного: если $f$ не непрерывна в $x_0$, то $\exists \eps > 0 : \forall \delta > 0 : \exists y \in A : |y - x_0| < \delta \land |f(y) - f(x_0)| \ge \eps$.

            Тогда возьмём $\delta_n = \frac{1}{n}$. Находим $y = y_n$ из строчки выше, получаем противоречие.
        }
    }
    \newlection{24 октября 2022 г.}


    Пусть $A \subset \R$ --- замкнутое конечное множество;\ $f: A \map \R$ --- непрерывная функция.
    \theorem[Вейерштрасс, 1-я]{
        Функция $f$ при заданных условиях ограниченна на $A$.
        \provehere{
            От противного: $f$ не ограниченна.
            Тогда $\forall n \in \N: \exists x_n \in A : |f(x_n)| > n$.
            Так как $\{x_n\} \subset A$, то $\{x_n\}$ ограничена.

            Значит, в ней есть сходящаяся подпоследовательность $\{x_{n_j}\}$~(\ref{segment_compactivity_2}).
            Пусть последовательность $\{x_{n_j}\}$ сходится к $z$.
            Отсюда последовательность $f(x_{n_j})$ сходится к $f(z)$, но так не может быть, потому что $f(x_{n_j})$ не ограниченна, а $f(z)$ --- вполне себе реальное значение.
        }
    }
    \theorem[Вейерштрасс, 2-я]{\label{Weierstrass_2}
    Функция $f$ при заданных условиях принимает свои наибольшее и наименьшее значения.
    \provehere{
        Так как она ограниченна, то из предыдущей теоремы \[\exists l \coloneqq \inf f(A)\text{ и }\exists M \coloneqq \sup f(A)\]
        Докажем, что эти значения достигаются, без потери общности докажем про супремум.
        Так как $M = \sup f(A)$, то $\forall n \in \N: \exists x_n \in A: f(x_n) > M - \frac{1}{n}$.

        У этой последовательности $\{x_n\}$ также существует сходящаяся подпоследовательность $\{x_{n_j}\}$~(\ref{segment_compactivity_2}).
        Пусть $z = \lim_{+\infty}x_{n_j}$.
        Тогда рассмотрим $f(z)$.
        Так как $f(x_n) > M - \frac{1}{n}$, то $f(z) \ge M$. Но $f(x_n) \le M$ заведомо, ведь $M$ --- супремум.
        Отсюда $f(z) = M$.
    }
    }
    \theorem[Дарбу, о промежуточных значениях]{
        Пусть $f: \langle a, b \rangle \map \R$.
        Здесь $\langle a, b \rangle$ --- отрезок, луч, или даже прямая, у которого концы могут быть как включены, так и нет.

        Рассмотрим ${\alpha, \beta \in \langle a, b \rangle~(\alpha < \beta)}$. Пусть $x = f(\alpha), y = f(\beta)$.
        Тогда \[\forall z \in (\min(x, y), \max(x, y)): \exists \gamma \in (\alpha, \beta) : f(\gamma) = z\]
        \provehere{
            От противного: пусть $\exists \alpha, \beta, z : z \in (\min(x, y), \max(x, y))$ такие, что $z \notin f\left((\alpha; \beta)\right)$.

            Обозначим $L = \defset{u \in [\alpha; \beta]}{f(u) \le z}$ и $H = \defset{u \in [\alpha; \beta]}{f(u) \ge z}$.

            По противному предположению $L \cap H = \o$.
            С другой стороны, $L \cap H = [\alpha; \beta]$.

            Докажем, что $L$ и $H$ замкнуты, без потери общности докажем это для $L$.
            Рассмотрим некую последовательность $\{u_n\}_{n \in \N} \subset L$.
            Так как $\forall u_n \in \{u_n\}: f(u_n) \le z$, то $f(\lim\limits_{n \to \infty}u_n) \le z$, т.\ е.\ $L$ замкнуто.

            Таким образом, мы пришли к противоречию, так как по теореме о связности отрезка~(\ref{segment_connectivity}) это невозможно.
        }
    }
    \corollary{
        Пусть $f: \langle a, b \rangle \map \R$ --- непрерывная функция.
        Следующие условия эквивалентны:
        \numbers{
            \item $f$ инъекция
            \item $f$ строго монотонная (строго возрастает или строго убывает).
        }
        \provewthen{
            Очевидно.
        }{
            Докажем, что $f$ является нестрого монотонной. От противного: предположим противное.
            Тогда $\exists \alpha < \beta < \gamma : \alpha, \beta, \gamma \in \langle a, b \rangle: \quad \all{f(\alpha) < f(\beta) \\ f(\gamma) < f(\beta)} \lor\quad \all{f(\alpha) > f(\beta) \\ f(\gamma) > f(\beta)}$
            \note{
                На самом деле, отрицанием монотонности является $\exists c_1 < c_2$ и $c_3 < c_4$ такие, что \[(f(c_1) < f(c_2)) \land (f(c_3) > f(c_4))\]
                Разбором случаев можно получить существование искомых трёх точек, но этот разбор случаев не будет приведён.
            }
            В случае $\all{f(\alpha) < f(\beta) \\ f(\gamma) < f(\beta)}$ без потери общности предположим, что $f(\alpha) \le f(\gamma)$.
            Тогда по теореме о промежуточном значении $f$ принимает значение $f(\alpha)$ на отрезке $[\beta; \gamma]$.
            Получили противоречие с инъективностью.

            Аналогично можно доказать в другом случае.

            Отсюда $f$ нестрого монотонна, а из-за инъективности --- строго.
        }
    }
    \corollary{
        Для непрерывной функции $f: \langle a, b \rangle \map \R$ образ всякого замкнутого отрезка $[\alpha, \beta]$ есть замкнутый отрезок.
        \provehere{
            По теореме Вейерштрасса у образа есть минимальное и максимальное значение.
            По теореме Дарбу все значения между ними достигаются.
        }
    }
    \theorem{
        Пусть $f: \langle a, b \rangle \map \R$.
        Среди следующих двух условий любые два влекут третье:
        \numbers{
            \item $f$ непрерывна и инъективна.
            \item $f$ строго монотонна.
            \item Образ любого замкнутого отрезка есть замкнутый отрезок.
        }
        \provebullets {
            \item $(1) \land (3) \then (2)$ --- см. выше, верно даже $(1) \then (2)$.
            \item $(1) \land (2) \then (3)$ --- см. выше, верно даже $(1) \then (3)$.
            \item $(2) \land (3) \then (1)$.
            Инъективность следует из $(2)$.
            Докажем, что $f$ непрерывна.
            Предположим, что $f$ строго возрастает (иначе можно рассмотреть $-f$).

            Рассмотрим $x_0 \in \langle a, b \rangle$ такой, что $f$ претерпевает разрыв в точке $x_0$.
            \bullets{
                \item $x_0 \in (a, b)$.

                Так как $f$ строго монотонна, то
                \[\exists u \coloneqq \lim\limits_{y \to x_0-}f(y) \land \exists v \coloneqq \lim\limits_{y \to x_0+}f(y)\]
                так как $f$ слева от $x_0$ возрастает и ограничена числом $x_0$, аналогично справа.

                Разрыв означает $u \ne v$.
                Так как $u \le f(x_0) \le v$, то либо $u < f(x_0)$ (в этом случае значения из $(u; f(x_0))$ не достигаются нигде не $\langle a, b \rangle$), либо $f(x_0) < v$ (в этом случае значения из $(f(x_0), v)$ не достигаются нигде на $\langle a, b \rangle$).

                В любом случае, есть непрерывный отрезок, строго внутри которого лежит $x_0$, тогда его образом не является непрерывный отрезок, противоречие.

                \item Теперь пусть $x_0 = a$ и $f$ разрывна в $x_0$.

                На самом деле тогда всё будет абсолютно аналогично, $\lim\limits_{y \to x_0+0}f(y) > f(x_0)$.
                Здесь образом малого отрезка $[x_0; x_0 + \eps]$, такого, что $\eps < b - a$. Опять же не является непрерывный отрезок.
            }
        }
    }
    \corollary{
        Если $f: [a, b] \map \R$ --- строго монотонная непрерывная функция, то $f^{-1}: I \map [a, b]$ тоже непрерывна.
%        Здесь $I = \left[\min(f(a), f(b)), \max(f(a), f(b))\right]$.
    }
    \newlection{3 ноября 2022 г.}


    \section{Степени и корни}
    \theorem{Пусть $g: [a, b] \map \R$ непрерывна и инъективна.
    Из непрерывности $I \coloneqq g([a; b])$ --- отрезок ($I = [\min(g(a), g(b)), \max(g(a), g(b))]$).

    Пусть $h = g^{-1} : I \map [a; b]$. Тогда $h$ непрерывна.
    \provehere{
        \item $h$ строго монотонна, так как $g$ строго монотонна.
        \item $h$, как обратная функция, инъективна.
    }
    }
    Пусть $g_k: \R_{\ge 0} \map \R; \quad x \mapsto x^k$ для фиксированного $k \in \N$.

    Рассмотрим ей обратную $h_k: [0; +\infty) \map [0; +\infty)$.
    Формально, мы доказывали, что такая обратная существует и монотонна для функций, непрерывных на отрезке.
    Но можно сузить функцию $g_k$ на любой сколь угодно большой отрезок $[0; b]$, откуда получим, что $h_k$ существует и непрерывна в любой точке $\R_{\ge 0}$.

    \definition[Корень натуральной степени]{$\sqrt[k]{x} \bydef h_k(n)$, где $h_k$ определена выше.}
    \definition[Степень с рациональным положительным показателем]{
        $x^r \bydef \sqrt[n]{x^m}$ для $r \in \Q_{>0}$, где $r = \frac{m}{n}, m, n \in \N$.
    }
    Заметим, что из определения (обратной функции) $\sqrt[k]{y}$ --- единственное положительное число $u: u^k = y$.

    Пусть $\frac{k}{l} = \frac{m}{n}$.
    Чтобы показать корректность определения степени с рациональным положительным показателем, докажем, что $\sqrt[l]{x^{k}} = \sqrt[n]{x^{m}}$.
    Это равенство равносильно тому, что $\left(\sqrt[l]{x^{k}}\right)^{n} = x^{m}$.
    \indent{
        \fact{
            $\sqrt[a]{v^b} = \left(\sqrt[a]{v}\right)^b$.
            В самом деле, $v^b \overset?= \left(\sqrt[a]{v}\right)^{ba} = \left(\sqrt[a]{v}\right)^{ab} = v^b$.
        }
    }
    Применив факт, получим левую часть, равной $\sqrt[l]{x^{k n}}$.
    Но так как $l \divs k n$, то мы можем <<сократить>> на этот множитель, получив искомое $x^{m}$.

    Таким образом, определение степени с рациональным положительным показателем корректно.
    Более того, несложно видеть, что оно согласовано с определением натуральной степени.

    \subsection{Свойства}
    \bullets{
        \item $\sqrt[n]{x} \cdot \sqrt[n]{y} = \sqrt[n]{xy}$.
        Можно проверить, что обе части равенства при возведении в степень $n$ дают $xy$.
        \item $\sqrt[n]{\sqrt[m]{x}} = \sqrt[nm]{x}$.
        Так же можно проверить.
        \item $(x^{r_1})^{r_2} = x^{r_1 \cdot r_2}$
        \provehere{Пусть $r_1 = \frac{k}{l}, r_2 = \frac{m}{n}$
            \[\sqrt[n]{(\sqrt[l]{x^k})^m} = \sqrt[n]{\sqrt[l]{x^{km}}}= \sqrt[nl]{x^{mk}}\]
        }
        \item $x^{r_1} \cdot x^{r_2} = x^{r_1 + r_2}$.
        \provehere{Пусть $r_1 = \frac{k}{l}, r_2 = \frac{m}{n}$
            \[\sqrt[ln]{x^{kn}} \cdot \sqrt[nl]{x^{ml}} = \sqrt[nl]{x^{kn + ml}} = x^{r_1 + r_2}\]
        }
    }
    \definition[Степень с произвольным рациональным показателем]{
        Для положительных уже определено, определим для остальных:
        Для $x > 0: x^q \bydef \all{1,&q = 0\\ \frac{1}{x^{-q}},&q < 0}$
    }


    \section{(Асимптотическое) сравнение функций. $\bigO$ и $o$ символика.}
    Пусть $f, g: A \map \R$, где $A \subset \R$.
    \definition[$f$ есть $O(g)$ на $A$]{
        $\exists C: \forall x \in A: |f(x)| \le C|g(x)|$.

        Обозначают $f = \bigO(g)$.
        Это исторически сложившаяся запись, в которой $=$ некоммутативно.

        В связи с такой записью, также пишут $\text{expression}_1 = \text{expression}_2 + \bigO(\text{something})$.
    }
    Можно говорить об этом на подмножествах $A$, а можно просто сузить функции.
    \bullets{
        \item {
            $f = \bigO(g), g = \bigO(h) \then f = \bigO(h)$.
            \provehere{Константы, получающиеся при оценке, перемножаются.}
        }
        \item $\phi_1 = \bigO(\psi_1), \phi_2 = \bigO(\psi_2) \then \phi_1 \phi_2 = \bigO(\psi_1 \psi_2)$.
        \item $f = \bigO(1) \then f$ ограничена.
    }
    \ok
    Можно сравнивать <<асимптотическое>> поведение функций в данной точке:
    пусть $f, g: A \map \R$, $x_0 \in A'$.
    \definition[$f$ есть $o(g)$ в точке $x_0$]{
        \[\forall \eps > 0: \exists \U{x_0}: \forall x \in \left(\U{x_0} \cap A\right): |f(x)| < \eps|g(x)|\]

        Обозначают $f = o(g)$ в $x_0$.
    }
    Так, $o(1)$ --- стремящиеся к нулю функции.

    \fact{
        Если $\forall x \in A \bs \{x_0\}: f(x) \ne 0$, то $f = o(g) \iff \lim_{x_0}\frac{f(x)}{g(x)} = 0$.
        \provehere{Поделить определение на $|g(x)|$.}
    }
    \fact{Если $f = o(g)$, то $f = \bigO(g)$ вблизи $x_0$.}
    \proposal{
        Пусть $f, g, h: A \map \R$ и $x_0 \in A'$.
        \numbers{
            \item Если $f = o(g)$ в $x_0$ и $g = \bigO(h)$ вблизи $x_0$, то $f = o(h)$ в $x_0$.
            \item Если $f = \bigO(g)$ вблизи $x_0$ и $g = o(h)$ в $x_0$, то $f = o(h)$ в $x_0$.
            \provehere {
                Докажем первый пункт:

                $\exists \U{x_0} : \exists c: |g(x)| \le C|h(x)|$ в $\U{x_0} \cap A$.

                $\forall \eps > 0: \exists \V{x_0} : |f(x)| \le \eps|g(x)|$. Можно считать, что $\V{x_0} \subset \U{x_0}$.

                $\forall x \in \V{x_0} \cap A : |f(x)| \le \eps|g(x)| \le C\cdot\eps |h(x)|$.
            }
        }
    }
    \ok
    Пусть $f : A \map \R$, $x_0 \in A', A \subset \R$.
    \definition[$f$ бесконечна малая в $x_0$]{$\lim_{x_0}f = 0$}
    \definition[$f$ бесконечна большая в $x_0$]{$\lim_{x_0}|f| = +\infty$}
    \fact{$f$ бесконечно малая и не обращается в ноль вблизи $x_0 \iff \frac{1}f$ бесконечно большая. }
    \definition[$f$ --- бесконечно малая величина более высокого порядка, чем $g$ в точке $x_0$]{$\lim_{x_0}f = 0; ~\lim_{x_0}g = 0;~ f = o(g)$.}
    Так, $x^2$ --- бесконечно малая более высокого порядка, чем $x$ в нуле.
    \definition[$f$ --- бесконечно большая величина более высокого порядка, чем $g$ в точке $x_0$]{$\lim_{x_0}|f| = +\infty; ~\lim_{x_0}|g| = +\infty;~ g = o(f)$.}
    Так, $x^2$ --- бесконечно большая более высокого порядка, чем $x$ на $\infty$.


    \chapter{Дифференцирование}
    \newlection{12 ноября 2022 г.}
    А что было?
    Я прогульщик\ldots

    \newlection{14 ноября 2022 г.}

    \subsection{Резюме определений дифференцируемости}
    Пусть $f: \langle a, b \rangle \map \R$.
    \proposal{
        Следующие условия эквивалентны:
        \numbers{
            \item $\exists \lim\limits_{x \to x_0}\frac{f(x) - f(x_0)}{x - x_0} \bydef f'(x_0)$.
            \item $\exists g: \langle a, b \rangle \map \R, $ непрерывная в $x_0 \in \langle a, b \rangle$, такая, что $f(x) -f(x_0) = g(x) \cdot (x - x_0)$.
            \item $\exists c \in \R: f(x) - f(x_0) = c \cdot (x - c_0) + o(x - x_0)$ при $x \to x_0$.
        }
        \provebullets{
            \item $(1) \then (2)$. Достаточно рассмотреть $g(x) = \all{\frac{f(x) - f(x_0)}{x - x_0},& x \ne x_0 \\ f'(x_0),&x = x_0}$.
            \item $(2) \then (3)$. $f(x) - f(x_0) = g(x_0) \cdot (x - x_0) + (g(x) - g(x_0))\cdot (x - x_0)$, причём $g(x) -g (x_0) \underset{x \to x_0}\Map 0$.
            \item $(3) \then (1)$. $\frac{f(x) - f(x_0)}{x - x_0} = c + o(1)$.
        }
    }
    \definition[Линейный дифференциал]{\label{differential_def}
        $\d_f(x_0, h) = f'(x_0) \cdot h$.
    }

    \subsection{Арифметические свойства дифференцирования}
    \proposal{
        Если $f, g: \langle a, b \rangle \map \R$, обе дифференцируемы в $x_0$, то \[\forall \alpha, \beta \in \R: (\alpha f + \beta g)'(x_0) = \alpha f'(x_0) + \beta g'(x_0)\]
        \provehere{
            \[\dfrac{(\alpha f + \beta g)(x) - (\alpha f + \beta g)(x_0)}{x - x_0} = \alpha \frac{f(x) - f(x_0)}{x - x_0} + \beta \frac{g(x) - g(x_0)}{x - x_0} \underset{x \to x_0}\Map \alpha \cdot f'(x_0) + \beta g'(x_0)\]
        }
    }
    \proposal{
        Если $f, g: \langle a, b \rangle \map \R$, обе дифференцируемы в $x_0$, то \[(f \cdot g)'(x_0) = f(x_0)g'(x_0) + f'(x_0)g(x_0)\]
        \provehere{
            $\exists \phi, \psi: \langle a, b \rangle \map \R$ непрерывные в $x_0$, такие, что $f(x) - f(x_0) = \phi(x) \cdot (x - x_0)$ и $g(x) - g(x_0) = \psi(x) \cdot (x - x_0)$.

            Тогда \begin{gather*}
                      f(x)g(x) - f(x_0)g(x_0) =\\
                      (f(x) - f(x_0))g(x) + f(x_0)(g(x) - g(x_0)) =\\
                      \phi(x) \cdot (x - x_0) \cdot g(x) + f(x_0) \cdot \psi(x) \cdot (x - x_0) =\\
                      h(x) \cdot (x - x_0)
            \end{gather*}
            где $h(x) = \phi(x) \cdot g(x) + f(x_0) \cdot \psi(x)$ --- непрерывна в $x_0$.
        }
    }

    \subsection{О суперпозиции (композиции)}
    \note{
        Для $E \subset \R, f: E \map \R$, такой, что $f$ непрерывна в $x_0 \in E$.

        Положим $A \subset \R$, $A \supset f(E), g: A \map \R$, так, что $g$ непрерывна в $y_0 = f(x_0)$.

        Докажем, что $g \circ f$ непрерывна в $x_0$.
        \provehere{
            Пусть $z_0 = g(y_0)$. Рассмотрим окрестность $W(z_0)$. Из непрерывности $g: \exists V(y_0): g(V(y_0)) \subset W(z_0)$.

            Кроме этого, $\exists U(x_0): f(U(x_0)) \subset V(y_0)$. Значит, $g(f(U(x_0))) \subset W(z_0)$ и $g \circ f$ непрерывна по определению.
        }
    }
    \corollary{
        Пусть $f: E \map \R$ и $u_0 \in E'$, в которой $f$ существует (однако не обязательно непрерывна), для $A \supset f(E)$ рассмотрим $g: A \map \R$, непрерывную в $v_0 = f(u_0)$.

        Если $\exists \lim\limits_{x \to u_0}f(x) = c$, то $\lim\limits_{x \to u_0}(g \circ f)(x) = g(c)$.

        \note{Условие непрерывности $g$ нельзя отбросить: $h(x) = (\chi_{\{0\}}) \circ \left(x \cdot \sin\left(\frac{1}{x}\right)\right)$ не имеет предела в нуле, в точках $\frac{1}{\pi \cdot n}$ она равна 1, в остальных --- 0.}
        \provehere{
            Рассмотрим $f_1(x) = \all{f(x),& x \ne u_0 \\ \lim\limits_{x \to u_0}f(x),&x = u_0}$.
            $f_1$ уже непрерывна в $u_0$, значит, $g \circ f_1$ непрерывна в $u_0$.
        }
    }

    \subsubsection{Производная композиции}
    \theorem{
        Пусть $f: \langle a, b \rangle \map \R; f(\langle a, b \rangle) \subset \langle c, d \rangle; g: \langle c, d \rangle \map \R$.

        Если $f$ дифференцируема в $x_0 \in \langle a, b \rangle$ и $g$ дифференцируема в $y_0 = f(x_0)$, то $(g \circ f)'(x_0) = g'(f(x_0)) \cdot f'(x_0) = g'(y_0)\cdot f'(x_0)$.
        \note{
            В старых книжках можно встретить доказательство вида
            \[\frac{g(f(x)) - g(f(x_0))}{x - x_0} = \frac{g(f(x)) - g(f(x_0))}{f(x) - f(x_0)} \cdot \frac{f(x) - f(x_0)}{x - x_0} \underset{x \to x_0}\Map g'(f(x_0)) \cdot f(x_0)\]
            которое было бы корректным при условии $f(x) \ne f(x_0)$ вблизи $x_0$.

            Однако это вовсе не обязано выполняться, наиболее простым способом обойти это ограничение является возня с функциями $\phi$ и $\psi$, как ниже.
        }
        \prove{
            $\exists \phi: \langle a, b \rangle \map \R$, непрерывная в $x_0$, такая, что $f(x) - f(x_0) = \phi(x) \cdot (x - x_0)$.

            $\exists \psi: \langle c, d \rangle \map \R$, непрерывная в $y_0$, такая, что $g(y) - g(y_0) = \psi(y) \cdot (y - y_0)$.

            Подставим во второе равенство ${y = f(x): g(y) - g(y_0) = \psi(f(x)) \cdot (f(x) - f(x_0)) = \psi(f(x)) \cdot \phi(x) \cdot (x - x_0)}$.

            Так как $h(x) = \psi(f(x)) \cdot \phi(x)$ непрерывна в $x_0$, то в самом деле $f(g(x))$ дифференцируема в $x_0$.

            Сама производная $(g \circ f)'(x_0) = h(x_0) = \psi(f(x_0)) \phi(x_0) = g'(f(x_0)) \cdot f'(x_0)$.
        }
    }

    \subsection{Производная $x^n$}
    \fact{
        $(x^n)' = n x^{n - 1}$ для $n \in \N$
        \provehere{ По индукции.
        \bullets{
            \item $n = 1 \then \lim\limits_{x \to x_0}\frac{x - x_0}{x - x_0} = 1$
            \item $(x \cdot x^n)' = x' \cdot x^n + x \cdot (x^n)' = x^n + x \cdot nx^{n - 1} = (n + 1)x^n$.
            \qedhere
        }
        }
    }
    \note{Для $f \equiv c$ --- константы: $f'(x_0) = 0$.}
    \fact{
        $(x^n)' = n x^{n - 1}$ для $n \in \Z$
        \provehere{ По индукции.
        \bullets{
            \item $n = -1 \then \lim\limits_{x \to x_0}\frac{\frac{1}{x} - \frac{1}{x_0}}{x - x_0} = \lim\limits_{x \to x_0}\frac1{x\cdot x_0} = -\frac{1}{x_0^2}$
            \item $(\frac{1}{x}) \cdot (x^n)' = \left(\frac{1}{x}\right)' \cdot x^n + \frac{1}{x} \cdot (x^n)' = -x^{n-2} + \frac{1}{x} \cdot nx^{n - 1} = (n - 1)x^{n-2}$.
            \qedhere
        }
        }
    }
    \corollary{
        Для $f: \langle a, b \rangle \map \R: \left(\frac{1}{f}\right)'(x_0) = -\frac{f'(x_0)}{f(x_0)^2}$.
        \provehere{
            Рассмотреть $h(x) = \frac{1}{x}$ и продифференцировать $h \circ f$.
        }
    }
    \corollary{Если $f$ и $g$ дифференцируемы в $x_0$ и $g(x_0) \ne 0$, то $\left(\frac{f}{g}\right)'(x_0) = f'(x_0)\cdot \left(\frac{1}{g}(x_0)\right) + f(x_0)\cdot \left(\frac{1}{g}\right)'(x_0) = \frac{f'(x_0)}{g(x_0)} - f(x_0) \cdot \frac{g'(x_0)}{g(x_0)^2} = \frac{f'(x_0)g(x_0) - f(x_0)g'(x_0)}{g(x_0)^2}$.}

    \subsection{Производная обратного отображения}
    Для инъективного отображения $f: \langle a, b \rangle \map \R$, дифференцируемого в $x_0 \in \langle a, b \rangle$ положим $y_0 = f(x_0)$.

    В предположении непрерывности $f^{-1}$ в точке $y_0$ и того, что $f(\langle a, b \rangle)$ --- отрезок:
    \theorem{
        При сделанных предположениях и условии $f'(x_0) \ne 0$: $f^{-1}$ дифференцируема в $y_0$, причём $\left(f^{-1}\right)'(y_0) = \frac{1}{f'(x_0)} = \frac{1}{f'(f(y_0))}$.
        \note{
            Если $f$ непрерывна не только в точке $x_0$, но на всём отрезке $\langle a, b \rangle$, то автоматически следуют условия $f(\langle a, b \rangle)$ --- отрезок, и $f'(y_0)$ --- непрерывна.
        }
        \prove{
            $\exists \phi: \langle a, b \rangle$, непрерывная в $x_0$, такая, что $f(x) - f(x_0) = \phi(x) \cdot (x - x_0)$.

            Положим $x_0 = f^{-1}(y_0)$, и вообще $x = f^{-1}(y)$.

            Тогда $y - y_0 = f\left(f^{-1}(y)\right) - f\left(f^{-1}(y)\right) = \phi\left(f^{-1}(y)\right)\left(f^{-1}(y) - f^{-1}(y_0)\right)$, откуда сразу получаем (в предположении $\phi\left(f^{-1}(y)\right) \ne 0$ вблизи $y_0$, или же $f'(f^{-1}(y_0)) \ne 0$) $\frac{f^{-1}(y) - f^{-1}(y_0)}{y - y_0} \underset{y \to y_0}\Map \frac{1}{\phi\left(f^{-1}(y_0)\right)}$.
        }
    }
    \newlection{18 ноября 2022 г.}


    \section{Смыслы производной}

    \subsection{Скорость точки}
    Пусть материальная точка движется по прямой, её положение на прямой в момент времени $t$ --- это $x(t)$ $(t \in \langle a, b \rangle)$.

    Рассмотрев $c, d \in \langle a, b \rangle$, (можно считать $c < d$), получаем среднюю скорость движения $\frac{x(d) - x(c)}{d - c}$.

    Предел при $c \to d: v(t) = x'(t)$.

    \subsection{Касательные}
    Пусть $f: \langle a, b \rangle \map \R, x_0 \in \langle a, b \rangle$.

    Пусть $f$ дифференцируема в $x_0$; обозначим $l(x) =f(x_0) + f'(x_0)\cdot(x - x_0)$.

    Тогда $f(x) - l(x) = o(x - x_0), x \to x_0$.
    Из всего пучка прямых, проходящих через $x_0: l(x)$ единственная удовлетворяет данному свойству.

    График функции $l(x)$ называют \textit{касательной}.
    Коэффициент угла наклона касательной является пределом коэффициентов углов наклона секущих.


    \section{Связь производной и монотонности}
    Пусть $f: \langle a, b \rangle \map \R, x_0 \in \langle a, b \rangle$.

    \definition[$f$ возрастает в точке $x_0$]{
        $\exists \delta > 0: \forall x: |x - x_0| < \delta \then \all{f(x) \le f(x_0),&x \le x_0\\ f(x) \ge f(x_0),&x \ge x_0}$.
    }
    При строгом возрастании неравенства строгие.

    При (строгом) убывании тоже понятно что (например, $-f$ (строго) возрастает).
    \theorem{
        Пусть $f$ дифференцируема в точке $x_0 \in \langle a, b \rangle$.

        Если $f'(x_0) > 0$, то $f$ строго возрастает в точке $x_0$.

        Если $f$ нестрого возрастает в точке $x_0$, то $f'(x_0) \ge 0$.
        \provebullets {
            \item[(1)] $f'(x_0) > 0 \then f'(x_0) \cdot (x - x_0) + \phi(x)$, где $\phi(x) = o(x - x_0)$, то есть \[\forall \eps > 0: \exists \delta > 0: \forall x \in \langle a, b \rangle: |x - x_0| < \delta \then |\phi(x)| < \eps \cdot |x - x_0|\]
            Если $x > x_0$, то $f(x) - f(x_0) > f'(x_0) \cdot (x - x_0) - \eps \cdot |x - x_0| = (f'(x_0) - \eps) \cdot |x - x_0|$, откуда при выборе $\eps < f'(x_0)$ в самом деле получаем строгое возрастание.

            Случай $x < x_0$ рассматривается аналогично.
            \item[(2)] Раз $f$ нестрого возрастает в $x_0$, то $\frac{f(x) - f(x_0)}{x - x_0} \ge 0$ вблизи $x_0$.
            По теореме о предельном переходе в неравенствах, получаем $f'(x_0) \ge 0$.
        }
    }

    \subsection{Локальные максимум и минимум}
    \definition[$f$ имеет локальный максимум в $x_0 \in \langle a, b \rangle$]{
        \[\exists U(x_0): \forall x \in U(x_0) \cap \langle a, b \rangle: f(x) \le f(x_0)\]
    }
    \definition[$f$ имеет строгий локальный максимум в $x_0 \in \langle a, b \rangle$]{
        \[\exists \U{x_0}: \forall x \in \U{x_0} \cap \langle a, b \rangle: f(x) < f(x_0)\]
    }
    Если точка является точкой или локального минимума, или локального максимума, то её называют \textit{точкой локального экстремума}.
    \theorem[Необходимое условие существования локального экстремума]{
        Пусть $f: (a, b) \map \R$ имеет локальный экстремум в $x_0 \in (a, b)$.

        Если $\exists f'(x_0)$, то $f'(x_0) = 0$.

        \provehere{
            Пойдём от противного: либо $f'(x_0) > 0$ (тогда $f$ строго возрастает в $x_0$), либо $f'(x_0) < 0$ (тогда $f$ строго возрастает в $x_0$).

            Так как как справа, так и слева от $x_0$ есть точки области определения $f$, то в любом случае получаем противоречие.
        }
    }

    \subsection{Поведение функции на отрезке}
    \label{subsec:good_function_definition}
    Назовём функцию $f$ \textit{хорошей} на отрезке $[a, b]$, если она непрерывна на $[a, b]$ и дифференцируема на $(a, b)$.

    Этого определения не было на лекции, но я хочу его ввести, так как оно часто будет встречаться.
    \theorem[Ролль]{
        Пусть $f: [a, b] \map \R$, где $a < b$, причём она хорошая~(\ref{subsec:good_function_definition}).

        При условии $f(a) = f(b): \exists c \in [a, b]: f'(x) = 0$.
        \provehere{
            По второй теореме Вейерштрасса~(\ref{Weierstrass_2}) функция достигает на отрезке свои глобальные максимальное и минимальное значение.

            Одно из них не равно $f(a) = f(b)$ (если вдруг оба равны, то функция --- константа, откуда $f'(x) = 0$ везде).

            Тогда в этой точке $c$ достигается локальный экстремум, и $f'(c) = 0$.
        }
    }
    \ok
    Пусть $f, g: [a, b] \map \R$ --- две хорошие на $[a, b]$ функции~(\ref{subsec:good_function_definition}).

    Найдём $\alpha \in \R: f(x) + \alpha \cdot g(x)$ удовлетворяет условию теоремы Ролля.

    $f(a) + \alpha \cdot g(a) = f(b) + \alpha \cdot g(b) \then \alpha(g(b) - g(a)) = f(b) - f(a)$.

    Предположим, что $g(b) \ne g(a)$.
    В таком случае $\alpha = -\dfrac{f(b) - f(a)}{g(b) - g(a)}$, и к функции $f(x) + \alpha \cdot g(x)$ применима теорема Ролля: \[\exists c \in (a, b): f'(c) + \alpha \cdot g'(c) = 0\]

    Отсюда $\dfrac{f(b) - f(a)}{g(b) - g(a)}\cdot g'(c) = f'(c)$.

    При условии $\forall t  \in (a, b): g'(t) \ne 0$ получаем $\dfrac{f(b) - f(a)}{g(b) - g(a)} = \dfrac{f'(c)}{g'(c)}$.

    \theorem[Формула Коши]{\label{Cauchy_formula}
    При сделанных предположениях, а именно: $f, g: [a, b] \map \R$ --- две хорошие на $[a, b]$ функции~(\ref{subsec:good_function_definition}), и $g(a) \ne g(b)$ и $\forall t  \in (a, b): g'(t) \ne 0$ выполняется условие \[\exists c \in (a, b) : \dfrac{f(b) - f(a)}{g(b) - g(a)} = \dfrac{f'(c)}{g'(c)}\]
        \provehere{Смотри выше.}
    }
    \note{
        Формула работает и для $b < a$.
        В любом случае (при хороших $f, g$~(\ref{subsec:good_function_definition})), \[\exists c \in (a, b) : \dfrac{f(b) - f(a)}{g(b) - g(a)} = \dfrac{f'(c)}{g'(c)}\]
    }
    \corollary[Формула Лагранжа]{
        При $g(x) = x$ формула Коши приобретает вид \[\exists c \in (a, b): f(b) - f(a) = f'(c) \cdot (b - a)\]
    }
    \note{
        Формула работает и для $b < a$.
        В любом случае (при выполнении условий на непрерывность и дифференцируемость $f$), $\exists c \in (\min(a, b), \max(a, b)): f(b) - f(a) = f'(c) \cdot (b - a)$.
    }
    \note{
        Формулу можно читать в таком свете: для хорошей (см. выше) функции $f$, есть касательная к точке внутри интервала $(a, b)$, параллельная секущей, проходящей через $(a, f(a))$ и $(b, f(b))$.
    }
    Формула Лагранжа довольно полезна даже в вычислениях: если известно $f(a)$ и $f'(x)$ ограничена, причём $b - a$ мало, то можно оценить $f(b)$.
    \corollary{\label{zero_derivative}
    Если $f$ непрерывна на $[a, b]$ и дифференцируема на $(a, b)$, то при условии $\forall x \in (a, b): f'(x) = 0$: $f$ --- константа.
    \provehere{
        От противного, применить формулу Лагранжа к $u, v: f(u) \ne f(v)$.
    }
    }
    \corollary{
        Если $f'(x) \ge 0$ на $(a, b)$ и $f(x)$ дифференцируема на $[a, b]$, то $f$ нестрого возрастает на $[a, b]$.

        При строгом неравенстве --- строгое возрастание.

        \provehere{
            Применить формулу Лагранжа.
        }
    }
    \corollary{
        Если $g$ непрерывна на $[a, b]$, дифференцируема на $(a, b)$, и $\forall x \in (a, b): g'(x) \ne 0$.

        Тогда производная $g'(x)$ одного знака на $(a, b)$.

        \provehere{
            Пусть $u, v \in [a, b]$. Тогда $\exists c \in (a, b): f(v) - f(u) = f'(c) \cdot (v - u) \ne 0$.

            Отсюда видим, что $f$ инъективна, то есть она строго возрастает (или убывает).

            Эту же штуку она делает в каждой точке, откуда в каждой точке --- определённый знак производной.
        }
    }
    \note{
        Отсюда видим, что условие $g(b) \ne g(a)$ в формуле Коши~(\ref{Cauchy_formula}) --- лишнее.
    }
    Пример того, что производная непрерывной функции необязательно непрерывна, даже если существует:

    Рассмотрим \[f(x) = \all{x^2 \cdot \sin(\frac{1}x),&x \ne 0\\ 0,&x \ne 0}\]
    Функция непрерывна: $\dfrac{f(x) - f(0)}{x} = \dfrac{x^2\sin\left(\frac1x\right)}{x} = x\cdot \sin\left(\frac1x\right) \underset{x \to 0}\Map 0$.

    Более того, она дифференцируема в каждой точке: \[f'(0) = 0; \quad f'(x) = 2x \cdot \sin\left(\frac1x\right) + x^2 \cdot \left(-\frac{1}{x^2}\right)\cos\left(\frac1x\right) = 2x \cdot \sin\left(\frac1x\right) - \cos\left(\frac1x\right), x \ne 0\]

    Тем не менее, несложно видеть, что в нуле производная претерпевает разрыв второго рода.
    \newlection{21 ноября 2022 г.}
    Пусть $f, g: (a; b) \map \R$ дифференцируемы на области определения.
    \theorem[Простейший вариант правила Лопиталя]{
        Пусть $\lim_a f = \lim_a g = 0$.
        При условии $g'(x) \ne 0$ вблизи $a$ и $\exists \lim\limits_{x \to a+}\frac{f'(x)}{g'(x)} = d \in \R$: $\lim\limits_{x \to a+}\frac{f(x)}{g(x)} = d$.

        \provehere{
            Рассмотрим $\eps > 0$, для него $\exists \delta > 0: \forall x \in (a, b): |x - a| < \delta \then \left|\frac{f'(x)}{g'(x)} - d\right| < \eps$.

            Пусть $y \in (a; b)$. Доопределим $f(a) = g(a) = 0$, получим условие правила Коши~(\ref{Cauchy_formula}).

            Получается, $\exists c \in (a, y): \frac{f(y)}{g(y)} =\frac{f(y) - f(a)}{g(y) - g(a)} = \frac{f'(c)}{g'(c)}$, откуда рассмотрев $|a - y| < \delta$, получаем $\left|\frac{f(y)}{g(y)} - d\right| < \eps$, что и есть определение предела $\lim_y \frac{f}{g} = d$.
        }
    }
    \corollary{\label{about_gaps}
    Пусть $\phi$ хорошая на $[a, b]$~(\ref{subsec:good_function_definition}).
    Предположим, что ${\exists \lim\limits_{t \to a+}\phi'(t) = d}$.

    Возьмём $g(x) = x - a$, $f(x) = \phi(x) - \phi(a)$.
    Тогда по правилу Лопиталя $\lim\limits_{x \to a+}\frac{f(x) - f(a)}{x -a} = d$, что является определением производной справа.

    Иными словами, если у производной есть предел справа, и в предельной точке она определена, то она там непрерывна справа (равна пределу справа).

    Это значит, что производная, как функция, если уж претерпевает разрыв, то обязательно второго рода.
    }
    \proposal[О среднем значении производной]{
        Пусть $f$ --- дифференцируема на $(a, b)$. Рассмотрим $\alpha, \beta \in (a, b): \alpha \ne \beta$.

        Для любого $v \in (f'(\alpha), f'(\beta)): \exists \gamma \in \overset{o}{I}_{\alpha, \beta}: f'(\gamma) = v$.

        \prove{
            Положим $g(x) = f(x) - vx$. Видим, что $g'(x) = f'(x) - v$.
            Тогда получается, что $g'(x)$ принимает значения разных знаков в $\alpha, \beta \then \exists \gamma \in I_{\alpha, \beta}: g'(\gamma) = 0$.

            Например, из теоремы Вейерштрасса, производная в экстремуме равна 0.
        }
    }
    \theorem[Ещё вариант правила Лопиталя]{
        Пусть $f, g$ --- дифференцируемы на $(a, b)$, причём $\lim\limits_{x \to a+}f(x) = \lim\limits_{x \to a+}g(x) = +\infty$.

        Если $\exists \lim\limits_{x \to a+}\frac{f'(x)}{g'(x)} = d$, то для любых $a < s < t < b: \exists c \in (s, t): \frac{f(s) - f(t)}{g(s) - g(t)} = \frac{f'(c)}{g'(c)}$.

        Рассмотрим какой-нибудь $\eps > 0$. Для него $\exists \delta > 0: \forall y \in (a, b): |y - a| < \delta \then \left|\frac{f'(y)}{g'(y)} - d\right| < \eps$.

        Будем считать, что $t < a + \delta$, зафиксируем его такое.

        \[d - \eps < \frac{f(s) - f(t)}{g(s) - g(t)} < d + \eps \iff d - \eps < \frac{f(s)}{g(s)}\dfrac{1 - \frac{f(t)}{f(s)}}{1 - \frac{g(t)}{g(s)}} < d + \eps\]

        При уменьшении $s$ $f(s)$, как и $g(s)$, становится всё больше, поэтому $\dfrac{1 - \frac{f(t)}{f(s)}}{1 - \frac{g(t)}{g(s)}}$ начиная с некоторого места --- положительна.

        \[\varlimsup\limits_{s \to a+}\dfrac{1 - \frac{f(t)}{f(s)}}{1 - \frac{g(t)}{g(s)}}(d - \eps) \le \varlimsup\limits_{s \to a+} \le \dfrac{1 - \frac{f(t)}{f(s)}}{1 - \frac{g(t)}{g(s)}}(d + \eps)\]

        Несложно видеть, что $\lim\limits_{s \to a+}\dfrac{1 - \frac{f(t)}{f(s)}}{1 - \frac{g(t)}{g(s)}} = 1$, откуда из предыдущего равенства: $d - \eps \le \varlimsup\limits_{s \to a+}\frac{f(s)}{g(s)} \le d + \eps$. Это же верно и для нижних пределов, получаем равенство предела $d$.
    }


    \section{Формула Тейлора}
    Пусть $f: (a, b)$.
    Возьмём $t \in (a, b)$.
    Будем считать, что $f$ непрерывна в $t$ (или даже на $(a, b)$).

    \definition[Многочлен Тейлора функции $f$ в точке $t$ порядка $n$]{
        Такой многочлен $p$ степени не больше $n$, что $f(x) - p(x) = o((t - x)^n)$ при $x \to t$.
    }
    \examples{
        \item Многочлен Тейлора порядка $0$ --- это константа, $p(x) = c$.
        По определению, $f(x) - c = o(1) \then c = \lim_t f = f(t)$.

        \item Многочлен Тейлора порядка $1$ --- линейный, $p(x) = \alpha \cdot (x - t) + \beta$.
        По определению $f(x) - \alpha \cdot (x -t) - \beta = o(x - t) \then f(t) = \beta, \alpha = f'(t)$.
    }

    \subsection{Построение многочлена Тейлора}
    При работе с многочленами Тейлора будем предполагать, что у функции по крайней мере в точке $t$ имеется по крайней мере $n$-я производная ($f^{(n + 1)} \bydef (f^{(n)})'$ --- производная, взятая $n + 1$ раз).

    Построим многочлен $p$ степени не больше $n$, такой, что \begin{gather*}
                                                                 p(t) = a_0\\ p'(t) = p^{(1)}(t) = a_1\\ \dots\\ p^{(n)}(t) = a_n
    \end{gather*}, где $a_0, \dots, a_n$  где $a_i$ --- наперёд заданные числа.

    Утверждается, что такой многочлен существует и единственен.

    Рассмотрим произвольный $p(x) = c_n x^n + c_{n - 1} x^{n - 1} + \dots + c_0$.

    Преобразуем выражение: $p(x) = c_n ((x - t) + t)^n + ((x - t) + t)^{n - 1} + \dots + c_0$.

    Раскроем скобки так, чтобы получить $p(x) = d_n(x - t)^n + d_{n - 1}(x - t)^{n - 1} + \dots + d_0$.

    Заметим, что
    \begin{gather*}
        p(x) = d_n(x - t)^n + \dots + d_3(x - x_0)^3 + d_2(x - x_0)^2 + d_1(x - x_0) + d_0\\
        p'(x) = n \cdot d_n(x - t)^{n-1} + \dots + 3 \cdot d_3(x - x_0)^2 + 2 \cdot d_2(x - x_0) + 1! \cdot d_1\\
        p^{(2)}(x) = n(n - 1) \cdot d_n(x - t)^{n-2} + \dots + 3 \cdot 2 \cdot d_3(x - x_0) + 2! \cdot d_2\\
        p^{(3)}(x) = n(n - 1)(n - 2) \cdot d_n(x - t)^{n-3} + \dots + 3! \cdot d_3\\
    \end{gather*}
    Вообще, по индукции можно доказать, что $p^{(k)}(0) = k! \cdot d_k$.
    \newlection{25 ноября 2022 г.}
    Итак, мы поняли, что $\exists! p \in \R[x]: \deg p \le n$ и его производные --- заранее назначенные $p^{(k)}(x_0) = \alpha_k$.

    Его можно представить в виде $p(x) = \sum\limits_{j = 0}^n \frac{\alpha_j}{j!}(x - x_0)^j$.

    \subsection{Формула Бинома Ньютона}
    Рассмотрим многочлен $q(x) = (x + a)^n$.

    Чтобы записать его в каноническом для многочлена виде, заметим, что
    \begin{gather*}
        q^{(k)}(x) = n \cdot (n - 1) \proddots (n - k + 1) \cdot (x + a)^{n - k} = \frac{n!}{(n - k)!}a^{n - k}\\
        q^{(k)}(0) =  \frac{n!}{(n - k)!}a^{n - k}
    \end{gather*}

    Но производные прямо связаны с коэффициентами многочлена, как мы знаем из разложения в ряд Тейлора в нуле. Получается, $q(x) = \sum\limits_{j = 0}^n \frac{1}{j!} \cdot \frac{n!}{(n - j)!}a^{n - j}x^j = \binom{n}{j}a^{n - j}x^j$.
    О да, мы вывели формулу Бинома Ньютона!
    \ok
    \proposal{
        В данной точке у $f$ не может быть более одного многочлена Тейлора порядка $n$ (для любого фиксированного $n$ и данной точки $x_0$).
        \provehere{
            От противного: пусть есть два многочлена, $p, q$.

            Тогда $r(x) = p(x) - q(x) = (f(x) - q(x)) - (f(x) - p(x)) = o((x - x_0)^n)$.
            Получается, $r(x) = o((x - x_0)^n)$, но так как $\deg r \le n$, то $r(x) = 0$.

            (Вот почему: пусть $r(x) = a_j(x - x_0)^j + \dots + a_n(x - x_0)^n = o((x - x_0)^n)$, где $a_j \ne 0$ --- первый ненулевой коэффициент. Тогда $a_j + (x - x_0)(a_{j + 1} + \dots + a_n(x - x_0)^{n - j}) \underset{x \to x_0}\Map a_j \ne o((x - x_0)^{n - j})$).
        }
    }
    \theorem[Локальная формула Тейлора]{
        Пусть $f: (a, b) \map \R$ дифференцируема на $(a, b)$ хотя бы $n - 1$ раз; пусть $f, f^{(1)}, \dots, f^{(n - 1)}$ непрерывны на $(a, b)$.

        Рассмотрим $x_0 \in (a, b)$ и предположим, что $\exists f^{(n)}(x_0)$.

        В таком случае существует единственный многочлен Тейлора порядка $n$ для $f$ в точке $x_0$, причём
        \[p(x) = \sum\limits_{j = 0}^{n}\frac{f^{(j)}(x_0)}{j!}(x - x_0)^j\]

        \note{
            Так как $f^{(k)}$ дифференцируема на $(a, b)$, то она там непрерывна; таким образом, условие непрерывности в теореме имеет смысл только для $f^{(n - 1)}$.
        }
        \prove{
            Рассмотрим $r(x) = f(x) - p(x)$.
            Заметим, что $r^{(j)}(x_0) = 0$ для $j = 0, \dots, n$.

            \indentlemma{
                Пусть $r: (a, b) \map \R$ --- произвольная функция; $x_0 \in (a, b)$.

                Предположим, что у $r$ есть $n - 1$ производная на $(a, b)$, а также $\exists r{(n)}(x_0)$, причём $r(x_0) = r'(x_0) = \dots = r^{(n)}(x_0) = 0$.

                Тогда $r(x) = o((x - x_0)^n)$.
            }{
                Индукция по $n$.

                \underline{База:} $n = 1$: $r(x_0) = 0; \exists r'(x_0) = 0$.

                По определению $r(x) - r(x_0) = r'(x_0)\cdot (x - x_0) + p(x-x_0)$, тем самым, $r(x) = o(x - x_0)$.

                \underline{Переход:} докажем для $n + 1$.

                Применим формулу Лагранжа: $r(x) = r(x) - r(x_0) = r'(c)(x - x_0)$, где $c$ --- строго между $x$ и $x_0$.

                $r'$ удовлетворяет условию леммы с индексом $n$, получается, $r'(x) = o((x - x_0)^n)$.

                \[\forall \eps > 0: \exists \delta > 0: |x - x_0| < \delta \then r'(x) < \eps \cdot |x - x_0|\]

                Тогда получается $r(x) = |r'(c)| \cdot |x - x_0| \le \eps \cdot |c - x_0|^n \cdot |x - x_0|^n \le \eps \cdot |x - x_0|^{n + 1}$.

            }
            Из леммы получаем, что $r(x) = o((x - x_0)^n)$, откуда в самом деле $p$ --- многочлен Тейлора для $f$.
        }
    }
    \example{
        $\lim\limits_{x \to 0}\frac{\sin(x) - x}{\cos(x) - 1} = ?$

        Заметим, что $\sin(x) = \sin(x)$, 0 в нуле; $\sin'(x) = \cos(x)$, 1 в нуле; $\sin''(x) = -\sin(x)$, 0 в нуле.

        Заметим, что $\cos(x) = \cos(x)$, 1 в нуле; $\cos'(x) = -\sin(x)$, 0 в нуле; $\cos''(x) = -\cos(x)$, -1 в нуле.

        Тогда $\dfrac{\sin(x) - x}{\cos(x) - 1} = \dfrac{(x + o(x^2)) -x}{(1 - \frac{x^2}2 + o(x^2)) - 1} = \dfrac{o(x^2)}{-\frac{x^2}2 + o(x^2)} \underset{x \to x_0}\Map 0$.
    }
    \ok
    Итак, вот локальная формула Тейлора:
    \[f(x) = \sum\limits_{j = 0}^{n}\frac{f^{(j)}(x_0)}{j!}(x - x_0)^j + o((x - x_0)^n)\]
    где $o((x - x_0)^n)$ --- остаточный член в форме Пеано.

    \theorem{
        Пусть $f$ имеет $n$ непрерывных производных на $(a, b)$, причём даже $\exists f^{(n + 1)}$ на $(a, b)$.

        Тогда \[\forall x \ne x_0 \in (a, b): \sum\limits_{j = 0}^{n}\frac{f^{(j)}(x_0)}{j!}(x - x_0)^j + \frac{f^{(n+1)}(\xi)}{(n+1)!}(x - x_0)^{n+1}\]
        где $\xi$ --- какая-то точка строго между $x$ и $x_0$.

        Здесь $\frac{f^{(n+1)}(\xi)}{(n+1)!}(x - x_0)^{n+1}$ --- остаток в форме Лагранжа.
        \note{
            Можно не требовать непрерывность ни одной производной, так как мы знаем про существование следующих.
        }
        \prove{
            Обозначим $r(x) = f(x) - p(x)$.
            \indentlemma{
                Пусть $r$ дифференцируема $n + 1$ раз на $(a, b)$; пусть $r(x_0) = r'(x_0) = \dots = r^{(n)}(x_0) = 0$.

                Тогда $\forall x \ne x_0: \exists \xi$ строго между $x$ и $x_0$, такая, что $r(x) = \frac{r^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}$.
            }{
                Индукция по $n$.

                \underline{База:} $n = 0$.

                В таком случае $r(x) = r(x) - r(x_0) = r'(\xi)\cdot (x - x_0)$ --- просто формула Лагранжа.

                \underline{Переход:} докажем для $n + 1$.

                Рассмотрим $f(x) = r(x)$ и $g(x) = (x - x_0)^{n + 2}$; $g'(x) = (n + 2)(x - x_0)^{n + 1}$, после чего применим формулу Коши:

                $\dfrac{r(x)}{(x - x_0)^{n + 2}} = \dfrac{r'(c)}{(n + 2)(c - x_0)^{n + 1}}$, где $c$ строго между $x$ и $x_0$.

                Теперь воспользуемся индукционным предположением для $r'$:
                \begin{gather*}
                    r'(c) = \frac{r^{(n + 2)}(\xi)}{(n + 1)!}(c - x_0)^{n + 1}\\
                    r(x) = (x - x_0)^{n + 2} \cdot \frac{1}{(n + 2)!} \cdot \frac{r^{(n + 2)}(\xi)}{(c - x_0)^{n + 1}}(c - x_0)^{n + 1} = \frac{r^{(n + 2)}(\xi)}{(n + 2)!}(x - x_0)^{n + 2}
                \end{gather*}
            }
            Используя тот факт, что $r^{(n + 1)}(x) = f^{(n + 1)}(x)$, так как $p$ --- многочлен степени не больше $n$, получаем искомое равенство.
        }
    }
    \newlection{28 ноября 2022 г.}
    Давайте посчитаем $\sqrt[3]{9}$.
    \indent{Для этого воспользуемся рядом Тейлора, нам придётся дифференцировать $x^r,$ где $r \in \Q$.

    Пусть $r = \frac{p}{q}; p, q\in\N$. Выразим $\left(x^{\frac1q}\right)' = \dfrac{1}{q\left(x^{\frac1q}\right)^{q - 1}}$, как производную обратной функции.

    Упростив, получаем $\left(x^{\frac1q}\right)' = \frac{1}qx^{\frac1q - 1}$.
    Теперь можно заметить, что $x^{\frac{p}{q}} = \left(x^\frac{1}{q}\right)^p$, откуда $\left(x^{\frac{p}{q}}\right)' = p\left(x^\frac{1}{q}\right)^{p - 1} \cdot \frac{1}{q}x^{\frac{1}{q}-1} = \frac{p}{q}x^{\frac{p - 1}{q} + \frac{1 - q}{q}} = \frac{p}{q}x^{\frac{p}{q}-1}$, откуда мы видим, что формула $(x^r)' = r x^{r - 1}$ применима не только к целым, но и к рациональным степеням.
    }
    Представим $\sqrt[3]{9} = (8 + 1)^{\frac13}$ --- найдём рядом точный куб $2^3 = 8$.
    Записав ряд Тейлора с остаточным членом в форме Лагранжа, получаем для $f(x) = x^{\frac13}$:
    \[f(x) = f(x_0) + f'(x_0)(x -x_0) + \frac12f^{(2)}(\xi)(x - x_0)^2 = x_0^{\frac13} + \frac{1}{3}x_0^{-\frac23}(x - x_0) + \frac{2}{9 \cdot 2}(\xi)^{-\frac53}(x - x_0)^2\]
    где $\xi \in (x_0, x)$.
    Подставим $x = 9, x_0 = 8$
    \[2 + \frac{1}{3 \cdot 4} - \frac{1}{9}\xi^{-\frac53}\]
    Пока $\xi$ меняется от $8$ до $9$, член $\xi^{-\frac53}$ меняется очень мало: очевидно, $\xi^{-\frac53}$ монотонно по $\xi$, причём
    \[8^{-\frac53} - 9^{-\frac53} = \dfrac{9^{\frac53} - 8^{\frac53}}{(8 \cdot 9)^{\frac53}} = \dfrac{9^2 - 8^2}{9^{\frac13} + (9 \cdot 8)^{\frac16} + 8^{\frac{1}{3}}}\cdot\dfrac{1}{(8 \cdot 9)^{\frac53}} \le \dfrac{17}{6} \cdot \dfrac{1}{1024} \le 0,003\]
    то есть ошибка при вычислении точного значения $\sqrt[3]{9}$ при помощи ряда Тейлора порядка всего 2 уже очень мала.


    \chapter{Первообразная}
    Пусть дана функция $f: \langle a, b \rangle \map \R$.
    \definition[Первообразная $f$ на $\langle a, b \rangle$]{
        Такая функция $F: \langle a, b \rangle \map \R$, дифференцируемая на $\langle a, b \rangle$, такая, что $F'(x) = f(x)$ для $x \in \langle a, b \rangle$.
    }
    \note{
        Как известно, у производной могут быть разрывы только первого рода~(\ref{about_gaps}), поэтому первообразной точно нет у функции, претерпевающей где-то разрыв первого рода.

        Так, нет первообразной у функции $f(x) = \sign(x)$ на $(-\infty; +\infty)$.
    }
    \fact{
        Если у функции $f$ есть две первообразные, $F_1$ и $F_2$, то $F_1 = F_2 + c$, где $c \in \R$.
        \provehere{
            Рассмотрим функцию $F = F_1 - F_2$. Её производная равна нулю~(\ref{zero_derivative}), значит, она постоянна.
        }
    }
    \corollary{Если $F_1$ --- первообразная, то множество всех первообразных --- как раз $\defset{F_1 + C}{C \in \R}$.}
    \theorem{
        У любой непрерывной функции есть первообразная.
        \provehere{Будет потом.}
    }


    \section{Про дифференциальные формы}

    Ниже написанное может казаться казуистикой, но оно будет полезно при работе с функциями от нескольких переменных.

    <<На самом деле>>, первообразные бывают не столько у функций, сколько у дифференциальных форм.

    \definition[Линейная функция]{ Функция вида $\phi(h) = a \cdot h,$ где $a \in \R$.}

    \definition[Дифференциальная форма] {Произвольное отображение \[\Phi: \langle l, r \rangle \map \{\text{линейные функции}\}\]}
    В качестве примера можно рассмотреть дифференциал~(\ref{differential_def}). \[\Phi: x \mapsto \d_f(x, h) = f'(x) \cdot h\]

    Более того, из определения видно, что всякая дифференциальная форма имеет вид $\Phi: x \mapsto a(x) \cdot h$, где уже $a: \langle l, r \rangle \map \R$ --- произвольная функция.

    Введём обозначение для дифференциала функции $f$, как линейной формы: $\d f = (\Phi: x \mapsto f'(x) \cdot h)$.

    Дифференциал линейной функции $f(x) = x$ --- линейная форма $\Phi: x \mapsto 1 \cdot h$;\ это линейная форма, в каждой точке которой сидит линейная функция с коэффициентом 1.
    Его можно также обозначить $\d x$.

    Вместо не очень хорошей записи $a(x) \cdot h$ (что такое в ней $h$?) будем записывать линейные формы так: $a\cdot \d x$.

    Теперь скажем, что функция $F$ --- первообразная дифференциальной формы $\Phi$, если $\d F = \Phi$.
    Это определение согласуется с ранее данным: пусть $\Phi = a \d x$, и $\d F = F' \d x$;\ мы ищем такую функцию $F$, что $F' = a$.

    Пусть $a(x)\d x$ --- дифференциальная форма на $\langle l, r \rangle$.
    Тогда следующим значком\[\int a(x) \d x\] обозначают множество всех первообразных данной линейной формы.


    \section{Первообразные элементарных функций}
    Так, $\int x^\alpha \d x = \frac{1}{\alpha + 1}x^{\alpha + 1} + C$ при $\alpha \in \Q \sm \{-1\}$.
    Можно ещё написать первообразные некоторых интересных функций, которые мы ещё не прошли:
    \bullets{
        \item $\int \sin x \d x = -\cos x + C$.
        \item $e^x \d x = e^x + C$.
        \item $x^{-1}\d x = \log x + C$.
    }


    \section{Сложный дифференциал}
    Давайте напишем дифференциал композиции. \[(f \circ g)'(x) = f'(g(x)) g'(x)\] поэтому \[\d(f \circ g) = f'(g(x))g'(x)\d x\]
    Здесь $x$ после дифференциала $\d x$, и $x$ внутри скобок от вызова функций --- разные сущности: внутри скобок --- точка, в которой мы вычисляем значение, чтобы узнать, чему равна производная;\ после значка $\d$ это --- название линейной функции с коэффициентом $1$.
    Правильнее было бы написать $\d(f \circ g) = f'(g(\,\cdot\,)) g'(\,\cdot\,)\d x$.
    Если заметить, что $g'(\,\cdot\,)\d x = \d g$, то получим $\d(f \circ g) = (f' \circ g) \d g$.

    Отсюда $\int (f' \circ g) \d g = \int (f \circ g) \d x$.

    Теперь, например, можно посчитать ${\int x \sin(x^2) \d x = \int \sin(x^2) \d\left(\frac{x^2}2\right) = \frac{1}{2}\int \sin\left(x^2\right)\d x^2 = -\frac{1}{2}\cos(x^2) + C}$

    По просьбам трудящихся, на лекции ещё посчитали

    \[\int \tg(x) \d x = \int \frac{\sin(x)}{\cos(x)}\d x = -\int \frac{\d \cos x}{\cos x} \underset{y = \cos x}{=} -\int \frac{\d y}{y} = -\log(y) + C = -\log(\cos x) + C\]
    (написанное выше --- например, интеграл на $\left(-\frac{\pi}2; +\frac{\pi}2\right)$, но нельзя сказать, что это интеграл на $(-\infty; +\infty)$ --- интегрируемая функция не везде определена).


    \section{Интегрирование по частям}
    Так как $(f \cdot g)' = f' \cdot g + f \cdot g'$, то $\d(f \cdot g) = g \cdot \d f + f \cdot \d g$.

    Формула интегрирования по частям: $\int f \d g =fg - \int g \d f$.

    Применим её для $\int \log x \d x$:
    \[\int \log x\cdot \d x = x \log x - \int x\cdot \d(\log x) = x\log x - \int x\frac{1}x\d x = x\log x - x + C\]

    Или вот ещё пример: $\int \sin x \cdot e^x \d x$. \[\int \sin x\cdot d e^x = e^x \sin x - \int \cos x \cdot e^x \d x = e^x \sin x - \int \cos x \cdot\d e^x = e^x \sin x - e^x \cos x - \int \sin x \cdot e^x \d x\]

    Интеграл пришёл сам в себя, получается, $\int e^x\sin x \d x + \int e^x\sin x \d x = e^x\sin x - e^x\cos x$ (сумма по Минковскому), или же $ \int e^x\sin x \d x = \frac12(e^x\sin x - e^x\cos x) + C$.
    \note{
        На самом деле, мы получили, что \textit{если интеграл существует}, то он равен этому выражению.

        Чтобы показать, что он существует, можно либо сослаться на теорему о том, что первообразная у непрерывной функции существует, либо просто проверить --- продифференцировав полученное выражение обратно.
    }
    \ok
    Иногда бывает, что в интеграле $\int f(x) \d x$ под дифференциал ничего загнать не получается.

    Бывает полезно рассмотреть $y = \phi(x)$.
    Тогда получается, что $\d y = \phi'(x) \d x$, откуда $\d x = \frac{1}{\phi'(x)}\d y$.

    После этого \[\int f(x) \d x = \int f(\phi^{-1}(y))\frac{1}{\phi'(\phi^{-1}(y))}\d y\]
    \newlection{2 декабря 2022 г.}
    Посчитаем ещё один интеграл:
    \[\int \sqrt{1 - x^2} \d x \text{, при } -1 \le x \le 1\]
    Попробуем замену $x = \sin t$, при $t \in [-\frac{\pi}2; \frac{\pi}2]$.

    \[\int \sqrt{1 - x^2}\cdot \d x = \sqrt{1 - \sin^2 t}\cdot  \d \sin t = \]
    Корень равен $\cos t$, потому что при данных $t:$ $\cos t \ge 0$.
    \[= \int \cos^2 t\cdot  \d t = \int \frac{\cos(2t) + 1}2 \d t = \frac{1}{4}\int \cos(2t)\d (2t) + \frac{1}{2}\int \d t = \frac{1}{4}\sin(2t) + \frac{1}{2}t + C\]


    \chapter{Интеграл}
    На самом деле, то, что мы выше называли интегралом (даже значок рисовали) --- первообразная.

    Само слово интеграл --- это о каком-то суммировании потока входящих и исходящих средств, вопрос --- сколько в итоге получилось?

    \definition[Функционал]{Отображение: $\Phi: X \map \R$, где $X$ --- множество любой природы.}

    Пусть $f: A \map \R$, отрезок $I \subset A$.
    Определим интеграл $J(f, I)$.
    Он по возможности должен удовлетворять следующим свойствам:
    \numbers{
        \item $J(f, I_1 \sqcup I_2) = J(f, I_1) + J(f, I_2)$ --- если что-то набралось сначала на одном отрезке, потом на другом, то в результате получилась сумма.
        \item $J(\alpha f_1 + \beta f_2, I) = \alpha J(f_1, I) + \beta J(f_2, I)$ --- если есть какая-то платформа, которая едет с одной скоростью, а на ней что-то едет с другой скоростью, то оно сложится в таком виде.
        \item $J(1, [a, b]) = b - a$ --- если что-то набирается со скоростью 1, то и наберётся столько, в течение какого времени набиралось.
        \item $f \ge 0 \then J(f, I) \ge 0$ --- если вода наливалась, то в итоге она налилась. В силу линейности получаем отсюда $J(f, I) \ge J(g, I)$, если во всех точках $f(x) \ge g(x)$.
    }


    \section{Интеграл Римана-Дарбу}

    \subsection{Интуиция}
    Пусть $f: I \map \R$.
    Разобьём отрезок на более маленькие части, необязательно равные: $I = \bigsqcup\limits_i I_i$.

    На всяком отрезке возьмём инфимум (для этого потребуем от функции ограниченности), получим ступенчатую (кусочно постоянную) функцию $g: I \map \R; \quad x \mapsto \all{\inf I_1,& x \in I_1 \\ \vdots \\\inf I_i,& x \in I_i\\ \vdots}$.
    Иначе говоря, $g = \sum\limits_{k}c_k\cdot \chi_{I_k}$.

    Отсюда видим вывод: \[J(f, I) \ge J(g, I) = \sum\limits_{i}c_k |I_k|\]

    Аналогично, определим $h = \sum\limits_{k}d_k \chi_{I_k}$, где $d_k = \sup\limits_{x \in I_k}f(x)$.

    Таким образом, как бы мы не разбивали отрезок, будет наблюдаться неравенство
    \[J(g, I) \le J(f, I) \le J(h, I)\]
    Если же мы разобьём $I$ на достаточно малые кусочки, то можно надеяться, что суммы $J(g, I)$ и $J(h, I)$ будут близки.

    \subsection{Определение}
    Пусть $I = \langle a, b \rangle$, где $a, b \in \R$.

    Рассмотрим ограниченную функцию $f: I \map \R$.

    \definition[Разбиение отрезка]{
        Совокупность отрезков $I_1, \dots, I_n: I = \bigsqcup\limits_{i = 1}^{n} I_i$, где $n \in \N$.
        Отрезкам не запрещено быть пустыми, или вырождаться в точку.
    }
    \definition[Измельчение разбиения]{Разбиение $\Delta_1, \dots, \Delta_k$ --- измельчение разбиения $I_1, \dots, I_n$, если $\forall \Delta_s: \exists I_t: \Delta_s \subset I_t$.}

    \lemma{
        У любых двух разбиений есть общее измельчение.
        \provehere{
            Рассмотрим два разбиения $I = \bigsqcup\limits_{k = 1}^{N}I'_k$ и $I = \bigsqcup\limits_{j = 1}^{T}I''_j$.

            Тогда (так как пересечение двух отрезков --- отрезок) семейство $\{I_k'\cap I_j''\}_{k = 1..N, j = 1..T}$ является их общим измельчением.
        }
    }
    Рассмотрим некое $\mathcal{A}$ --- разбиение отрезка $I$.
    Теперь будем считать, что $\o \notin \mathcal{A}$.

    \singlepage{\definition[Сумма Дарбу по разбиению $\mathcal{A}$]{\down
    \bullets{
        \item Верхняя: $S_{\mathcal{A}}(f) \bydef \sum\limits_{I \in \mathcal{A}} \left(\sup\limits_{x \in I}f(x)\right) \cdot |I|$.
        \item Нижняя: $s_{\mathcal{A}}(f) \bydef \sum\limits_{I \in \mathcal{A}} \left(\inf\limits_{x \in I}f(x)\right) \cdot |I|$.
    }
    }}
    Из определения очевидно, что $s_{\mathcal{A}}(f) \le S_{\mathcal{A}}(f)$
    \lemma{
        Для любых двух разбиений $\mathcal{A}$ и $\mathcal{B}$ выполняется неравенство $s_{\mathcal{A}}(f) \le S_{\mathcal{B}}(f)$.
%        \note{
%        После доказательства этого факта заметим, что все нижние и верхние суммы образуют щель.
%        }
        \provehere{ Рассмотрим их общее измельчение $\mathcal{C}$.
        \indentlemma{
            Если $\mathcal{D}$ и $\mathcal{E}$ --- два разбиения, причём $\mathcal{E}$ --- измельчение разбиения $\mathcal{D}$, то \[s_{\mathcal{D}}(f) \le s_{\mathcal{E}}(f) \le S_{\mathcal{E}}(f) \le S_{\mathcal{D}}(f)\]
        }{
            \[S_{\mathcal{D}}(f) = \sum\limits_{I_i \in \mathcal{D}}\left(\sup\limits_{s \in I_i}f(x)\right)\cdot |I|\]
            Рассмотрим одно слагаемое: \[\left(\sup\limits_{s \in I_i}f(x)\right)\cdot |I| = \sum\limits_{\Delta_k \subset I_i}\sup\limits_{x \in I_j} f(x)\]
            Очевидно, если брать супремум не по $I_i$, а по $\Delta_k \subset I$, то получится только меньше.
            \[\left(\sup\limits_{s \in I_i}f(x)\right)\cdot |I| \ge \sum\limits_{\Delta_k \subset I_i}\sup\limits_{x \in \Delta_k} f(x)\]

            Чтобы доказать для нижних сумм Дарбу, можно заменить $f$ на $-f$.
        }
        Таким образом, $S_{\mathcal{A}}(f) \ge S_{\mathcal{C}}(f) \ge s_{\mathcal{C}}(f) \ge s_{\mathcal{B}}(f)$.
        }
    }
    \corollary{
        Пусть $U$ --- множество всех верхних сумм для $f$, а $V$ --- множество всех нижних сумм.

        Согласно лемме, $(V, U)$ --- щель. Положим $\overline{I}(f) \coloneqq \inf U$ и $\underline{I}(f) \coloneqq \sup V$.
        Получается, в щели лежат числа $[\underline{I}(f); \overline{I}(f)]$.
    }
    \definition[Верхний интеграл Дарбу от $f$ по $I$]{Выше определённая $\overline{I}(f)$.}
    \definition[Нижний интеграл Дарбу от $f$ по $I$]{Выше определённая $\underline{I}(f)$.}
    \definition[Интеграл Дарбу от $f$ по $I$]{Если $\underline{I}(f) = \overline{I}(f)$, то это число --- \textit{интеграл} функции $f$ на отрезке $\langle a, b \rangle$ (обозначают $I(f)$), а функция --- интегрируема по Риману-Дарбу на $[a, b]$.}
    \examples{
        \item Функция Дирихле $D = \chi_\Q$ не интегрируема по Риману-Дарбу на $[0; 1]$: на всяком отрезке её супремум 1, а инфимум --- 0.
        \item Пусть $\Delta \subset I$. Найдём интеграл от $f = \chi_\Delta$.

        Рассмотрим разбиение $\{J_1, \Delta, J_2\}$, где $J_1$ и $J_2$ --- левая и правая половинки $I \sm \Delta$.

        В нём верхние и нижние суммы Дарбу совпали, поэтому можно утверждать, что в щели точно лежит одно число --- $|\Delta|$.
    }
    \fact{
        Если $f \le g$ на $\langle a, b \rangle$, то $I(f) \le I(g)$, так как $\overline{I}(f) \le \overline{I}(g)$.
    }
    \ok

    Представим себе $f(x) = \frac{1}{x}$ на $(0, 1]$.
    Она там непрерывна;\ для всякого $x_0 \in (0; 1]: \forall \eps > 0: \exists \delta: \forall x  \in (0; 1]: |x - x_0| \then \left|\frac{1}{x} - \frac{1}{x_0}\right| < \eps$.
    Несложно видеть, что у данной функции $\delta$ хотя и существует, но зависит не только от $\eps$, но ещё и от $x_0$.

    \definition[Равномерно непрерывная функция]{Такая функция $f: A \map \R$, что
        \[\forall \eps > 0: \exists \delta > 0: \forall x_0, x \in A: |x - x_0| < \delta \then |f(x) - f(x_0)| < \eps\]
    }
    \newlection{5 декабря 2022 г.}


    \section{Достаточный признак интегрируемости}
    \theorem[Кантор]{\label{Cantor_about_homogenous_contiguosity}
    Пусть $E$ --- замкнутое ограниченное множество, а $f: E \map \R$ --- непрерывная функция.
    Тогда эта функция автоматически равномерно непрерывна.
    \provehere{
        От противного: пусть $\exists \eps > 0: \forall \delta > 0: \exists x, y \in E : |x - y| < \delta$, но $|f(x) - f(y)| \ge \eps$.
        Зафиксируем такой $\eps$;\ рассмотрим последовательность  $\delta_n = \frac{1}{n}$, сопоставим всякому соответствующие $x, y \in E$.

        Согласно второй теореме о компактности~(\ref{segment_compactivity_2}) существует возрастающая последовательность индексов $n_j: x_{n_j} \underset{j \to \infty}\Map x \in E$.
        Используя $|x_n - y_n| \underset{n \to \infty}\Map 0$, получаем, что $y_{n_j} \underset{j \to \infty}\Map x$.

        Подставим посылку теоремы: $\forall n \in \N: |f(x_{n_j}) - f(y_{n_j})| \ge \eps$.
        Но такого не может быть, $f(x_{n_j}) \underset{j \to \infty}\Map f(x)$, и $f(y_{n_j}) \underset{j \to \infty}\Map f(x)$.
    }
    }
    \theorem{
        На замкнутом отрезке $[a, b]$ все непрерывные функции интегрируемы по Риману.
        \provehere{
            Рассмотрим какую-нибудь непрерывную $f: [a, b] \map \R$.
            Согласно теореме Кантора~(\ref{Cantor_about_homogenous_contiguosity}), она равномерно непрерывна:
            \[\forall \eps > 0: \exists \delta(\eps) > 0: \forall x, y \in [a, b]: |x - y| < \delta(\eps) \then |f(x) - f(y)| < \eps\]

            Рассмотрим $J = \langle l, r \rangle \subset [a, b]$ --- некий отрезок. Если $|J| < \delta(\eps)$, то $\osc_J f \le \eps$.
            \[\osc_J f = \sup\limits_{x, y \in J}|f(x) -f(y)| = \sup\limits_{x \in J} f(x) - \inf\limits_{y \in J}f(y) \le \eps\]
            Пусть $\mathcal{E}$ --- произвольное разбиение отрезка $I$ на отрезки длины меньше $\delta$.
            Посчитаем на нём суммы Дарбу:
            \begin{gather*}
                S_{\mathcal{E}} = \sum\limits_{e \in \mathcal{E}} (\sup_e f) \cdot |e| \\
                s_{\mathcal{E}} = \sum\limits_{e \in \mathcal{E}} (\inf_e f) \cdot |e|
            \end{gather*}
            Вычислим разности сумм $S_{\mathcal{E}} - s_{\mathcal{E}} \le \sum\limits_{e \in \mathcal{E}}\eps \cdot |e| = \eps \cdot |b - a|$.

            Получается, $\forall \eps > 0: $ найдётся разбиение $\mathcal{E}$, такое, что $S_{\mathcal{E}} - s_{\mathcal{E}} \le \eps \cdot |b - a|$.
            Так как $|b - a|$ --- константа, то отсюда сразу вытекает, что множества нижних и верхних сумм Дарбу образуют \textit{узкую} щель.
        }
    }
    \problem[Упражнение]{
        Интегрируема ли по Риману-Дарбу функция Римана $R$~(\ref{Riemann_function_def})?
        \numbers{
            \item $R$ непрерывна во всех иррациональных точках; разрывна во всех рациональных точках.
            \item $R$ интегрируема по Риману-Дарбу на любом конечном отрезке.
        }
    }


    \section{Свойства интеграла по Риману-Дарбу}
    \numbers{
        \item Монотонность.
        Пусть $f, g: \Delta \map \R$.
        Если $\forall x \in \Delta: f(x) < g(x)$, то $\overline{I}(f) \le \overline{I}(g)$ и $\underline{I}(f) \le \underline{I}(g)$.
        \provehere{
            Рассмотрим произвольное $\mathcal{E}$ --- разбиение отрезка $\Delta$.
            \begin{gather*}
                S_{\mathcal{E}}(f) = \sum\limits_{e \in \mathcal{E}}(\sup_e f) \cdot |e| \le \sum\limits_{e \in \mathcal{E}}(\sup_e g) \cdot |e| = S_{\mathcal{E}}(g)\\
                s_{\mathcal{E}}(f) = \sum\limits_{e \in \mathcal{E}}(\inf_e f) \cdot |e| \le \sum\limits_{e \in \mathcal{E}}(\inf_e g) \cdot |e| = s_{\mathcal{E}}(g)\qedhere
            \end{gather*}
        }
        \corollary{
            Если $f$ и $g$ интегрируемы, то $I(f) \le I(g)$.
        }
        \item Согласованность с домножением на константу.
        Пусть $f: \Delta \map \R$ ограничена, $\alpha \ge 0$, $\mathcal{E}$ --- разбиение $\Delta$.
        Тогда $S_{\mathcal{E}}(\alpha f) = \alpha S_{\mathcal{E}}(f)$ и $s_{\mathcal{E}}(\alpha f) = \alpha s_{\mathcal{E}}(f)$.
        \corollary{$\overline{I}(\alpha f) = \alpha \cdot \overline{I}(f)$ и $\underline{I}(\alpha f) = \alpha \cdot \underline{I}(f)$.}
        \corollary{Если $f$ интегрируема, то $\exists I(\alpha f) = \alpha I(f)$.}
        \item Сумма. Согласованность с домножением на -1.
        Пусть $f: \Delta \map \R$ ограничена, $\alpha \ge 0$, $\mathcal{E}$ --- разбиение $\Delta$.
        Тогда $S_{\mathcal{E}}(-f) = -s_{\mathcal{E}}(f)$ и $s_{\mathcal{E}}(-f) = -S_{\mathcal{E}}(f)$.
        \corollary{$\overline{I}(-f) = -\underline{I}(f)$ и $\underline{I}(-f) = -\overline{I}(f)$.}
        \corollary{Если $f$ интегрируема, то $\exists I(-f) = - I(f)$.}
        \corollary{Если $f$ интегрируема и $\alpha \in \R$, то $\exists I(\alpha f) = \alpha I(f)$.}
        \item Пусть $f, g: \Delta \map \R$. Тогда $\overline{I}(f + g) \le \overline{I}(f) + \overline{I}(g)$ и $\underline{I}(f + g) \le \underline{I}(f) + \underline{I}(g)$.
        \provehere{\[\overline{I}(f + g) \le S_{\mathcal{E}}(f + g) = \sum\limits_{e \in \mathcal{E}}\sup_e (f + g) \cdot |e| \le \sum\limits_{e \in \mathcal{E}}(\sup_e f \cdot |e| + \sup_e g \cdot |e|) = S_{\mathcal{E}}(f) + S_{\mathcal{E}}(g)\]
            Отсюда получаем, что $\forall \Fc_1, \Fc_2$ --- разбиений $\Delta$ --- выполняется $\overline{I}(f + g) \le S_{\Fc_1}(f) + S_{\Fc_2}(g)$ (для доказательства рассмотрим общее измельчение).

            Взяв в неравенстве инфимум сначала по всем $\Fc_1$, потом по всем $\Fc_2$, получим \[\overline{I}(f + g) \le \overline{I}(f) + \overline{I}(g)\]
            Отсюда \[\underline{I}(f + g) = -\overline{I}((-f) + (-g)) \ge -\overline{I}(-f) - \overline{I}(-g) = \underline{I}(f) + \underline{I}(g)\qedhere\]}
        \corollary{Если $f, g$ интегрируемы на $\Delta$, то $f + g$ тоже интегрируема, причём $I(f + g) = I(f) + I(g)$.}
    }


    \section{Критерий интегрируемости по Риману-Дарбу}
    \theorem[Критерий интегрируемости по Риману-Дарбу]{
        Следующие условия эквивалентны:
        \numbers{
            \item Ограниченная функция $f$ на отрезке $\Delta$ интегрируема на нём по Риману-Дарбу.
            \item $\forall \eps > 0: \exists \mathcal{E}$ --- разбиение $\Delta$, такое, что $\sum\limits_{e \in \mathcal{E}}(\osc_{e} f) \cdot |e| < \eps$.
        }
        \provewthen{
            \[\eps > \sum\limits_{e \in \mathcal{E}}(\osc_{e} f) \cdot |e| = S_{\mathcal{E}}(f) - s_{\mathcal{E}}(f)\]
            Значит, щель узкая, и интеграл существует.
        }{
            Щель узкая, значит, $\exists \Fc_1, \Fc_2$ --- разбиения $\Delta$, такие, что $S_{\Fc_1} - s_{\Fc_2} < \eps$.
            Тогда берём $\mathcal{E}$ --- общее измельчение $\Fc_1$ и $\Fc_2$.
            По-прежнему, $S_{\mathcal{E}} - s_{\mathcal{E}} < \eps$, получается, $\mathcal{E}$ --- искомое разбиение для данного $\eps$.
        }
    }
    \proposal[Основная оценка интеграла]{
        Если $f: A \map \R$ интегрируема на отрезке $\Delta$, то $|f|$ тоже интегрируема, и $|I(f)| \le I(|f|)$.
        \provehere{
            Заметим, что \[\forall J \subset A: \osc_J |f| = \sup\limits_{x, y \in J}\Big||f(a)| - |f(b)|\Big| \le \sup\limits_{x, y \in J}\Big|f(a) - f(b)\Big| = \osc_J f\]

            Теперь просто применим критерий: $f$ интегрируема, значит, $\forall \eps > 0: \exists \mathcal{E}$ --- разбиение $\Delta$, такое, что $\sum\limits_{e \in \mathcal{E}}(\osc_e f) \cdot |e|$, откуда $\sum\limits_{e \in \mathcal{E}}(\osc_e |f|) \cdot |e|$ и подавно.
        }
    }
    \counterexample{
        Обратное неверно: функция $d = D - \frac{1}{2}$ --- сдвинутая функция Дирихле --- интегрируема только под модулем.
    }
    \newlection{9 декабря 2022 г.}
    \proposal{
        Если $f, g: \langle a, b \rangle \map \R$ --- интегрируемы по Риману-Дарбу, то $f \cdot g$ тоже интегрируема.
        \provehere{
            По определению, $f$ и $g$ --- ограничены, пусть константой $M$.

            Рассмотрим $e \subset \langle a, b \rangle$, оценим $\osc_e(f \cdot g)$.
            \[x, y \in e: \quad |f(x)g(x) - f(y)g(y)| = |f(x)(g(x) - g(y)) + (f(x) - f(y))g(y)| \le M \cdot osc_e g + M \cdot \osc_e f\]
            Отсюда вытекает $\osc_e(f \cdot g) \le M(\osc_e f + \osc_e g)$.

            Рассмотрим произвольный $\eps > 0$, найдём разбиение отрезка $\langle a, b \rangle$, такое, что
            \begin{gather*}
                \sum\limits_{e \in \mathcal{A}}\osc_e f \cdot |e| \le \frac{\eps}{2M} \\
                \sum\limits_{e \in \mathcal{A}}\osc_e g \cdot |e| \le \frac{\eps}{2M}
            \end{gather*}
            Они найдётся согласно критерию интегрируемости (чтобы $\mathcal{A}$ было общее, рассмотрим измельчение).

            Тогда для $f \cdot g$ на разбиении $\mathcal{A}$ сумма колебаний не превосходит $\eps$, выполняется критерий.
        }
    }
    \corollary{
        Пусть $\Delta = \langle a, b \rangle; J = \langle \alpha, \beta \rangle; J \subset \Delta$.
        Пусть $f: \Delta \map \R$ интегрируема по Риману-Дарбу.
        Тогда, используя, что $\chi_J: \Delta \map \R$ тоже интегрируема, несложно получить, что $f\Big|_J$ --- тоже интегрируема.
    }
    Обозначим получившийся интеграл на подотрезке $\int\limits_J f = \int\limits_\alpha^\beta f = \int\limits_\alpha^\beta f(x) \d x \bydef I(f \cdot \chi_J)$.

    \ok

    Пусть $J = J_1 \sqcup J_2$, где $J, J_1, J_2$ --- отрезки.
    Заметим, что
    \[\int\limits_J f = I(f \cdot \chi_J) = I(f \cdot \chi_{J_1} + f \cdot \chi(J_2)) = I(f \cdot \chi_{J_1}) + I(f \cdot \chi(J_2)) = \int\limits_{J_1}f + \int\limits_{J_2}f\]

    \subsubsection{Куда относить концы?}
    $J = \o \then \chi_J = 0 \then \int\limits_J f = 0$.
    $J = \{a\} \then \int\limits_J f = 0$ тоже: $I(f \cdot \chi_{\{a\}}) = f(a) \cdot \underbrace{I(\chi_{\{a\}})}_{=0} = 0$.

    Отсюда сразу следует, что запись $\int\limits_\alpha^\beta f \bydef I_J f$ для $J = \langle \alpha, \beta \rangle$ корректна --- нам не важно, включаются ли конца отрезка $J$.

    В частности, получаем, что $\int\limits_\alpha^\gamma f(x) \d x = \int\limits_\alpha^\beta f(x) \d x + \int\limits_\beta^\gamma f(x) \d x$ для $\alpha \le \beta \le \gamma$.

    \ok

    Основная оценка интеграла: $\left|\int\limits_\alpha^\beta f(x) \d x\right| \le \int\limits_\alpha^\beta |f(x)| \d x$.
    \corollary{
        Если $|f(x)| \le M$ на $(\alpha, \beta)$, то $\left|\int\limits_\alpha^\beta f(x) \d x\right| \le M \cdot (\beta - \alpha)$.
    }
    \definition{Если $\beta < \alpha$, то $\int\limits_\alpha^\beta f(x) \d x \bydef -\int\limits_\beta^\alpha f(x) \d x$.}
    При таком определении $\int\limits_\alpha^\gamma f(x) \d x = \int\limits_\alpha^\beta f(x) \d x + \int\limits_\beta^\gamma f(x) \d x$ при любом относительном порядке $\alpha, \beta, \gamma$.

    Основная оценка интегрирования тоже остаётся верной: $\left|\int\limits_\alpha^\beta f(x) \d x\right| \le \int\limits_\alpha^\beta |f(x)| \d x \le M \cdot |\alpha - \beta|$.


    \section{Связь между интегралом и первообразной}
    Пусть $I = \langle \alpha, \beta \rangle$ --- отрезок, возможно, бесконечной длины.

    Рассмотрим $f: \langle \alpha, \beta \rangle \map \R$, такую, что для всякого замкнутого отрезка $\Delta \subset I$ функция интегрируема на $\Delta$.

    Пусть $t_0 \in \langle \alpha, \beta \rangle$.
    Обозначим $F: \langle \alpha, \beta \rangle; \quad F(t) = \int\limits_{t_0}^{t}f(x) \d x$.

    Пусть $\Delta \ni t_0$ --- замкнутый отрезок ($\Delta \subset \langle \alpha, \beta \rangle$).
    На нём функция интегрируема, ограничена константой $M$.

    Заметим, что $\forall t_1, t_2 \in \langle \alpha, \beta \rangle$:
    \[F(t_1) - F(t_2) = \left|\int\limits_{t_1}^{t_2}f(x) \d x\right| \le |t_1 - t_2| \cdot M\]

    Получается, $F$ непрерывна на $\Delta$, но так как $\Delta$ можно взять сколь угодно большим, т вообще говоря, $F$ непрерывна даже на $\langle \alpha, \beta\rangle$.

    Однако на любом замкнутом отрезке $F$ равномерно непрерывна: $F(t_1) - F(t_2) \le |t_1 - t_2| \cdot M$.
    Из формулы следует даже большее:

    \definition[Условие Липшица]{
        $h: e \map \R$ удовлетворяет условию Липшица, если $\exists A > 0: \forall t_1, t_2: |h(t_1) = h(t_2)| \le A|t_1 - t_2|$.
    }

    \subsection{Теорема Ньютона-Лейбница}
    \theorem[Ньютон-Лейбниц]{
        Пусть $f: \langle \alpha, \beta \rangle$ непрерывна на отрезке $\langle \alpha, \beta \rangle$, причём $t_0 \in \langle\alpha, \beta\rangle$.

        Тогда функция $F(t) = \int\limits_{t_0}^{t_1}f(x) \d x$, которую мы только что рассматривали, есть первообразная для $f$.

        \provehere{
            Докажем более сильное утверждение: пусть $f$ интегрируема на всяком замкнутом отрезке $\Delta \subset I$;\ тогда $F'(u)$ существует и равно $f(u)$ в каждой точке $u$, где $f$ непрерывна.

            Рассмотрим такое $u \in \langle \alpha, \beta \rangle$, где $f$ непрерывна.

            Рассмотрим $\eps > 0: \exists \delta > 0: \forall x \in I: |x - u| < \delta \then |f(x) -f(u)| \le \eps$.

            Посчитаем производную $\dfrac{F(x) - F(u)}{x - u}$ при $x \to u$.
            Так как мы хотим доказать, что это $f(u)$, то запишем
            \[\dfrac{F(t) - F(u)}{t - u} - f(u) = \dfrac{\int\limits_{u}^{t}f(x)\d x}{t - u} - f(u) = \frac{1}{t -u}\left(\int\limits_{u}^{t}f(x)\d x - \int\limits_{u}^{t}\underbrace{f(u)}_{\text{const}}\d x\right) = \frac{1}{t - u}\int\limits_{u}^{t}(f(x) - f(u))\d x\]
            Пусть $|t - u| \le \delta$, тогда $|x - u| \le \delta$, где $x$ --- под интегралом. Тогда $|f(x) - f(u)| \le \eps$ по непрерывности, и получаем
            \[\left|\dfrac{F(t) - F(u)}{t - u} - f(u)\right| \le \frac{1}{t - u}\cdot |t - u| \cdot \eps = \eps\]
            Тем самым, действительно, $\dfrac{F(t) - F(u)}{t - u} \underset{t \to u}\Map f(u)$.
        }
    }
    \corollary[Формула Ньютона-Лейбница]{
        Пусть $f$ непрерывна на $I = \langle\alpha, \beta\rangle$; пусть $\Phi$ --- произвольная первообразная $f$ на $\alpha, \beta$.

        Тогда $\forall a, b \in \langle \alpha, \beta \rangle: \int\limits_{a}^b f(x) \d x = \Phi(b) - \Phi(a)$.

        \provehere{
            Пусть $t_0 \in I$, функция $F(t) = \int\limits_{t_0}^t f(x) \d x$ является первообразной для $f$.

            Но тогда $\exists C \in \R: \Phi(t) = F(t) + C$. Отсюда получаем
            \[\Phi(b) - \Phi(a) = F(b) -F(a) = \int\limits_{t_0}^b f(x) \d x - \int\limits_{t_0}^a f(x) \d x = \int\limits_a^bf(x) \d x\qedhere\]
        }
    }
    \example{
        $\int\limits_0^1 x \d x = \frac{1^2}{2} - \frac{0^2}{2} = \frac{1}{2}$.
    }

    \subsection{Замена переменной под интегралом}
    $f(\phi(x))' = f'(\phi(x)) \cdot \phi'(x)$
    Предположим, что $f, \phi, f', \phi'$ непрерывны на своей области определения:

    $\phi: I \map \R$, причём $\Delta \supset\phi(I)$, и $f: \Delta \map \R$.

    Тем самым $f(\phi(x))$ --- первообразная для правой части.
    \[\int\limits_a^b f'(\phi(x))\phi'(x) \d x = f(\phi(b)) - f(\phi(a))\]
    С другой стороны, \[\int\limits_a^bf'(\phi(x))\phi'(x) \d x = f(v) - f(u) = \int\limits_u^v f'(s) \d s\]
    где $u = \phi(a)$, и $v = \phi(b)$.
    \newlection{10 декабря 2022 г.}
    skipped
    \newlection{12 декабря 2022 г.}
    % Сходимость последовательности функций --- поточеченая и равномерная.
    % Критерий Коши
    $f_n: A \map \R$ --- последовательность функций.
    Ряд $\sum\limits_{i = 1}^{n}f_n(x)$ сходится поточечно к функции $S: A \map \R$, если частичные суммы сходятся для каждого $x$ сходятся.

    Равномерно --- если частичные суммы сходятся к $S$ равномерно.

    \theorem[Критерий Вейерштрасса]{
        Пусть $d_n \in \R_{\ge 0}$, где $\sum\limits_{i = 1}^{\infty}d_i < \infty$.

        Если $\forall i \in \N: \forall x \in A: |f_n(x)| \le d_n$, то ряд $\sum\limits_{i = 1}^{\infty}f_n(x)$ сходится абсолютно и равномерно.

        \provehere{
            Обозначим $S_k(x) \coloneqq \sum\limits_{i = 1}^{k}f_i(x)$.
            Применим критерий Коши: \[\forall n > k: |S_n(x) - S_k(x)| = |f_{k+1}(x) + \dots + f_{n}(x)| \le |f_{k+1}(x)| + \dots + |f_n(x)| \le d_{k + 1} + \dots + d_n\]
            При достаточно большом $k$, согласно критерию Коши для числового ряда $d_n$, сумма $|d_{k + 1}| + \dots + |d_n|$ достаточно мала.
        }
    }
    Здесь интересно писать бесконечный ряд Тейлора и смотреть, куда и где он сходится.
    \example[Непрерывная, но нигде не дифференцируемая функция]{Определим\\
        \begin{gather*}
            f_1(x) = \all{|x|,~ |x| \le \frac{1}{2} \\ \text{функция имеет период $1$}} \text{в точках $\frac{1}{2}\Z$ нет производной, в остальных --- она $\pm 1$.}\\
            f_2(x) = \frac{1}{4}f_1(4x) = \all{\frac{1}{4}|x|,~ |x| \le \frac{1}{8} \\ \text{функция имеет период $\frac{1}{4}$}} \text{в точках $\frac{1}{8}\Z$ нет производной, в остальных --- она $\pm 1$.}\\
            f_3(x) = \frac{1}{4}f_2(4x) = \all{\frac{1}{16}|x|,~ |x| \le \frac{1}{32} \\ \text{функция имеет период $\frac{1}{16}$}} \text{в точках $\frac{1}{32}\Z$ нет производной, в остальных --- она $\pm 1$.}\\
        \end{gather*}
        Тогда функция $F \coloneqq \sum\limits_{i = 1}^{n}$ корректно определена, так как ряд сходится по критерию Вейерштрасса: $|f_n(x)| \le \frac{1}{2\cdot4^{n-1}}$.
        Так как ряд сходится равномерно, а слагаемые непрерывны, то $F$ --- тоже непрерывна.

        Тем не менее, она нигде не дифференцируема:
        для любого $n \in \N$ можно выбрать $h_n =\pm \dfrac{1}{4^n}$, так, что $\dfrac{f_n(x + h_n) - f_n(x)}{h_n} = \pm 1$.

        Тогда $\dfrac{f_n(x + h_n) - f_n(x)}{h_n} = \all {\pm 1,& k \le n \\ 0, & k > n}$.

        Запишем $\dfrac{F(x + h_n) - F(x)}{h_n} = \sum\limits_{j = 1}^{n}\dfrac{f_j(x + h_n) - f_j(x)}{h_n}$.
        При чётных $n$ эта сумма чётна, при нечётных --- нечётна, значит, производной не существует --- последовательность не сходится.
    }
    \theorem[Предельный переход под знаком интеграла]{
        Пусть $f_n$ заданы на конечном отрезке $I$, и все интегрируемы по Риману-Дарбу.

        Если $f_n \rightrightarrows f$, то $\lim\limits_{n \to \infty}\int\limits_I f_n(x) \d x = \int\limits_{I} f(x) \d x$.
        \provehere{
            \[\left|\int\limits_I f_n(x) - \int\limits_{I}f(x) \d x\right| = \left|\int\limits_{I}(f_n(x) - f(x))\d x\right| \le \underbrace{\sup\limits_{x \in I}\left|f_n(x) - f(x)\right|}_{\text{мало из-за равномерности}} \cdot |I| \underset{n \to \infty}\Map 0\qedhere\]
        }
    }
    \note{    На самом деле, если $f_n \to f$ поточечно, причём $\forall n: \exists A: \forall x \in I: |f_n(x)| \le A$, то заключение теоремы верно тоже.}
    \problem{
        Пусть $f_n$ заданы на отрезке $\langle a, b \rangle$ и дифференцируемы. Пусть $f_n \rightrightarrows f$.
        При каких дополнительных условиях $\exists f'$, причём $f' = \lim\limits_{?} f_n'$?
    }
    \theorem{
        $I$ --- отрезок, $f_n, f: I \map \R$, а ещё имеется функция $\phi: I \map \R$.

        Известно, что $f_n$ дифференцируемы всюду на $I$, $f_n \rightrightarrows f$, а $f_n' \rightrightarrows \phi$.

        Тогда $f$ дифференцируема, причём $f' = \phi$.

        Упражнение: можно ослабить условие  $f_n \rightrightarrows f$, на следующее: $\exists x_0 \in I: \lim\limits_{n \to \infty}f_n(x_0) = f(x_0)$.
        \provehere{
            Применим критерий Коши к равномерному схождению производных: $\forall \eps > 0: \exists N \in |N: \forall k, m > N, x \in I: |f_k'(x) - f_m'(x)| \le \eps$.

            Пусть $x \ne y \in I$, а ещё $g(x) = f_k(x) - f_m(x)$. Запишем формулу Лагранжа: $\dfrac{g(x) - g(y)}{x - y} = g'(\xi)$, где $\xi$ найдётся между $x$ и $y$.

            Раскрыв $g$ по определению, получаем $\left|\dfrac{f_k(x) - f_k(y)}{x - y} - \dfrac{f_m(x) - f_m(y)}{x - y}\right| = |f_k'(\xi) - f_m'(\xi)| \le \eps$, где $\xi$ найдётся между $x$ и $y$.
            Если при фиксированном $k$ устремить $m$ к $+\infty$, получится неравенство $\left|\dfrac{f_k(x) - f_k(y)}{x - y} - \dfrac{f(x) - f(y)}{x - y}\right| \le \eps$.

            Оно же переписывается в виде $\dfrac{f_k(x) - f_k(y)}{x - y} - \eps \le \dfrac{f(x) - f(y)}{x - y} \le \dfrac{f_k(x) - f_k(y)}{x - y} + \eps$.
            Теперь при фиксированном $x$ устремим $y \to x$. Получим $f_k'(x) \le \varliminf\limits_{y \to x}\dfrac{f(x) - f(y)}{x - y} \le \varlimsup\limits_{y \to x}\dfrac{f(x) - f(y)}{x - y} \le f_k'(x) + \eps$.

            Теперь их сходимости $f_k$ к $\phi$ получаем, что $\exists N'$ (можно считать $N' \ge N$), такое, что $\forall k > N': |f_k(x) - \phi(x)| \le \eps$.

            Таким образом, \[\phi(x) - 2\eps \le \varliminf\limits_{y \to x}\dfrac{f(x) - f(y)}{x - y} \le \varlimsup\limits_{y \to x}\dfrac{f(x) - f(y)}{x - y} \le \phi(x) + 2\eps\qedhere\]
        }
    }


    \section{Логарифм и экспонента}
    \definition[Натуральный логарифм]{
        $\log: (0, +\infty) \map \R$, где $\log t = \int\limits_1^t \frac{1}{x}\d x$.
    }
    Подынтегральная функция непрерывна на луче, поэтому в любой точке определение корректно, интеграл существует.

    \subsection{Свойства}
    \numbers{
        \item $\log(t_1 t_2) = \log(t_1) + \log(t_2)$, где $t_1, t_2 > 0$.
        \provehere{
            \[\log(t_1 t_2) = \int\limits_1^{t_1 t_2} \frac{\d x}{x} = \int\limits_1^{t_1}\frac{\d x}{x} + \int\limits_{t_1}^{t_1 t_2}\frac{\d x}{x}\]
            При замене $y = \frac{x}{t_1}$ второе слагаемое преобразуется к виду $\int\limits_{1}^{t_2}\frac{\d y}{y}$.
        }
        \item Логарифм строго монотонен, так как $(\log t)' = \frac{1}{t}$ по теореме Ньютона-Лейбница.
        \item $\log 1 = 0$.
        \item $\lim\limits_{x \to 0}\frac{\log(1 + x)}{x} = \log'(1) = 1$.
    }
    \theorem[Теорема единственности]{
        Пусть $L: (0, +\infty) \map \R$ --- непрерывная функция, причём $L(t_1 t_2) = L(t_1) + L(t_2)$, причём $\exists x_{\ne 0}: L(x_{\ne 0}) \ne 0$.

        Тогда $\exists C \ne 0: \forall x > 0: L(t) = c \cdot \log(t)$.

        \provehere{
            \[L(1) = L(1 \cdot 1) = L(1) + L(1) \quad \then \quad L(1) = 0\]
            Заметим, что $L$ дифференцируема.
        }
    }
    \newlection{17 февраля 2022 г.}
    ...

    $G \subset \R^n$ --- открытое подмножество.
    Пусть дана некоторая функций \[f: G \map \R^m\]
    Рассмотрим некую точку $x \in G$.
    \definition[$f$ дифференцируема в точке $x$]{
        $\exists L: \R^n \map \R^m$ --- линейное отображение (оператор), такое, что \[f(y) - f(x) = L(x - y) + o(|x - y|)\]
    }

    \subsection{О геометрии пространства $\R^n$}
    $\R^n = \underbrace{\R \times \dots \times \R}_{n \text{раз}}$.
    $\R^n = \defset{(x_1, \dots, x_n)}{x_j \in \R}$ --- состоит из \textit{точек} или \textit{векторов}.
    Сумма векторов, умножение вектора на число понятны;\ рассмотрим скалярное произведение двух элементов $x, y \in \R^n$.
    \[\langle x, y \rangle \bydef x_1 y_1 + \dots + x_n y_n\]

    \subsubsection{Свойства:}
    \bullets{
        \item $\langle x, y \rangle = \langle y, x \rangle$.
        \item Линейность по каждому аргументу: $\langle \alpha x_1 + \beta x_2, y \rangle = \alpha \langle x_1, y \rangle + \beta \langle x_2, y \rangle$.
        \item $\langle x, x \rangle = x_1^2 + \dots + x_n^2$. Число не меньше 0, равенство достигается, когда все координаты нулевые.
        \definition[Длина вектора]{\[|x| \bydef \sqrt{\langle x, x \rangle}\]}
        \item Неравенство Коши-Буняковского-Шварца (КБШ)\[\langle x, y \rangle \le |x| \cdot |y|\]
        \provehere{
            Рассмотрим $t \in \R$. Запишем $\langle x + ty, x + ty \rangle \ge 0$.
            \[\langle x, x \rangle + 2t\langle x, y \rangle + t^2\langle y, y \rangle \ge 0\]
            Если $y = 0$, то исходное неравенство очевидное;\ иначе выше написан квадратный трёхчлен, который неотрицателен, то есть его дискриминант не превышает 0: $\langle x, y \rangle^2 \le \langle x, x \rangle \cdot \langle y, y \rangle$.
        }
        \corollary[Неравенство треугольника для длины]{
            $\forall x, y \in \R^n: |x + y| \le |x| + |y|$.
            \provehere{
                \[|x + y|^2 = \langle x + y, x + y \rangle = \langle x, x \rangle + 2\langle x, y \rangle + \langle y, y \rangle \le |x|^2 + |y|^2 + 2 |x||y| = (|x| + |y|)^2\]
            }
        }
        \item Введём метрику: $d(x, y) = |x - y|$. Несложно проверить всё три свойства, которым фукнция должна удовлетворять, чтобы быть метрикой.
        В том числе неравенство треугольника: \[d(x, y) = |x - y| = |(x - z) + (z - y)| \le |x - z| + |z - y|\]
        \item Метрика инвариантна относительно сдвига;\ при домножении всех координат на одно и то же число, метрика тоже умножается на это число.

        \fact{
            Пусть $u, u^{(k)} \in \R^n$.

            Условие \[\left|u - u^{(k)}\right| \underset{k \to \infty}{\Map} 0\]
            означает покомпонентную сходимость.

            \provehere{Несложно оценить из неравенства $x - y \le |x_i - y_i|$ --- расстояние хотя бы разность координатных проекций.}
        }
    }
    Стандартный базис векторов в $\R^n: e_j = (0, 0, \dots, \underbrace{1}_{j}, \dots, 0)$.
    \definition[$x, y \in \R^n$ ортогональны]{$\langle x, y \rangle = 0$.}
    \lemma{
        Если $u_1, \dots, u_m \in \R^n$ все ненулевые и попарно ортогональны, то они линейно независимы.
        \provehere{
            Рассмотрим вещественные числа $\alpha_1, \dots, \alpha_m \in \R$.
            \[x \coloneqq \sum\limits_{i = 1}^{n}\alpha_i u_i\]
            Заметим, что $\langle u_i, x \rangle = \alpha_i |u_i|^2$.

            Таким образом, если $x \in \langle u_1, \dots, u_m \rangle$, то его коэффициенты в линейной комбинации равны $\dfrac{\langle x, u_j \rangle}{|u_j|^2}$.

            Если векторы $u_j$ имеет единичную длину, то они равны просто-напросто $\langle x, u_j \rangle$.

            \definition[Система векторов называется ортонормированной]{$\langle u_i, u_j \rangle = \delta_{i,j}$.}
            \theorem{
                Пусть $E$ --- линейное подпространство в $\R^n$, $d = \dim(E)$.
                Тогда в $E$ существует ортонормированная система из $d$ векторов.
                \provehere{
                    Будем действовать по индукции. Пусть на $k$-м шаге построена ортонормированная система из $k$ векторов $u_1, \dots, u_k$.

                    Если $k < d$, то $\exists v \in E \sm E_k$, где $E_k = \langle u_1, \dots, u_k \rangle$.

                    Тогда вектор $\tilde{v} = v - (\langle v, u_1 \rangle u_1 + \dots + \langle v, u_k \rangle u_k)$. $\tilde{v} \in E \sm E_k$ тоже; несложно проверить, что $\tilde{v}$ ортогонален всякоум вектору из $u_1, \dots, u_k$.

                    Теперь возьмём пропорциональный ему вектор, длины 1, и добавим в ортонормированную систему.
                }
            }
            Построенная система --- линейно независима, называется ортонормированным базисом пространства.

            Если рассмотреть разложение векторов $x, y$ по ортонормированному базису, то скалярное произведение будет вычисляться по прежней формуле.
            Линейное подпространство евклидового пространство евклидово.
        }
    }
    Пусть $L_1, L_2$ --- линейные пространства.
    Отображение $T: L_1 \map L_2$ называется линейным оператором, если оно линейно.

    \subsubsection{Ортогональный проектор на подпространство}
    \theorem{
        Пусть $E$ --- линейное подпространство в $\R^n$.
        Для всякого $x \in \R^n: \exists! a, b \in \R^n: a \in E, b \perp E \land x = a + b$.
        \provebullets{
            \item Единственность: вычтем соответствующие разложения, если они вдруг не единственны. Получим с одной стороны вектор из $E$, а с другой стороны --- ему перпендикулярный.
            \item Разложим по ортонормированному базису с помощью скалярных произведений.
        }
    }
    \definition[Ортогональный проектор]{
        Отображение, сопоставляющее вектору $x$ этот самый вектор $a \in E$.
    }
    \newlection{21 февраля 2022 г.}
    Можно рассмотреть такое определение проектора:
    Такое линейное отображение $T: L \map L$, что $T(L) = R$ и $T\Big|_R = \id_R$.

    Отсюда сразу получается $T^2 = T$, что тоже можно взять за определение, а не за свойство.

    Таким свойствам удовлетворяет, например, ортогональный проектор $P: \R^n \map E$, такой, что $x - Px \perp Px$.

    Для подпространства $E \subset \R^n$ можно определить ортогональное дополнение $E^\perp \bydef \defset{y \in \R^n}{y \perp E} = \Ker P$.

    Очевидно, что $(I - P)$ --- ортогональный проектор на $E^\perp$, где $I$ --- тождественный оператор.

    Пусть $G \subset \R^n$ --- открытое множество, а $F: G \map \R^m$ --- произвольное отображение.

    Для точки $x \in G$ говорят, что $F$ дифференцируема в точке $x$, если $\exists T: \R^n \map \R^m$ --- линейный оператор, такой, что $F(y) - F(x) = T(x - y) + o(|x - y|)$.

    Для пущей строгости можно записать
    \[F(y) - F(x) = T(x - y) + \alpha(x - y)\]
    где $\alpha: U_0 \map \R^m$ для некой окрестности нуля $U_0$, причём $|\alpha(v)| = o(|v|)$.
    Так как теперь $|\alpha(v)|$ и $|v|$ --- скалярные величины, то записывать $o$-малое точно корректно.

    Оператор $T$ называют дифференциалом (дифференциальным отображением) $F$ и записывают $\d F(x, \cdot) = \d F_x (\cdot)$.
    Заметим, что определение полностью согласуется с определением одномерного дифференциала.

    Прежде всего рассмотрим несколько свойств линейных операторов.

    Пусть $A: \R^n \map \R^m$.
    Обозначим $e_j$ --- ортонормированный базис пространства $\R^n$, а $g_k$ --- ортонормированный базис $\R^m$.

    По определению базиса $x = \sum\limits_{j = 1}^{n}x_j e_j$, откуда конечно же по линейности $T x = \sum\limits_{j = 1}^{n}x_j \cdot T e_j$.

    С другой стороны $T e_j = \sum\limits_{k = 1}^{m}a_{k,j}g_k$, как разложения $T e$ по стандартному базису $g$.


    Итого получаем $T x = \sum\limits_{k = 1}^{m}\left(\sum\limits_{j = 1}^{n}a_{k,j}x_j\right)g_k$, где $a_{k,j}$ --- матрица отображения $T$, как ни странно.

    \corollary{
        $T$ --- непрерывное (покомпонентная сходимость) отображение $\R^n \map \R^m$.
    }
    На самом деле выполняется условие, намного более сильное, чем просто непрерывность:
    \proposal{
        $T$ удовлетворяет условию Липшица: $\exists A \in \R: \forall u, v \in \R^n: |Tu - Tv| \le A|u - v|$.

        Эквивалентная запись: $\forall x \in \R^n: |Tx| \le A|x|$.

        \provehere{
            $|Tx|^2 = \sum\limits_{k = 1}^{m}\left(\sum\limits_{j =1}^{n}a_{k,j}x_j\right)^2 \underset{\text{КБШ}}{\le} \sum\limits_{k = 1}^{m}\left(\sum\limits_{j = 1}^{n}a_{k,j}^2\right)\left(\sum\limits_{j = 1}^{m}x_j^2\right) = |x|^2\sum\limits_{k,j}a_{k,j}^2$.

            Теперь видно, что условие Липшица действительно выполняется, для $A = \sqrt{\sum\limits_{k,j}a_{k,j}^2}$.
        }
    }
    Полученная константа $A$ редко бывает самой плотной оценкой, а плотная оценка очень интересна, хотя и сложно вычислима.

    А именно, пусть $T: \R^n \map \R^m$ --- линейный оператор.
    \definition[Норма оператора $T$]{
        $\|T\| \bydef \inf \bigdefset{A \in \R}{\forall x \in \R^n: |Tx| \le A|x|}$.
    }
    \proposal{
        $\|T\| = \sup\bigdefset{|Tx|}{|x| \le 1} = \sup\bigdefset{|Tx|}{|x| = 1}$.
        \provehere{
            Очевидно, супремумы существуют из компактности и теоремы Вейерштрасса.
            Обозначим $\alpha = \sup\bigdefset{|Tx|}{|x| \le 1};\quad\beta =  \sup\bigdefset{|Tx|}{|x| = 1}; \quad \gamma = \|T\|$.

            Заметим, что в определении нормы можно $\inf$ заменить на $\min$, так как в нестрогом неравенстве можно перейти к пределу.

            Несложно видеть из определения, что $\beta \le \alpha \le \gamma$.
            Докажем, что $\gamma \le \beta$.

            Докажем, что $\forall x \in \R^n: |Tx| \le \beta |x|$.

            \bullets{
                \item Если $x = 0$, то неравенство очевидно верно.
                \item Если $x \ne 0$, то $\left|\frac{x}{|x|}\right| = 1$, и можно применить к нему определение $\beta:$
                \[T\left(\frac{x}{|x|}\right) \le \beta \quad \then \quad T x \le \beta |x|\qedhere\]
            }
        }
    }
    \fact{
        Очевидно, из линейности $T$ можно брать супремум и по открытому шару тоже: $\|T\| = \sup\bigdefset{|Tx|}{|x| < 1}$.
        (Рассмотрим точку $x$ на сфере, где равенство выполняется с точностью до $\eps$, немного отступим от неё).
    }
    \theorem[Свойства нормы]{\down
    \numbers{
        \item $\|T\| = 0 \iff \forall x : Tx = 0$.
        \item $\|aT\| = |a| \cdot \|T\|$
        \item $\|T_1\| + \|T_2\| \ge \|T_1 + T_2\|$.
        \provehere{
            \[\|T_1 + T_2\| = \sup\limits_{|x| \le 1}|(T_1 + T_2)(x)| = \sup\limits_{|x| \le 1}|T_1(x) + T_2(x)| \le \sup\limits_{|x| \le 1}|T_1(x)| + |T_2(x)| \le \|T_1\| + \|T_2\|\]
        }
    }
    }
    Введём метрику $\rho(T_1, T_2) = \|T_1 - T_2\|$.

    Эта метрика задаёт отнюдь не новую топологию на пространстве линейных операторов.
    Чтобы это увидеть, перейдём к матрицам линейных отображений.

    Воспользовавшись оценкой $\|T\| \le \sqrt{\sum\limits_{k,j}(a_{k,j})^2}$ мы сразу видим, что поэлементная сходимость матриц влечёт стремление $\sqrt{\sum\limits_{k,j}(a_{k,j} - b_{k,j})^2} \Map 0$, то есть нормы близких матриц близки.
    Обратное тоже верно(??)

    $T e_j = \sum\limits_{k =1}^{m}a_{k,j}g_k$, откуда можно извлечь коэффициенты матрицы: $a_{k,j}(T) = \langle T e_j, g_k \rangle$.

    Обозначим $|||T||| = \sqrt{\sum\limits_{k,j}a_{k,j}(T)^2}$.

    \fact{
        $|a_{k,j}(T)| \le \|T\| \le |||T|||$.
    }

    \theorem{
        $T_s, T: \R^n \map \R^m$ --- линейные операторы.
        Следующие условия эквивалентны:
        \bullets{
            \item $|||T_s - T||| \Map 0$.
            \item $\|T_s - T\| \Map 0$.
            \item $\forall k, j: a_{k,j}(T_s - T) \Map 0$.
        }
        \provehere{Собрать факты выше.}
    }
    Так как $|||T|||$ --- длина вектора в $\R^{nm}$, то можно считать, что пространство операторов тоже евклидово.

    \proposal{
        Пусть $\R^n \overset{T}\Map \R^m \overset{S}\Map \R^l$, где $T, S$ --- линейные операторы.
        Тогда $\|S \circ T\| \le \|S\| \cdot \|T\|$.
        \provehere{
            $\forall x \in \R^n: |(S \circ T)(x)| \le \|S\| \cdot |Tx| \le \|S\| \cdot \|T\| \cdot |x|$.
        }
    }
    \note{
        В будущем часто при композиции линейных операторов будет записываться, как произведение, в том числе слитно ($ST$).
    }
    Оценим снизу норму инъективных линейных операторов.

    $T: \R^n \map \R^m$ --- линейный оператор --- инъективен, если $\Ker T = \{0\}$.
    Очевидно, необходимым условием является $m \ge n$.
    \theorem{
        Следующие условия эквивалентны:
        \numbers{
            \item $\Ker T = \{0\}$.
            \item $\exists m > 0: \forall x \in \R^n: |Tx| \ge m |x|$.
        }
        \provehere{
            В одну сторону очевидно.

            Рассмотрим единичную сферу $S = \defset{x \in \R^n}{|x| = 1}$.
            Она компактна, так как ограничена и замкнута.

            Введём непрерывную функцию $\phi: S \map \R; \phi(x) = |Tx|$. Очевидно, $\forall x: \phi(x) > 0$.

            По теореме Вейерштрасса $\phi$ где-то достигает своё наименьшее значение.
            Пусть $m = \min\limits_{x \in S}\phi(x)$, причём $m = \phi(x_0)$. Тогда $\left|T(\frac{x}{|x|})\right| \ge m \then |Tx| \ge m|x|$.
        }
        \provehere[Другой вариант доказательства]{
            Пусть $E = T(\R^n) \subset \R^m$ --- евклидово подпространство.

            $E$ само евклидово, можно считать, что $T: \R^n \map \R^n$ --- биекция.
            Тогда обратное к $T$ --- тоже линейный оператор, значит, у него есть норма, то есть $\forall y \in E: \exists C \in \R: |T^{-1} y| \le C |y|$.

            Собственно, это и требовалось доказать.
        }
    }
%    Будем искать вместо $\lim\limits_{x \to 0}\frac{\tg(x) - x}{x^3} = \lim\limits_{x \to 0}\frac{\sin(x) - x\cos(x)}{x^3}$ другой предел, а именно, $\alpha \coloneqq \lim\limits_{x \to 0}\frac{\sin(x) - x}{x^3}$: очевидно, искомый предел равен $\alpha + \lim\limits_{x \to 0}\frac{x - x\cos(x)}{x^3} = \alpha + \lim\limits_{x \to 0}\frac{1 - \cos(x)}{x^2} = \alpha + \frac{1}{2}$.
%
%    Заметим, что \[\frac{\sin(x) - x}{x^3} = \frac{3\sin\left(\frac{x}{3}\right) - 4 \sin^3\left(\frac{x}{3}\right) - x}{x^3} = \frac{1}{9}\cdot\frac{\sin\left(\frac{x}{3}\right) - \frac{x}{3}}{\left(\frac{x}{3}\right)^3} - 4\frac{\sin^3\left(\frac{x}{3}\right)}{x^3}\]
%    Заведём функцию $f(x) = \frac{\sin(x) - x}{x^3}$.
%    Видим, что $f(x) = \frac{1}{9}f\left(\frac{x}{3}\right) - 4\frac{\sin^3\left(\frac{x}{3}\right)}{x^3}$.
%
%    Отсюда понятно (навесим пределы на равенство), что если бы у $f$ был в нуле предел, то он был бы равен такому числу $\alpha$, что $\alpha = \frac{1}{9}\alpha - \frac{4}{27} \iff \frac{8}{9}\alpha = -\frac{4}{27} \iff \alpha = -\frac{1}{6}$.
%
%    Пойдём от противного: пусть у $f$ нет предела в нуле.
%    Значит, $\exists \eps > 0: \forall \delta > 0: \exists x \in \U[\delta]{0}: \left|f(x) + \frac{1}{6}\right| > \eps$.
%
%    $f(x)$ очевидно нечётна, будем рассматривать $x > 0$.
%    Зафиксируем $\eps$ из условия выше и рассмотрим $\delta > 0$ такую, что $\forall x \in (0, \delta): \left|\frac{\sin^3\left(\frac{x}{3}\right)}{x^3} - \frac{1}{27}\right| < \frac{\eps}{36}\xi$, где $\xi \in (0, 1)$ мы определим позже.
%    Такая $\delta$ найдётся, потому что $\frac{\sin^3\left(\frac{x}{3}\right)}{x^3}$ непрерывна при $x \ne 0$ и имеет предел $\left(\frac{1}{27}\right)$ при $x \to 0$.
%
%    Выразив $f\left(\frac{x}{3}\right) = 9f(x) + 36\frac{\sin^3\left(\frac{x}{3}\right)}{x^3} = -\frac{1}{6} + 9\left(f(x) + \frac{1}{6}\right) + 36\left(\frac{\sin^3\left(\frac{x}{3}\right)}{x^3} - \frac{1}{27}\right)$ получаем, что как только нашёлся такой $x \in (0, \delta)$, что $\left|f(x) + \frac{1}{6}\right| > \eps$, так сразу $\left|f(\frac{x}{3}) + \frac{1}{6}\right| > (9 - \xi)\cdot\left|f(x) + \frac{1}{6}\right|$ (так как мы выбрали настолько маленькую $\delta$, что вклад $36\left(\frac{\sin^3\left(\frac{x}{3}\right)}{x^3} - \frac{1}{27}\right)$ меньше $\xi\eps$).
%
%    Это значит, что $f$ принимает сколь угодно большие (по модулю) значения в окрестности нуля (при $\frac{x}{3^2}, \frac{x}{3^3}$, etc).
%    В частности, найдётся такой $x$, что $\left(f(x) + \frac{1}{6}\right) \cdot x^{\log_3(9 - \xi)} \ne 0$.
%
%    Тогда $\left|\left(f\left(\frac{x}{3}\right) + \frac{1}{6}\right) \cdot \left(\frac{x}{3}\right)^{\log_3(9 - \xi)}\right| > (9 - \xi)\left|f(x) + \frac{1}{6}\right|\cdot\left|\frac{x^{\log_3(9 - \xi)}}{9 - \xi}\right| = \left|\left(f(x) + \frac{1}{6}\right) \cdot x^{\log_3(9 - \xi)}\right|$

    \newlection{28 февраля 2022 г.}
    В терминах $\eps$ и $\delta$ дифференцируемость можно записать так:

    Для функции $F: U \map \R^m$, заданной на открытом множестве $U$ и точки $x_0 \in U$:
    \[\exists A \text{ --- линейный оператор, такой, что } \forall x \in U: F(x) = F(x_0) + A(x - x_0) + o(|x - x_0|)\]
    Определим $\phi(x) = F(x) - F(x_0) - A(x - x_0)$, определённую на $U$.

    Необходимым (и достаточным?) условием является $\forall \eps > 0: \exists \delta: \forall x \in U: |x - x_0| < \delta \then |\phi(x)| \le \eps \cdot |x - x_0|$.

    \fact{
        Если $F$ дифференцируема в точке $x_0$, то $F$ непрерывна в точке $x_0$.
        Более того, выполняется \textit{локальное условие Липшица}:
        \[\exists C \in \R: |F(x) - F(x_0)| \le C |x - x_0| \text{ при достаточно малом }x - x_0\]
        \provehere{
            \begin{gather*}
                F(x) - F(x_0) = A(x - x_0) + \phi(x) \then \\
                |F(x) - F(x_0)| \le \|A\| \cdot |x - x_0| + \eps \cdot |x - x_0| = (\|A\| + \eps)\cdot |x - x_0|\qedhere
            \end{gather*}
        }
    }
    \proposal{
        У данной функции $F: U \map \R^m$ в данной точке $x_0 \in U$ существует не более одного дифференциала.
        \provehere{
            От противного: нашлись $A, B: \R^n \map \R$ --- дифференциалы $F$ в $x_0$.
            \begin{gather*}
                F(x) - F(x_0) = A(x - x_0) + o(|x - x_0|) \\
                F(x) - F(x_0) = B(x - x_0) + o(|x - x_0|) \\
                \Downarrow\\
                (B -A)(x - x_0) = o(|x -x_0|)
            \end{gather*}
            Положим $C = B - A$. Если $C \ne 0$, то $\exists h \in \R^n: C(h) \ne 0$.

            Рассмотрев $t \in \R$, получаем $C(h) = \frac{C(t \cdot h)}{t \cdot |h|} \underset{t \to 0}\Map 0$, противоречие.
        }
    }
    \examples[Простейшие дифференцируемые отображения]{
        \item Постоянное отображение (дифференциал --- 0).
        \item Линейное отображение (дифференциал совпадает с самим отображением).
    }
    \theorem[О композиции дифференцируемых отображений]{
        Пусть $U \in \R^n, V \in \R^m$ --- открытые множества.

        При данных отображениях $F: U \map \R^m$ и $G: V \map \R^k$, таких, что $F(U) \subset V$, выберем точки $x_0 \in U$ и $y_0 \in f(U)$.

        При сделанных предположениях, если $F$ дифференцируема в $x_0$ с дифференциалом $A$, $G$ дифференцируема в $y_0$ с дифференциалом $B$, то $G \circ F$ дифференцируема в $x_0$ с дифферецниалом $BA$.
        \provehere{
            \begin{gather*}
                F(x) = F(x_0) + A(x - x_0) + \phi(x), \qquad |\phi(x)| = o(|x - x_0|) \\
                G(y) = G(y_0) + B(y - y_0) + \phi(y), \qquad |\psi(y)| = o(|y - y_0|) \\
                \text{подставим} \qquad y \coloneqq F(x),\: y_0 \coloneqq F(x_0) \qquad\text{(область определения позволяет)}\\
                (G\circ F)(x) = (G \circ F)(x_0) + B(F(x) - F(x_0)) + \psi(F(x))\\
                (G\circ F)(x) = (G \circ F)(x_0) + BA(x - x_0) + B(\phi(x)) + \psi(F(x))
            \end{gather*}
            Покажем, что $\gamma(x) \coloneqq B(\phi(x)) + \psi(F(x)) = o(|x - x_0|)$.
            \[\gamma(x) \le \underbrace{|B(\phi(x))|}_{\le \|B\|\cdot \phi(x) = o(|x -x_0|)} + \underbrace{|\psi(F(x))|}_{o(|x - x_0|)\text{ из-за локальной липшицевости }F}\]
            То, что $|\psi(F(x))| = o(|x - x_0|)$, не абсолютно очевидно, но я опустил выкладку, как скучную.
        }
    }
    \theorem{
        Если $U \subset \R^n$ --- открытое множество, а $F_1, F_2: U \map \R^m$ --- дифференцируемы в точке $x_0$, то для $\alpha, \beta \in \R$:
        \[\d(\alpha F_1 + \beta F_2)(x_0, \cdot) = \alpha\cdot \d F_1(x_0, \cdot) + \beta\cdot \d F_2(x_0, \cdot)\]
    }
    Пусть $F: U \map \R^m$ --- отображение.
    \definition[Координатные проекции $F$]{
        Разложим $F(x)$ по стандартному базису: ${F(x) = \sum\limits_{i = 1}^{m}a_i e_i}$.
        Тогда координатными проекциями называются функции $F_j: \R^m \map \R; \quad F_j(x) = a_j$.
    }
    \theorem{
        Пусть $U \in \R^n$ открыто. Утверждается, что $F: U \map \R^m$ дифференцируема в $x_0 \in U$ если и только если $\forall j = 1..m: F_j$ дифференцируема в $x_0$.

        Более того, $\d F(x_0, h) = \vect{\d F_1(x_0, h), &\cdots, &\d F_m(x_0, h)}$
        \provetwhen{
            Рассмотрим линейный оператор $T_j: \R^m \map \R$, сопоставляющий $y \in \R^m$ его $j$-ю координату в разложении по стандартному базису.
            $F_j = T_j \circ F$ --- дифференцируема, как композиция. Утверждение про матрицу дифференциала $F$ следует из того, что матрица дифференциала $T_j$ --- это $\vect{0,& \dots,& \underset{j}{1},& \dots,& 0}$
        }{
            Если все $F_j$ дифференцируемы, то $F_j(x) - F_j(x_0) = A_j(x - x_0) + o(|x - x_0|)$, откуда
            \[F(x) - F(x_0) = \vect{A_1(x - x_0),& \dots,&A_m(x - x_0)} + \vect{\phi_1(x),&\dots,&\phi_m(x)}\]
        Несложно видеть, что это дифференцируемость $F$ по определению.
        }
    }
    \subsection{О скалярных функциях $F: (U\subset \R^n) \map \R$}
    \note{
        Пусть $G: U \map \R$ --- скалярная функция, дифференцируемая в $x_0 \in U$, то есть \[G(x) - G(x_0) = A(x - x_0) + o(|x - x_0|)\]
        где $A: \R^n \map \R$ --- линейный функционал.

        Разложим $A(y) = A(y_1 e_1 + \dots + y_n e_n) = y_1 A(e_1) + \dots + y_n A(e_n)$. Положим $\xi_j = A(e_j) \in \R$, тогда $A(y) = \langle y, \xi\rangle$.
    }
    Пусть $F$ дифференцируема в $x_0 \in U$, тогда $\exists \xi: F(x) - F(x_0) = \langle x - x_0, \xi \rangle + o(|x - x_0|)$.

    Теперь рассмотрим $(a, b) \subset \R$, причём $a < b$.
    Рассмотрим $g: (a, b) \map U$, дифференцируемую в точке $t_0 \in (a, b)$.
\end{document}

